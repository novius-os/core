var __extends=this.__extends||function(e,a){function c(){this.constructor=e}c.prototype=a.prototype;e.prototype=new c()};var wijmo;(function(wijmo){(function(input){var $=jQuery,jqKeyCode=wijmo.getKeyCodeEnum();var wijinputcore=(function(_super){__extends(wijinputcore,_super);function wijinputcore(){_super.apply(this,arguments);this._boundMouseWheel=false;this._wasPopupShowing=false;this._blockNextTriggerClickedEvent=false}wijinputcore.prototype._elemWithClasses=function(elem,classes){if(typeof classes==="undefined"){classes=[]}return $(elem).addClass(classes.join(" "))};wijinputcore.prototype._divWithClasses=function(){var classes=[];for(var _i=0;_i<(arguments.length-0);_i++){classes[_i]=arguments[_i+0]}return this._elemWithClasses("<div/>",classes)};wijinputcore.prototype._spanWithClasses=function(){var classes=[];for(var _i=0;_i<(arguments.length-0);_i++){classes[_i]=arguments[_i+0]}return this._elemWithClasses("<span/>",classes)};wijinputcore.prototype._horizontalBorderWidth=function(elem){return elem.leftBorderWidth()+elem.rightBorderWidth()};wijinputcore.prototype._verticalBorderWidth=function(elem){return elem.topBorderWidth()+elem.bottomBorderWidth()};wijinputcore.prototype._create=function(){var _this=this;try{var focused=document.activeElement==this.element[0]}catch(e){}var hBorder=this._horizontalBorderWidth(this.element);var vBorder=this._verticalBorderWidth(this.element);if(this.element[0].tagName.toLowerCase()!=="input"&&this.element[0].tagName.toLowerCase()!=="textarea"){throw"Target element is not a INPUT"}this._creationDate=new Date();if(window.wijmoApplyWijTouchUtilEvents){$=window.wijmoApplyWijTouchUtilEvents($)}if(this.element.is(":hidden")&&this.element.wijAddVisibilityObserver){this.element.wijAddVisibilityObserver(function(){_this._destroy();_this._create();if(_this.element.wijRemoveVisibilityObserver){_this.element.wijRemoveVisibilityObserver()}},"wijinput")}this.element.data("widgetName",this.widgetName);if($.effects&&$.effects.save){$.effects.save(this.element,["width","height"])}else{if($.save){$.save(this.element,["width","height"])}}var wijCSS=this.options.wijCSS;this.element.wrap("<div><span/></div>");this.wrapper=this.element.parent();this.outerDiv=this.wrapper.parent();this.outerDiv.addClass([wijCSS.wijinput,wijCSS.widget,wijCSS.helperClearFix,wijCSS.stateDefault,wijCSS.cornerAll].join(" "));this.wrapper.addClass(wijCSS.wijinputWrapper);this.element.addClass(wijCSS.wijinputInput).addClass(wijCSS.cornerAll).attr("role","textbox");if(!(Utility.IsIE()&&parseFloat($.browser.version)<=7)){try{this.element.attr("aria-multiline",false)}catch(e){this.element[0].setAttribute("aria-multiline","false")}}this._createDropDownAndSpin();this._initialize();if(focused){$(function(){return _this.element.focus().wijtextselection(0,_this.element.val().length)})}var style=this.element[0].style;if(style.width){if(this._isInPercents(style.width)){this.outerDiv.width(style.width)}else{this.outerDiv.width(this.element.width()+hBorder-this._horizontalBorderWidth(this.outerDiv))}this.element.width("")}if(style.height){if(this._isInPercents(style.height)){this.outerDiv.height(style.height)}else{this.outerDiv.height(this.element.height()+vBorder-this._verticalBorderWidth(this.outerDiv))}this.element.height(this.outerDiv.height()-(parseInt(this.wrapper.css("padding-top"))+parseInt(this.wrapper.css("padding-bottom"))))}};wijinputcore.prototype._createDropDownAndSpin=function(){this._createDropDownAndSpinElement();this._createDropDownAndSpinStyle();this._createDropDownAndSpinLayout()};wijinputcore.prototype._createDropDownAndSpinElement=function(){var wijCSS=this.options.wijCSS;var spinnerAlign=this.options.spinnerAlign;var leftSpinnerBtn=spinnerAlign==="verticalLeft";var leftDropDownBtn=this.options.dropDownButtonAlign==="left";var showSpinner=this.options.showSpinner;var showDropDownButton=this._isDropDownButtonShown();if(this.options.buttonAlign!=null){leftSpinnerBtn=this.options.buttonAlign=="left";leftDropDownBtn=this.options.buttonAlign=="left";spinnerAlign=this.options.buttonAlign=="left"?"verticalLeft":"verticalRight"}this.triggerBtn=null;this.spinUpElement=null;this.spinDownElement=null;this.outerDiv.css("overflow","hidden");if(showDropDownButton){var cornerCSS=leftDropDownBtn?wijCSS.cornerLeft:wijCSS.cornerRight;this.triggerBtn=this._divWithClasses(wijCSS.wijinputTrigger,wijCSS.stateDefault,cornerCSS).append(this._spanWithClasses(wijCSS.icon,wijCSS.iconArrowDown)).attr("role","button");this.element.attr({role:"combobox","aria-expanded":false})}if(showSpinner){this.spinnerLeft=this._divWithClasses(wijCSS.wijinputSpinnerLeft,wijCSS.wijinputButton);this.spinnerRight=this._divWithClasses(wijCSS.wijinputSpinnerRight,wijCSS.wijinputButton);if(spinnerAlign==="verticalLeft"||spinnerAlign==="verticalRight"){this.spinUpElement=this._divWithClasses(wijCSS.stateDefault,wijCSS.wijinputSpinUp).append(this._spanWithClasses(wijCSS.icon,wijCSS.iconArrowUp)).attr("role","upbutton");this.spinDownElement=this._divWithClasses(wijCSS.stateDefault,wijCSS.wijinputSpinDown).append(this._spanWithClasses(wijCSS.icon,wijCSS.iconArrowDown)).attr("role","downbutton")}else{this.spinUpElement=this._divWithClasses(wijCSS.stateDefault,wijCSS.wijinputSpin).append(this._spanWithClasses(wijCSS.icon,wijCSS.iconPlus)).attr("role","upbutton");this.spinDownElement=this._divWithClasses(wijCSS.stateDefault,wijCSS.wijinputSpin).append(this._spanWithClasses(wijCSS.icon,wijCSS.iconMinus)).attr("role","downbutton")}this.element.attr("role","spinner")}};wijinputcore.prototype._createDropDownAndSpinStyle=function(){var wijCSS=this.options.wijCSS;var spinnerAlign=this.options.spinnerAlign;var leftSpinnerBtn=this.options.spinnerAlign==="verticalLeft";var leftDropDownBtn=this.options.dropDownButtonAlign==="left";var showSpinner=this.options.showSpinner;var showDropDownButton=this._isDropDownButtonShown();if(this.options.buttonAlign!=null){leftSpinnerBtn=this.options.buttonAlign=="left";leftDropDownBtn=this.options.buttonAlign=="left";spinnerAlign=this.options.buttonAlign=="left"?"verticalLeft":"verticalRight"}if(showDropDownButton&&showSpinner){if(leftDropDownBtn){switch(spinnerAlign){case"verticalLeft":this.outerDiv.addClass(wijCSS.inputSpinnerTriggerLeft);break;case"verticalRight":this.outerDiv.addClass(wijCSS.inputTriggerLeft);this.outerDiv.addClass(wijCSS.inputSpinnerRight);break;case"horizontalDownLeft":case"horizontalUpLeft":this.outerDiv.addClass(wijCSS.inputSpinnerTriggerLeft);this.outerDiv.addClass(wijCSS.inputSpinnerRight);break}}else{switch(spinnerAlign){case"verticalLeft":this.outerDiv.addClass(wijCSS.inputTriggerRight);this.outerDiv.addClass(wijCSS.inputSpinnerLeft);break;case"verticalRight":this.outerDiv.addClass(wijCSS.inputSpinnerTriggerRight);break;case"horizontalDownLeft":case"horizontalUpLeft":this.outerDiv.addClass(wijCSS.inputSpinnerTriggerRight);this.outerDiv.addClass(wijCSS.inputSpinnerLeft);break}}}else{if(showDropDownButton){if(leftDropDownBtn){this.outerDiv.addClass(wijCSS.inputTriggerLeft)}else{this.outerDiv.addClass(wijCSS.inputTriggerRight)}}else{if(showSpinner){switch(spinnerAlign){case"verticalLeft":this.outerDiv.addClass(wijCSS.inputSpinnerLeft);break;case"verticalRight":this.outerDiv.addClass(wijCSS.inputSpinnerRight);break;case"horizontalDownLeft":case"horizontalUpLeft":this.outerDiv.addClass(wijCSS.inputSpinnerLeft);this.outerDiv.addClass(wijCSS.inputSpinnerRight);break}}}}if(showDropDownButton&&showSpinner){if(leftDropDownBtn){switch(spinnerAlign){case"verticalRight":this.spinUpElement.addClass(wijCSS.cornerTR);this.spinDownElement.addClass(wijCSS.cornerBR);break;case"horizontalDownLeft":this.spinUpElement.addClass(wijCSS.cornerRight);break;case"horizontalUpLeft":this.spinDownElement.addClass(wijCSS.cornerRight);break}}else{switch(spinnerAlign){case"verticalLeft":this.spinUpElement.addClass(wijCSS.cornerTL);this.spinDownElement.addClass(wijCSS.cornerBL);break;case"horizontalDownLeft":this.spinDownElement.addClass(wijCSS.cornerLeft);break;case"horizontalUpLeft":this.spinUpElement.addClass(wijCSS.cornerLeft);break}}}else{if(showSpinner){switch(spinnerAlign){case"verticalLeft":this.spinUpElement.addClass(wijCSS.cornerTL);this.spinDownElement.addClass(wijCSS.cornerBL);break;case"verticalRight":this.spinUpElement.addClass(wijCSS.cornerTR);this.spinDownElement.addClass(wijCSS.cornerBR);break;case"horizontalDownLeft":this.spinDownElement.addClass(wijCSS.cornerLeft);this.spinUpElement.addClass(wijCSS.cornerRight);break;case"horizontalUpLeft":this.spinUpElement.addClass(wijCSS.cornerLeft);this.spinDownElement.addClass(wijCSS.cornerRight);break}}}};wijinputcore.prototype._createDropDownAndSpinLayout=function(){var spinnerAlign=this.options.spinnerAlign;var showSpinner=this.options.showSpinner;var showDropDownButton=this._isDropDownButtonShown();if(this.options.buttonAlign!=null){spinnerAlign=this.options.buttonAlign=="left"?"verticalLeft":"verticalRight"}if(showDropDownButton){this.triggerBtn.appendTo(this.outerDiv)}if(showSpinner){switch(spinnerAlign){case"verticalLeft":this.spinnerLeft.append(this.spinUpElement).append(this.spinDownElement).appendTo(this.outerDiv);break;case"verticalRight":this.spinnerRight.append(this.spinUpElement).append(this.spinDownElement).appendTo(this.outerDiv);break;case"horizontalDownLeft":this.spinnerLeft.append(this.spinDownElement).appendTo(this.outerDiv);this.spinnerRight.append(this.spinUpElement).appendTo(this.outerDiv);break;case"horizontalUpLeft":this.spinnerLeft.append(this.spinUpElement).appendTo(this.outerDiv);this.spinnerRight.append(this.spinDownElement).appendTo(this.outerDiv);break}}};wijinputcore.prototype._isDropDownButtonShown=function(){var showTrigger=this.options.showTrigger;if(showTrigger===undefined){showTrigger=false}return showTrigger||this.options.showDropDownButton};wijinputcore.prototype._isInPercents=function(size){return size.match(/%$/)};wijinputcore.prototype._createTextProvider=function(){return undefined};wijinputcore.prototype._beginUpdate=function(){};wijinputcore.prototype._endUpdate=function(){var _this=this;if(this.element.mousewheel&&!this._boundMouseWheel){this.element.mousewheel(function(e,delta){if(_this.isFocused()&&_this._doSpin(delta>0,false)){e.preventDefault()}});this._boundMouseWheel=true}};wijinputcore.prototype._isPopupShowing=function(){return !!this._comboDiv&&this._comboDiv.wijpopup("isVisible")};wijinputcore.prototype._onTriggerMouseDown=function(evt){if(this._wasPopupShowing){this._blockNextTriggerClickedEvent=true}};wijinputcore.prototype._onTriggerMouseUp=function(evt){};wijinputcore.prototype._onTriggerClicked=function(){if(this._blockNextTriggerClickedEvent){this._blockNextTriggerClickedEvent=false;return}if(this._popupVisible()){this._hidePopup()}else{this._showPopup()}};wijinputcore.prototype._showPopup=function(){return this._popupComboList()};wijinputcore.prototype._hidePopup=function(){this._comboDiv.wijpopup("hide")};wijinputcore.prototype._initialize=function(){var _this=this;this.element.data("initializing",true);this._trigger("initializing");this.element.data("preText",this.element.val());this.element.data("elementValue",this.element.val());this.element.data("errorstate",false);this.element.data("breakSpinner",true);this.element.data("prevCursorPos",-1);this.element.data("simulating",false);this._createTextProvider();this._beginUpdate();var options=this.options,isLeftButton=function(e){return(!e.which?e.button:e.which)===1},spinButtonDown=function(e){if(_this.options.disabled){return}if(!isLeftButton(e)){return}if(_this.options.disableUserInput){return}_this._trySetFocus();if(Utility.IsFireFox4OrLater()){_this._stopEvent(e)}_this.element.data("breakSpinner",false);_this._addState("active",$(_this));_this._doSpin($(e.currentTarget).attr("role")=="upbutton",true)},spinButtonUp=function(e){if(_this.options.disabled){return}if(!isLeftButton(e)){return}if(_this.options.disableUserInput){return}_this._stopSpin();_this._removeState("active",$(_this))};if(this.triggerBtn&&!options.disabledState){this.triggerBtn.bind({mouseover:function(){if(_this.options.disabled){return}_this._addState("hover",$(_this))},mouseout:function(){if(_this.options.disabled){return}_this._removeState("hover",$(_this))},mousedown:function(e){if(_this.options.disabled){return}if(!isLeftButton(e)){return}_this._stopEvent(e);_this._addState("active",$(_this));_this._trigger("triggerMouseDown");_this._trigger("dropDownButtonMouseDown");_this._onTriggerMouseDown(e)},mouseup:function(e){_this._onTriggerMouseUp(e)},click:function(e){if(_this.options.disabled){return}_this._stopEvent(e);_this._stopSpin();_this._removeState("active",$(_this));_this._trigger("triggerMouseUp");_this._trigger("dropDownButtonMouseUp");_this._onTriggerClicked();_this._trySetFocus()}})}if(this.spinUpElement&&!options.disabledState){this.spinUpElement.bind({mouseover:function(){if(_this.options.disabled){return}_this._addState("hover",$(_this))},mouseout:function(){if(_this.options.disabled){return}_this._removeState("hover",$(_this));_this._removeState("active",$(_this));_this._stopSpin()},mousedown:spinButtonDown,mouseup:spinButtonUp})}if(this.spinDownElement&&!options.disabledState){this.spinDownElement.bind({mouseover:function(){if(_this.options.disabled){return}_this._addState("hover",$(_this))},mouseout:function(){if(_this.options.disabled){return}_this._removeState("hover",$(_this));_this._removeState("active",$(_this));_this._stopSpin()},mousedown:spinButtonDown,mouseup:spinButtonUp})}this._attachInputEvent();this.element.data("initializing",false);this._resetData();this._endUpdate();this._updateText();if(this.options.disabledState){var dis=options.disabled;this.disable();options.disabled=dis}if(this.options.disabled){this.disable()}if(this.options.imeMode){this.element.css("ime-mode",this.options.imeMode)}this.element.data("initialized",true);this._trigger("initialized")};wijinputcore.prototype._attachInputEvent=function(){this.element.bind({"focus.wijinput":$.proxy(this._onFocus,this),"beforedeactivate.wijinput":$.proxy(this._onBeforeDeactivate,this),"blur.wijinput":$.proxy(this._onBlur,this),"mousedown.wijinput":$.proxy(this._onMouseDown,this),"mouseup.wijinput":$.proxy(this._onMouseUp,this),"keypress.wijinput":$.proxy(this._onKeyPress,this),"keydown.wijinput":$.proxy(this._onKeyDown,this),"keyup.wijinput":$.proxy(this._onKeyUp,this),"compositionstart.wijinput":$.proxy(this._onCompositionStart,this),"compositionend.wijinput":$.proxy(this._onCompositionEnd,this),"change.wijinput":$.proxy(this._onChange,this),"paste.wijinput":$.proxy(this._onPaste,this),"drop.wijinput":$.proxy(this._onDrop,this)});this.element.bind("propertychange.wijinput input.wijinput",$.proxy(this._onInput,this))};wijinputcore.prototype._detachInputEvent=function(){this.element.unbind(".wijinput")};wijinputcore.prototype._init=function(){if(this.element.attr("readOnly")){this.options.readonly=true}if(this.options.readonly===true){this.options.disableUserInput=true}if(this.options.readonly===true||this.options.disableUserInput===true){this.element.attr("readOnly",true)}if(this.options.placeholder!=null){this.options.nullText=this.options.placeholder}if(this.options.showTrigger!=undefined){this._setOption("showDropDownButton",this.options.showTrigger)}};wijinputcore.prototype._showNullText=function(){return !!this.options.nullText||this.options.nullText===""};wijinputcore.prototype._setOption=function(key,value){switch(key){case"readonly":this._super(key,value);key="disableUserInput";break;case"placeholder":this._super(key,value);key="nullText";break;case"showTrigger":this.options.showDropDownButton=value;break}this._super(key,value);switch(key){case"spinnerAlign":case"dropDownButtonAlign":case"showDropDownButton":case"buttonAlign":case"showTrigger":case"showSpinner":this._destroy();this._create();break;case"showNullText":case"nullText":this._updateText();break;case"imeMode":this.element.css("ime-mode",this.options.imeMode);break;case"disabled":this.element.attr("disabled",value);var addRemove=value?"addClass":"removeClass";var stateDisabled=this.options.wijCSS.stateDisabled;this.element[addRemove](stateDisabled);if(this.triggerBtn){this.triggerBtn[addRemove](stateDisabled)}if(this.spinUpElement){this.spinUpElement[addRemove](stateDisabled)}if(this.spinDownElement){this.spinDownElement[addRemove](stateDisabled)}break;case"disableUserInput":this.element.attr("readOnly",value);break}};wijinputcore.prototype.destroy=function(){this._super();if(this._comboDiv){this._comboDiv.remove()}this._destroy()};wijinputcore.prototype.drop=function(){this._onTriggerClicked()};wijinputcore.prototype.isDestroyed=function(){return !this.outerDiv};wijinputcore.prototype._destroy=function(){if(this.isDestroyed()){return}this.wrapper=undefined;this.outerDiv=undefined;this._detachInputEvent();this.element.removeData("errorstate").removeData("breakSpinner").removeData("prevCursorPos").removeData("simulating").removeData("isPassword").removeClass(this.options.wijCSS.wijinputInput).removeAttr("role").removeAttr("aria-valuemin").removeAttr("aria-valuemax").removeAttr("aria-valuenow").removeAttr("aria-expanded");this.element.parent().replaceWith(this.element);this.element.parent().replaceWith(this.element);if($.effects&&$.effects.restore){$.effects.restore(this.element,["width","height"])}else{if($.restore){$.restore(this.element,["width","height"])}}};wijinputcore.prototype.widget=function(){return this.outerDiv||this._super()};wijinputcore.prototype._getCulture=function(name){if(typeof name==="undefined"){name=this.options.culture}return Globalize.findClosestCulture(name||this.options.culture)};wijinputcore.prototype._addState=function(state,el){if(el.is(":not(.ui-state-disabled)")){el.addClass(this.options.wijCSS.getState(state))}};wijinputcore.prototype._removeState=function(state,el){el.removeClass(this.options.wijCSS.getState(state))};wijinputcore.prototype._isInitialized=function(){return !this.element.data("initializing")};wijinputcore.prototype._setData=function(val){this.setText(val)};wijinputcore.prototype._resetData=function(){};wijinputcore.prototype._validateData=function(){};wijinputcore.prototype.getText=function(){if(!this._isInitialized()){return this.element.val()}return this._textProvider.toString(true,false,false)};wijinputcore.prototype.setText=function(value){if(!this._isInitialized()){this.element.val(value)}else{this._textProvider.setText(value);this._updateText()}};wijinputcore.prototype.getPostValue=function(){if(!this._isInitialized()){return this.element.val()}return this._textProvider.toString(true,false,true)};wijinputcore.prototype.selectText=function(start,end){if(typeof start==="undefined"){start=0}if(typeof end==="undefined"){end=this.getText().length}if(isNaN(start)){start=0}if(isNaN(end)){end=0}if(Utility.IsFireFox4OrLater()){this.focus()}if(this.element.is(":disabled")){return}this.element.wijtextselection(start,end)};wijinputcore.prototype.focus=function(){if(this.element.is(":disabled")){return}this.element.get(0).focus()};wijinputcore.prototype.isFocused=function(){if(!this.outerDiv){return false}return this.outerDiv.hasClass(this.options.wijCSS.stateFocus)};wijinputcore.prototype._raiseTextChanged=function(){var txt=this.element.val(),preText=this.element.data("preText");if(!!this.element.data("initialized")&&preText!==txt){this._trigger("textChanged",null,{text:txt});this.element.data("changed",true)}this.element.data("preText",txt)};wijinputcore.prototype._raiseDataChanged=function(){};wijinputcore.prototype._allowEdit=function(){return !this.element.is(":disabled")};wijinputcore.prototype._updateText=function(keepSelection){if(typeof keepSelection==="undefined"){keepSelection=false}if(!this._isInitialized()){return}keepSelection=!!keepSelection;var range;if(this.element.data("selectionbeforeblur")!==undefined){range=this.element.data("selectionbeforeblur");this.element.removeData("selectionbeforeblur")}else{range=this.element.wijtextselection()}var opt=this.options;if(this.isDeleteAll&&this._showNullText()){this.isDeleteAll=false;opt.date=null;this.element.val(opt.nullText)}else{this.element.val(this._textProvider.toString());this.options.text=this._textProvider.toString(true,false,false)}if(this.element.is(":disabled")){return}if(keepSelection){this.selectText(range.start,range.end)}this.element.data("prevCursorPos",range.start);this._raiseTextChanged();this._raiseDataChanged()};wijinputcore.prototype._trySetFocus=function(){if(document.activeElement!==this.element[0]){try{if(!this.options.disableUserInput){this.element.focus()}}catch(e){}}};wijinputcore.prototype._deleteSelText=function(backSpace){if(typeof backSpace==="undefined"){backSpace=false}if(!this._allowEdit()){return}var selRange=this.element.wijtextselection();if(backSpace){if(selRange.end<1){return}if(selRange.end===selRange.start){selRange.start--}}selRange.end--;if(selRange.end<selRange.start){selRange.end=selRange.start}var rh=new wijInputResult();this._textProvider.removeAt(selRange.start,selRange.end,rh);this._updateText();this.selectText(rh.testPosition,rh.testPosition)};wijinputcore.prototype._fireIvalidInputEvent=function(chr){var _this=this;var invalidInputResult=this._trigger("invalidInput",null,{widget:this,"char":chr});if($.isFunction(this.options.invalidInput)&&invalidInputResult===true){return}if(!this.element.data("errorstate")){var cls=this.options.invalidClass||this.options.wijCSS.stateError;this.element.data("errorstate",true);window.setTimeout(function(){if(_this.outerDiv){_this.outerDiv.removeClass(cls)}_this.element.data("errorstate",false)},200);this.outerDiv.addClass(cls)}};wijinputcore.prototype._onInput=function(e){if(!this._isSimulating()||!this.element.data("ime")||this.element.data("isComposingIME")){if(this.element.data("isComposingIME")){this.element.data("simulationPending",true)}return}this._simulate()};wijinputcore.prototype._keyDownPreview=function(e){var key=e.keyCode||e.which;if(e.ctrlKey===true&&key===88){return true}if(e.ctrlKey===true&&key===90){return true}return false};wijinputcore.prototype._onDoubleByteCharacter=function(){var prev=this.element.data("lastDbsState");var curSel=this.element.wijtextselection();var curText=this.element.val();if(this.element.data("isComposingIME")&&prev&&prev.selection.start===curSel.start&&prev.Text===curText){this.element.removeData("lastDbsState");this._onCompositionEnd()}else{this.element.data("lastDbsState",{selection:curSel,text:curText});this._onCompositionStart()}};wijinputcore.prototype._onCompositionStart=function(){if(this.element.data("isComposingIME")){return}this.element.data("isComposingIME",true);this._beforeSimulate(true)};wijinputcore.prototype._onCompositionEnd=function(){if(!this.element.data("isComposingIME")){return}this.element.data("isComposingIME",false);if(this._isInitialized()&&(!this._textProvider||!this._textProvider.noMask)){this._simulateIfPending()}};wijinputcore.prototype._simulateIfPending=function(){if(this.element.data("simulationPending")&&this.element.data("lastSelection")){this._simulate()}};wijinputcore.prototype._beforeSimulate=function(ime){if(typeof ime==="undefined"){ime=false}if(!this.element.data("lastSelection")){this.element.data("lastSelection",this.element.wijtextselection());this.element.data("lastValue",this.element.val())}this.element.data("ime",ime);this.element.data("simulating",true)};wijinputcore.prototype._isSimulating=function(){return this.element.data("simulating")};wijinputcore.prototype._simulate=function(text){var self=this;var str=null;this.element.data("simulationPending",false);if(typeof text==="string"){str=text}else{var range=this.element.wijtextselection();var start=this.element.data("lastSelection").start;var end=range.end;if(end>=start){str=this.element.val().substring(start,end)}}if(str){window.setTimeout(function(){if(self._isLastValueNull()){return}self.element.val(self.element.data("lastValue"));var lastSel=self.element.data("lastSelection");self.element.wijtextselection(lastSel);self.element.data("batchKeyPress",true);self.element.data("simulating",false);var e=jQuery.Event("keypress");e.ctrlKey=e.altKey=false;for(var i=0;i<str.length;i++){e.which=e.charCode=e.keyCode=str.charCodeAt(i);self.element.data("nextChar",i===str.length-1?"":str.charAt(i+1));self._onKeyPress(e);self.element.data("nextChar","");var appendChar=self.element.data("appendChar");if(appendChar&&appendChar.length>0){self.element.data("appendChar","");e.which=e.charCode=e.keyCode=appendChar.charCodeAt(i);self._onKeyPress(e)}if(self.element.data("skipNextChar")){i++;self.element.data("skipNextChar",false)}}self.element.data("batchKeyPress",false);self._endSimulate()},1)}};wijinputcore.prototype._isLastValueNull=function(){return !this.element.data("lastValue")};wijinputcore.prototype._endSimulate=function(){this._simulateIfPending();this.element.removeData("ime");this.element.removeData("lastSelection");this.element.removeData("lastValue")};wijinputcore.prototype._processKeyForDropDownList=function(e){var k=this._getKeyCode(e);if(e.altKey&&(k===jqKeyCode.UP||k===jqKeyCode.DOWN)){this._onTriggerClicked();this._stopEvent(e);return true}if(k===jqKeyCode.ESCAPE){if(this._wasPopupShowing){this._hidePopup();this._stopEvent(e);return true}}if(this._wasPopupShowing&&this._comboDiv!==undefined){if(k===jqKeyCode.DOWN){try{this._comboDiv.wijlist("next")}catch(ee){}this._stopEvent(e);return true}else{if(k===jqKeyCode.UP){try{this._comboDiv.wijlist("previous")}catch(ee){}this._stopEvent(e);return true}else{if(k===jqKeyCode.ENTER){this._comboDiv.wijlist("select");this._stopEvent(e);return true}else{if(k===jqKeyCode.PAGE_DOWN){try{this._comboDiv.wijlist("nextPage")}catch(ee){}this._stopEvent(e);return true}else{if(k===jqKeyCode.PAGE_UP){try{this._comboDiv.wijlist("previousPage")}catch(ee){}this._stopEvent(e);return true}}}}}}};wijinputcore.prototype._processKeyOnNoMask=function(e){var k=this._getKeyCode(e);if(k===jqKeyCode.Enter){this._onEnterDown(e)}if(k===jqKeyCode.LEFT||k===jqKeyCode.RIGHT){if(this._processLeftRightKey(k===jqKeyCode.LEFT)){this._stopEvent(e);return}}this._processKeyForDropDownList(e)};wijinputcore.prototype._onKeyDown=function(e){this.element.data("prevCursorPos",-1);this._deleteKeyDown=false;if(!this._isInitialized()){return}if(this._textProvider&&!!this._textProvider.noMask){this._processKeyOnNoMask(e);return}var k=this._getKeyCode(e);if(k===229){this._onDoubleByteCharacter();return}this._onCompositionEnd();if(this.options.disableUserInput){if(k===jqKeyCode.TAB){if(this._processTabKey(e)){this._stopEvent(e)}}else{this._stopEvent(e)}return}if(this._keyDownPreview(e)){this._stopEvent(e);return}if(this._processKeyForDropDownList(e)){return}switch(k){case jqKeyCode.UP:this._doSpin(true,false);this._stopEvent(e);return;case jqKeyCode.DOWN:this._doSpin(false,false);this._stopEvent(e);return;case jqKeyCode.LEFT:case jqKeyCode.RIGHT:if(this._processLeftRightKey(k===jqKeyCode.LEFT)){this._stopEvent(e)}return;case jqKeyCode.TAB:if(this._processTabKey(e)){this._stopEvent(e)}return}if(e.ctrlKey){switch(k){case jqKeyCode.INSERT:case 67:return;default:break}}if(e.ctrlKey||e.altKey){return}switch(k){case 112:case 113:case 114:case 115:case 116:case 117:case jqKeyCode.TAB:case jqKeyCode.CAPSLOCK:case jqKeyCode.END:case jqKeyCode.HOME:case jqKeyCode.CTRL:case jqKeyCode.SHIFT:return;case jqKeyCode.BACKSPACE:this._deleteSelText(true);this._stopEvent(e);return;case jqKeyCode.DELETE:this._deleteSelText(false);this._stopEvent(e);this._deleteKeyDown=true;return;case jqKeyCode.ENTER:this._onEnterDown(e);break;case jqKeyCode.ESCAPE:this._stopEvent(e);window.setTimeout($.proxy(this._resetData,this),1);return;case jqKeyCode.PAGE_UP:case jqKeyCode.PAGE_DOWN:case jqKeyCode.ALT:this._stopEvent(e);return}};wijinputcore.prototype._onEnterDown=function(e){if(this.options.hideEnter){this._stopEvent(e)}};wijinputcore.prototype._onKeyUp=function(e){if(this._textProvider&&!!this._textProvider.noMask){return}var key=this._getKeyCode(e);if(this._isSimulating()){if(key===jqKeyCode.ENTER){this._onCompositionEnd()}return}if(!this._isInitialized()){return}if(key===jqKeyCode.ENTER||key===jqKeyCode.ESCAPE){return}if(this.options.disableUserInput){this._raiseTextChanged();this._raiseDataChanged();return}this._stopEvent(e)};wijinputcore.prototype._getKeyCode=function(e){var userAgent=window.navigator.userAgent;if((userAgent.indexOf("iPod")!==-1||userAgent.indexOf("iPhone")!==-1)&&e.which===127){return 8}return e.keyCode||e.which};wijinputcore.prototype._keyPressPreview=function(e){return false};wijinputcore.prototype._onKeyPress=function(e){if(this._isSimulating()||(this._textProvider&&!!this._textProvider.noMask)){return}this.element.data("prevCursorPos",-1);if(this.options.disableUserInput){return}if(!this._allowEdit()){return}if(e.ctrlKey&&e.keyCode===119){this._onPaste(e);return}var key=e.keyCode||e.which;if(Utility.IsFireFox4OrLater()){switch(e.keyCode){case jqKeyCode.UP:case jqKeyCode.DOWN:case jqKeyCode.LEFT:case jqKeyCode.RIGHT:case jqKeyCode.HOME:case jqKeyCode.END:return}}switch(key){case 0:case jqKeyCode.TAB:return;case jqKeyCode.BACKSPACE:this._stopEvent(e);return;case jqKeyCode.DELETE:if(this._deleteKeyDown){this._stopEvent(e);return}break;case jqKeyCode.ENTER:if(this.options.hideEnter){this._stopEvent(e)}return}if(e.ctrlKey||e.altKey){if(key!==jqKeyCode.SPACE){return}}if(this._keyPressPreview(e)){return}var ch=String.fromCharCode(key);var rh=this._textProvider.replaceWith(this.element.wijtextselection(),ch);if(rh){this._updateText();this.selectText(rh.testPosition+1,rh.testPosition+1);this.element.data("prevCursorPos",rh.testPosition+1)}else{this._fireIvalidInputEvent(ch)}if(!this.element.data("batchKeyPress")){this._stopEvent(e)}};wijinputcore.prototype._isNullText=function(val){val=val||this.element.val();return this._showNullText()&&val===this.options.nullText};wijinputcore.prototype._doFocus=function(){var selRange=this.element.wijtextselection();var sta=selRange.start;this._updateText();var s=this.element.val();if(s.length===sta){sta=0}if(!$.browser.safari){this.selectText(sta,sta)}};wijinputcore.prototype._afterFocused=function(){if(this._isNullText()){this._doFocus()}};wijinputcore.prototype._onFocus=function(e){if(this.options.disableUserInput){return}this._addState("focus",this.outerDiv);if(!this.element.data("breakSpinner")){return}if(!this._isInitialized()){return}if(!this._allowEdit()){return}if(!this.element.data("focusNotCalledFirstTime")){this.element.data("focusNotCalledFirstTime",new Date().getTime())}this._afterFocused()};wijinputcore.prototype._onBeforeDeactivate=function(e){if(this.options.disableUserInput){return}if(!this.element.data("breakSpinner")){return}if(!this._isInitialized()){return}if(!this._allowEdit()){return}this.element.data("selectionbeforeblur",this.element.wijtextselection())};wijinputcore.prototype._onBlur=function(e){if(this.options.disableUserInput){return}this._onCompositionEnd();if(this._isComboListVisible()){return}var isFocused=this.isFocused();this._removeState("focus",this.outerDiv);if(!this.element.data("breakSpinner")){this.element.get(0).focus();var curPos=this.element.data("prevCursorPos");if(curPos!==undefined&&curPos!==-1){this.selectText(curPos,curPos)}return}if(!this._isInitialized()||!isFocused){return}this.element.data("value",this.element.val());this._updateTextOnLostFocus()};wijinputcore.prototype._updateTextOnLostFocus=function(){var _this=this;window.setTimeout(function(){_this._onChange();_this._updateText();_this._validateData();if(_this.element.data("changed")){_this.element.data("changed",false);if(!_this._popupVisible()){_this._trigger("change");_this.element.change()}}},100)};wijinputcore.prototype._popupVisible=function(){return this._wasPopupShowing};wijinputcore.prototype._onMouseDown=function(e){if(!this._isInitialized()){return}if(this.element.is(":disabled")){return}if(Utility.IsMouseDownOnClearButton(e)){var isFocused=false;try{isFocused=document.activeElement===e.target}catch(ee){}this.element.data("focusedWhenMouseDown",isFocused);this.element.data("mouseDownOnClearButton",true);return}};wijinputcore.prototype._onMouseUp=function(e){if(!this._isInitialized()){return}if(this.element.is(":disabled")){return}if(Utility.IsMouseDownOnClearButton(e)&&this.element.data("mouseDownOnClearButton")&&this.element.data("focusedWhenMouseDown")===true){if(!this.options.disableUserInput){var self=this;setTimeout(function(){self._processClearButton()},0)}this.element.data("mouseDownOnClearButton",false);return}this.element.data("mouseDownOnClearButton",false);this.element.data("focusedWhenMouseDown",false);var selRange=this.element.wijtextselection();this.element.data("prevCursorPos",selRange.start);if(this.element.val()==""){return}var self=this;setTimeout(function(){if(self.element.val()==""){self.setText("")}},5)};wijinputcore.prototype._onChange=function(){if(!this.element){return}var val=this.element.val();var txt=this.getText();if(txt!==val){this.setText(val)}};wijinputcore.prototype._onPaste=function(e){if(this._textProvider&&!!this._textProvider.noMask){return}this._beforeSimulate();var self=this;window.setTimeout(function(){self._simulate()},1)};wijinputcore.prototype._onDrop=function(e){this._beforeSimulate();if(e.originalEvent&&e.originalEvent.dataTransfer){var text=e.originalEvent.dataTransfer.getData("Text");if(text){this._simulate(text)}}};wijinputcore.prototype._stopEvent=function(e){e.stopPropagation();e.preventDefault()};wijinputcore.prototype._calcSpinInterval=function(){this._repeatingCount++;if(this._repeatingCount>10){return 50}else{if(this._repeatingCount>4){return 100}else{if(this._repeatingCount>2){return 200}}}return 400};wijinputcore.prototype._doSpin=function(up,repeating){return false};wijinputcore.prototype._stopSpin=function(){this.element.data("breakSpinner",true);this._repeatingCount=0;var spintimer=this.element.data("spintimer");if(spintimer){clearTimeout(spintimer);this.element.data("spintimer",undefined)}};wijinputcore.prototype._hasComboItems=function(){return !!this._getcomboItems()&&this._getcomboItems().length};wijinputcore.prototype._getcomboItems=function(){if(!!this.options.comboItems&&this.options.comboItems.length>0){return this.options.comboItems}return this.options.pickers.list};wijinputcore.prototype._getcomboWidth=function(){return this.options.comboWidth||this.options.pickers.width};wijinputcore.prototype._getcomboHeight=function(){return this.options.comboHeight||this.options.pickers.height};wijinputcore.prototype._isComboListVisible=function(){if(!this._comboDiv){return false}return this._comboDiv.wijpopup("isVisible")};wijinputcore.prototype._createComboDiv=function(){var _this=this;if(this._comboDiv===undefined){this._comboDiv=$("<div></div>").appendTo(document.body).css("position","absolute");var content=this._normalize(this._getcomboItems());this._comboDiv.wijlist({maxItemsCount:5,selected:function(event,ui){if(!_this.options.disableUserInput){_this._setData(ui.item.value)}_this._comboDiv.wijpopup("hide");_this._trySetFocus()}});this._comboDiv.wijlist("setItems",content);this._comboDiv.wijlist("renderList")}};wijinputcore.prototype._popupComboList=function(){var _this=this;if(!this._hasComboItems()){return false}if(!this._allowEdit()){return false}this._createComboDiv();this._comboDiv.width(this.outerDiv.width());this._comboDiv.wijlist("option","autoSize",!this._getcomboHeight());if(this._getcomboHeight()){this._comboDiv.height(this._getcomboHeight())}if(this._getcomboWidth()&&parseInt(this._getcomboWidth())!==this._comboDiv.width()){this._comboDiv.wijlist("destroy");this._comboDiv.remove();delete this._comboDiv;this._createComboDiv();this._comboDiv.width(this._getcomboWidth());this._comboDiv.wijlist("option","autoSize",!this._getcomboHeight());if(this._getcomboHeight()){this._comboDiv.height(this._getcomboHeight())}}this._comboDiv.wijlist("refreshSuperPanel");this._comboDiv.wijpopup({autoHide:true,hidden:function(){_this._trigger("dropDownClose");_this._wasPopupShowing=false;_this._comboDiv.wijlist("unselectItems");_this._comboDiv.wijlist("deactivate")},shown:function(){_this._trigger("dropDownOpen");_this._wasPopupShowing=true}});this.outerDiv.attr("aria-expanded",true);this._comboDiv.wijpopup("show",{of:this.outerDiv,offset:"0 4",hidden:function(){_this.outerDiv.attr("aria-expanded",false)}});return true};wijinputcore.prototype._normalize=function(items){if(items.length&&items[0].label&&items[0].value){return items}return $.map(items,function(item){if(typeof item==="string"){return{label:item,value:item}}return $.extend({label:item.label||item.value,value:item.value||item.label},item)})};wijinputcore.prototype._processLeftRightKey=function(isLeft){return false};wijinputcore.prototype._processTabKey=function(e){return false};wijinputcore.prototype._moveControl=function(currentElement,isForward,isUseLeftRightKey){var elements=Utility.GetElements();var ret=null;var retInfo={};if(elements.length<2){return null}var nextElement=Utility.GetNextFocusableControl(currentElement,elements,isForward);setTimeout(function(){Utility.SetElementFocus(nextElement)},0)};wijinputcore.prototype._processClearButton=function(){};return wijinputcore})(wijmo.wijmoWidget);input.wijinputcore=wijinputcore;var wijinputClass="wijmo-wijinput",classPrefix=wijinputClass+"-";var wijinputcore_options=(function(){function wijinputcore_options(){this.wijCSS={wijinput:wijinputClass,wijinputInput:classPrefix+"input",wijinputWrapper:classPrefix+"wrapper",wijinputWrapperSpinnerLeft:classPrefix+"wrapper-spinner-left",wijinputWrapperSpinnerRight:classPrefix+"wrapper-spinner-right",wijinputTrigger:classPrefix+"trigger",wijinputSpinnerLeft:classPrefix+"spinner-left",wijinputSpinnerRight:classPrefix+"spinner-right",wijinputButton:classPrefix+"button",wijinputSpin:classPrefix+"spin",wijinputSpinUp:classPrefix+"spinup",wijinputSpinDown:classPrefix+"spindown",iconPlus:"ui-icon-plus",iconMinus:"ui-icon-minus"};this.imeMode="";this.culture="";this.invalidClass=$.wijmo.wijCSS.stateError;this.nullText=undefined;this.placeholder=undefined;this.showNullText=false;this.hideEnter=false;this.disableUserInput=false;this.readonly=false;this.buttonAlign=null;this.dropDownButtonAlign="right";this.showDropDownButton=false;this.showTrigger=undefined;this.showSpinner=false;this.comboItems=undefined;this.comboWidth=undefined;this.comboHeight=undefined;this.blurOnLeftRightKey="none";this.spinnerAlign="verticalRight";this.allowSpinLoop=false;this.pickers={list:undefined,width:undefined,height:undefined};this.dropDownOpen=null;this.dropDownClose=null;this.initializing=null;this.initialized=null;this.triggerMouseDown=null;this.triggerMouseUp=null;this.dropDownButtonMouseDown=null;this.dropDownButtonMouseUp=null;this.textChanged=null;this.invalidInput=null}return wijinputcore_options})();wijinputcore.prototype.options=$.extend(true,{},wijmo.wijmoWidget.prototype.options,new wijinputcore_options());var wijInputResult=(function(){function wijInputResult(){this.characterEscaped=1;this.noEffect=2;this.sideEffect=3;this.success=4;this.unknown=0;this.hint=0;this.alphanumericCharacterExpected=-2;this.asciiCharacterExpected=-1;this.digitExpected=-3;this.invalidInput=-51;this.letterExpected=-4;this.nonEditPosition=-54;this.positionOutOfRange=-55;this.promptCharNotAllowed=-52;this.signedDigitExpected=-5;this.unavailableEditPosition=-53;this.testPosition=-1;this.binaryExpected=-6}wijInputResult.prototype.clone=function(){var rh=new wijInputResult();rh.hint=this.hint;rh.testPosition=this.testPosition;return rh};return wijInputResult})();input.wijInputResult=wijInputResult;var wijTextProvider=(function(){function wijTextProvider(){}wijTextProvider.prototype.setText=function(value,rh){};wijTextProvider.prototype.toString=function(ignorePasswordChar,includePrompt,includeLiterals,start,length){return""};wijTextProvider.prototype.insertAt=function(character,index,rh){return false};wijTextProvider.prototype.removeAt=function(start,end,rh,skipCheck){};wijTextProvider.prototype.replaceWith=function(range,text){var index=range.start;var result=new wijInputResult();if(range.start<range.end){this.removeAt(range.start,range.end-1,result,true);index=result.testPosition}return this.insertAt(text,index,result)?result:null};return wijTextProvider})();input.wijTextProvider=wijTextProvider;var Utility=(function(){function Utility(){}Utility.IdCounter=0;Utility.EditFieldSuffix="_EidtField";Utility.MaskValChar="\ufeff";Utility.Hold="g-C2";Utility.FireEvent=function FireEvent(oControl,eventHandler,eArgs,eventName){if(!eventHandler){return false}try{eventHandler.call(window,oControl,eArgs)}catch(ex){return false}return true};Utility.FindIMControl=function FindIMControl(id){};Utility.ArrayIndexOf=function ArrayIndexOf(array,obj){if(array.indeOf){return array.indexOf(obj)}else{for(var i=0;i<array.length;i++){if(array[i]===obj){return i}}}return -1};Utility.AttachEvent=function AttachEvent(element,type,handler,useCapture){if(element!==null&&element!==undefined){if(element.addEventListener){element.addEventListener(type,handler,useCapture)}else{if(element.attachEvent){element.attachEvent("on"+type,handler)}}}};Utility.AttachFocusEventOfDocument=function AttachFocusEventOfDocument(){if(Utility.IsIE8OrBelow()){Utility.AttachEvent(document,"beforeactivate",function(evt){Utility.FocusControlUpdate(evt)},true)}else{Utility.AttachEvent(document,"focus",function(evt){Utility.FocusControlUpdate(evt)},true)}};Utility.FocusControlUpdate=function FocusControlUpdate(evt){Utility.PreviousFocusControl=Utility.FocusControl;Utility.FocusControl=evt.target||evt.srcElement};Utility.ToString=function ToString(value,length,ch,position){var val=value+"";if(ch!=null){while(val.length<length){if(position){val=val+ch}else{val=ch+val}}return val}while(val.length<length){val+=value+""}return val};Utility.GetSelectionEndPosition=function GetSelectionEndPosition(obj){if(!Utility.IsIE()||Utility.IsIE11OrLater()){var endS=0;endS=obj.selectionEnd;if(obj.value){var text=obj.value.substring(0,endS);endS=text.GetLength()}var startS=0;startS=obj.selectionStart;if(obj.value){var text=obj.value.substring(0,startS);startS=text.GetLength()}if(startS>endS){endS=startS}return endS}return Utility.GetSelectionStartPosition(obj)+document.selection.createRange().text.GetLength()};Utility.GetSelectionStartPosition=function GetSelectionStartPosition(obj){if(obj.selectionStart!=null){var startS=0;startS=obj.selectionStart;if(obj.value){var text=obj.value.substring(0,startS);startS=text.GetLength()}var endS=0;endS=obj.selectionEnd;if(obj.value){var text=obj.value.substring(0,endS);endS=text.GetLength()}if(endS<startS){startS=endS}return startS}try{var rng=obj.createTextRange();var sng=document.selection.createRange();var length=obj.value.GetLength();var start=0;var end=length;var i=0;while(start<end){i=Math.floor((start+end)/2);rng=obj.createTextRange();var s=i;var text=obj.value.Substring(0,i);while(1){var index=text.IndexOf("\r\n");if(index!=-1){s--;text=text.Substring(index+2,text.GetLength())}else{break}}var gap=i-s;s=i-gap;rng.moveStart("character",s);if(rng.offsetTop>sng.offsetTop){end=i}else{if(rng.offsetTop<sng.offsetTop){if(start==i){return end}start=i}else{if(rng.offsetLeft>sng.offsetLeft){end=i}else{if(rng.offsetLeft<sng.offsetLeft){if(start==i){return end}start=i}else{if(obj.value.Substring(i-1,i)=="\r"){i++}return i}}}}}return length}catch(e){return 0}};Utility.GetCursorPosition=function GetCursorPosition(obj,isPropertyChange){if(obj==null){return -1}if(!Utility.IsIE()||Utility.IsIE11OrLater()){var startS=0;startS=obj.selectionStart;if(obj.value){var text=obj.value.substring(0,startS);startS=text.GetLength()}return startS}var caretPos=0;if(document.selection){obj.focus();var sel=document.selection.createRange();sel.moveStart("character",-obj.value.length);caretPos=sel.text.length}return(caretPos)};Utility.GetPasteData=function GetPasteData(useClipboard){return Utility.GetDataFromClipboard(useClipboard)};Utility.GetDataFromClipboard=function GetDataFromClipboard(useClipboard){if(useClipboard==false){return Utility.SavedText}if(window.clipboardData){return(window.clipboardData.getData("Text"))}else{if(Utility.CutCopyPasteEventObject!==null){if(Utility.CutCopyPasteEventObject.clipboardData!==undefined){return Utility.CutCopyPasteEventObject.clipboardData.getData("text")}}}return null};Utility.ClearSelection=function ClearSelection(inputElement){if(Utility.IsIE()&&!Utility.IsIE11OrLater()){if(document.selection.createRange().text!=""){document.selection.empty()}}else{if(Utility.GetSelectionText(inputElement)!=""){inputElement.selectionStart=inputElement.value.length;inputElement.selectionEnd=inputElement.selectionStart}}};Utility.GetSelectionText=function GetSelectionText(obj){if(obj.selectionStart!=null){return obj.value.substring(obj.selectionStart,obj.selectionEnd)}else{if(document.selection!=null){return document.selection.createRange().text}else{if(document.activeElement!==null){var obj=document.activeElement;var start=obj.selectionStart;var end=obj.selectionEnd;return obj.value.substring(start,end)}}}return""};Utility.GetNextFocusableControl=function GetNextFocusableControl(currentElement,elements,isForward){var index=0;for(var i=0;i<elements.length;i++){if(currentElement===elements[i]){if(isForward){index=(i+1)%(elements.length)}else{index=(i-1+elements.length)%(elements.length)}break}}return elements[index]};Utility.FireSystemEvent=function FireSystemEvent(obj,eventName){if(Utility.IsIE()){obj.fireEvent(eventName)}else{var evt=document.createEvent("HTMLEvents");evt.initEvent(eventName.substring(2,eventName.length),true,true);obj.dispatchEvent(evt)}};Utility.GetTextBoxScrollWidth=function GetTextBoxScrollWidth(input,unuse){return Utility.MeasureText(input.value,input).Width};Utility.MoveFocus=function MoveFocus(curID,isForward){var elements=Utility.GetElements();var nextID=Utility.GetNextFocusableControl(curID,elements,isForward);Utility.SetElementFocus(nextID);return nextID};Utility.SetElementFocus=function SetElementFocus(element){element.focus()};Utility.GetAllElements=function GetAllElements(){if(document.body.querySelectorAll){return document.body.querySelectorAll("button, input, object, select, textarea")}if(document.body.all){return document.body.all}return document.body.getElementsByTagName("*")};Utility.GetElements=function GetElements(){var elements=[];var obj=Utility.GetAllElements();var index=0;var rfocusable=/^(?:button|input|object|select|textarea)$/i;for(var i=0;i<obj.length;i++){if((!document.body.querySelectorAll||Utility.IsIE())&&!rfocusable.test(obj[i].tagName.toLowerCase())){continue}var c3=!obj[i].disabled;var c4=obj[i].style.visibility!=="hidden";var c5=obj[i].type!="hidden"&&obj[i].tabIndex!=-1;var c6=obj[i].tagName.toLowerCase()=="textarea"&&obj[i].tabIndex!=-1;var c7=c5||c6;if(c3&&c4&&c7){elements[index++]=obj[i]}}for(var i=0;i<elements.length-1;i++){for(var j=i+1;j<elements.length;j++){if(elements[j].tabIndex<elements[i].tabIndex){var temp=elements[i];elements[i]=elements[j];elements[j]=temp}}}return elements};Utility.CheckInt=function CheckInt(value,min,max){var intValue=parseInt(value);if(isNaN(intValue)){throw"value is invalid"}if(intValue<min||intValue>max){throw value+" is out of range, should between "+min+" and "+max}return intValue};Utility.CheckFloat=function CheckFloat(value,min,max){var intValue=parseFloat(value);if(isNaN(intValue)){throw"value is invalid"}if(value<min||value>max){throw value+" is out of range, should between "+min+" and "+max}return intValue};Utility.CheckDate=function CheckDate(value,min,max){if(!(value instanceof Date)){throw"Type is invalid"}if(isNaN(value)){throw"Date is a invalid date"}if(max!=undefined){if(value<min||value>max){throw value+" is out of range, should between "+min+" and "+max}}};Utility.CheckBool=function CheckBool(boolValue){if(typeof(boolValue)==="string"){if(boolValue.toLowerCase()==="true"){return true}}return boolValue==true};Utility.CheckFunction=function CheckFunction(fun){if(fun===undefined||fun===null){return null}if(typeof fun=="string"){fun=Utility.Trim(fun);if(fun.length==0){return null}try{eval("fun ="+fun)}catch(e){}}if(typeof fun=="function"){return fun}else{throw"The value is not a valid function"}};Utility.GetCheckElement=function GetCheckElement(){if(Utility.CheckElement==null){var div=document.createElement("div");Utility.CheckElement=div;div.style.display="none"}return Utility.CheckElement};Utility.CheckString=function CheckString(str){if(str===undefined||(typeof(str)!="string"&&!(str instanceof String))){throw str+" type is not a string."}if(str==null){str=""}return str.toString()};Utility.GetCSSLength=function GetCSSLength(length){var intValue=parseInt(length);if(isNaN(intValue)){return 0}return intValue};Utility.CheckCSSLength=function CheckCSSLength(length){length=Utility.CheckInt(length,0,Math.pow(2,31));if(parseInt(length)==length){length+="px"}Utility.GetCheckElement().style.width="";Utility.GetCheckElement().style.width=length;return Utility.GetCheckElement().style.width};Utility.CheckFontSizeValue=function CheckFontSizeValue(length){if(parseInt(length)==length){length+="px"}Utility.GetCheckElement().style.fontSize="";Utility.GetCheckElement().style.fontSize=length;return Utility.GetCheckElement().style.fontSize};Utility.CheckColor=function CheckColor(color){Utility.GetCheckElement().style.backgroundColor="";Utility.GetCheckElement().style.backgroundColor=color;return Utility.GetCheckElement().style.backgroundColor};Utility.CheckImageUrl=function CheckImageUrl(url){return Utility.CheckString(url)};Utility.GetCssImageUrl=function GetCssImageUrl(url){if(url.startWith('url("')){url=url.substring(5,url.length-2)}else{if(url.startWith("url(")){url=url.substring(4,url.length-1)}}return url};Utility.CheckCssImageUrl=function CheckCssImageUrl(url){if(url.length>0&&!url.startWith("url(")){url="url("+url+")"}Utility.GetCheckElement().style.backgroundImage="";Utility.GetCheckElement().style.backgroundImage=url;return Utility.GetCheckElement().style.backgroundImage};Utility.CheckEnum=function CheckEnum(type,value){for(var item in type){if(type[item]==value||type[item]==value.toLowerCase()){return type[item]}}throw"Enum value is invalid"};Utility.CheckChar=function CheckChar(value){value=Utility.CheckString(value);if(value.length!==1){throw"Invalid value"}return value};Utility.GetMultipleStringEnum=function GetMultipleStringEnum(value){var valueList=value.split(" ");valueList.sort();return valueList.join(",")};Utility.CheckMultipleStringEnum=function CheckMultipleStringEnum(type,value){var valueList=value.split(",");var result=[];for(var i=0;i<valueList.length;i++){result.push(Utility.CheckEnum(type,Utility.Trim(valueList[i])))}return result.join(" ")};Utility.EncodingToHTML=function EncodingToHTML(text){if(text.IndexOf("&")!=-1){var tempDispText=text;var tempText="";while(tempDispText.IndexOf("&")!=-1){var findPosition=tempDispText.IndexOf("&");tempDispText=tempDispText.replace("&","&amp;");tempText+=tempDispText.Substring(0,findPosition+5);tempDispText=tempDispText.Substring(findPosition+5,tempDispText.GetLength())}if(tempDispText.IndexOf("&")==-1&&tempDispText!=""){tempText+=tempDispText}text=tempText}while(text.IndexOf(" ")!=-1){text=text.replace(" ","&nbsp;")}while(text.IndexOf("<")!=-1){text=text.replace("<","&lt;")}while(text.IndexOf(">")!=-1){text=text.replace(">","&gt;")}return text};Utility.DecodingFromHTML=function DecodingFromHTML(text){while(text.IndexOf("&nbsp;")!=-1){text=text.replace("&nbsp;"," ")}while(text.IndexOf("&lt;")!=-1){text=text.replace("&lt;","<")}while(text.IndexOf("&gt;")!=-1){text=text.replace("&gt;",">")}if(text.IndexOf("&amp;")!=-1){var tmpText=text;var tmpResult="";while(tmpText.IndexOf("&amp;")!=-1){var temPos=tmpText.IndexOf("&amp;");tmpText=tmpText.replace("&amp;","&");tmpResult+=tmpText.Substring(0,temPos+1);tmpText=tmpText.Substring(temPos+1,tmpText.GetLength())}if(tmpText.IndexOf("&amp;")==-1&&tmpText!=""){tmpResult+=tmpText}text=tmpResult}return text};Utility.IsStandCompliantModeOn=function IsStandCompliantModeOn(){if(!Utility.IsIE()){return document.compatMode=="CSS1Compat"||document.compatMode=="BackCompat"}return document.compatMode=="CSS1Compat"};Utility.GetPageZoomRate=function GetPageZoomRate(){if(Utility.IsIE()&&Utility.engine===8){return screen.deviceXDPI/screen.logicalXDPI}var normalPosition=document.getElementById("gcsh_standard_control_for_get_normal_position");if(typeof(normalPosition)!="undefined"&&normalPosition!=null){return document.getElementById("gcsh_standard_control_for_get_normal_position").offsetLeft/100}else{var div=document.createElement("div");document.body.appendChild(div);div.id="gcsh_standard_control_for_get_normal_position";div.style.visibility="hidden";div.style.left="100px";div.style.top="1px";div.style.width="1px";div.style.height="1px";div.style.position="absolute";return document.getElementById("gcsh_standard_control_for_get_normal_position").offsetLeft/100}};Utility.GetElementPosition=function GetElementPosition(id){if(Utility.IsIE()||Utility.chrome||Utility.safari){if(Utility.engine>=8){var pos1=Utility.GetElementPositionForIE8(id);if(pos1.Left==0&&pos1.Top==0){var pos2=Utility.GetElementPositionForFireFox(id);return pos2}else{return pos1}}else{var posIE7=Utility.GetElementPositionForIE(id);return{Left:posIE7.Left,Top:posIE7.Top}}}return Utility.GetElementPositionForFireFox(id)};Utility.GetElementPositionForIE8=function GetElementPositionForIE8(id){var element=id;if(typeof id=="string"){element=document.getElementById(id)}var top=0;var left=0;if(element==null||element.self||element.nodeType===9){return{Left:left,Top:top}}var clientRect=element.getBoundingClientRect();if(!clientRect){return{Left:left,Top:top}}var documentElement=element.ownerDocument.documentElement;var left=clientRect.left+documentElement.scrollLeft;var top=clientRect.top+documentElement.scrollTop;try{var f=element.ownerDocument.parentWindow.frameElement||null;if(f){var offset=(f.frameBorder==="0"||f.frameBorder==="no")?2:0;left+=offset;top+=offset}}catch(ex){}return{Left:left,Top:top}};Utility.GetElementPositionForIE=function GetElementPositionForIE(id){var oElement=id;if(typeof id=="string"){oElement=document.getElementById(id)}var top=0;var left=0;if(oElement==null){return{Left:left,Top:top}}if(oElement.offsetParent){while(oElement.offsetParent!=null){var parent=oElement.offsetParent;var parentTagName=parent.tagName.toLowerCase();if(parentTagName!="table"&&parentTagName!="body"&&parentTagName!="html"&&parent.clientTop&&parent.clientLeft){left+=parent.clientLeft;top+=parent.clientTop}if(Utility.engine==7&&parent.style.position.toLowerCase()=="relative"){left+=oElement.offsetLeft-oElement.scrollLeft;top+=oElement.offsetTop;var zoom=Utility.GetPageZoomRate();if(zoom==1){var offset=oElement.offsetTop;for(var i=0;i<parent.children.length;i++){var o=parent.children[i];if(o==oElement){break}else{if(o.offsetTop){offset=o.offsetTop;break}}}top-=offset}}else{if(Utility.IsStandCompliantModeOn()&&Utility.engine==7&&(oElement.style.position.toLowerCase()=="absolute"||oElement.style.position.toLowerCase()=="relative")){var zoom=Utility.GetPageZoomRate();top+=(oElement.offsetTop-oElement.scrollTop)/zoom;left+=(oElement.offsetLeft-oElement.scrollLeft)/zoom}else{if((oElement.tagName.toLowerCase()=="input"&&oElement.type.toLowerCase()=="text")||oElement.tagName.toLowerCase()=="textarea"){top+=oElement.offsetTop;left+=oElement.offsetLeft}else{top+=oElement.offsetTop-oElement.scrollTop;left+=oElement.offsetLeft-oElement.scrollLeft}}}oElement=parent}}else{if(oElement.left&&oElement.top){left+=oElement.left;top+=oElement.top}else{if(oElement.x){left+=oElement.x}if(oElement.y){top+=oElement.y}}}if(oElement.style.position.toLowerCase()!="relative"&&oElement.style.position.toLowerCase()!="absolute"&&oElement.tagName.toLowerCase()=="body"&&Utility.IsStandCompliantModeOn()){if(Utility.engine!=7){top+=oElement.offsetTop;left+=oElement.offsetLeft}else{var tempTop=parseInt(oElement.currentStyle.marginTop);var tempLeft=parseInt(oElement.currentStyle.marginLeft);if(isNaN(tempTop)){tempTop=0}if(isNaN(tempLeft)){tempLeft=0}top+=tempTop;left+=tempLeft}}return{Left:left,Top:top}};Utility.GetElementPositionForFireFox=function GetElementPositionForFireFox(id){var oElement=id;if(typeof id=="string"){oElement=document.getElementById(id)}var top=0;var left=0;var scrollLeft=0;var scrollTop=0;if(oElement==null){return{Left:left,Top:top}}if(oElement.offsetParent){while(oElement.offsetParent!=null){var parentTagName=oElement.offsetParent.tagName.toLowerCase();if(parentTagName!="table"&&parentTagName!="body"&&parentTagName!="html"&&parentTagName!="div"&&oElement.offsetParent.clientTop&&oElement.offsetParent.clientLeft){left+=oElement.offsetParent.clientLeft;top+=oElement.offsetParent.clientTop}top+=oElement.offsetTop;left+=oElement.offsetLeft;oElement=oElement.offsetParent}}else{if(oElement.left&&oElement.top){left+=oElement.left;top+=oElement.top}else{if(oElement.x){left+=oElement.x}if(oElement.y){top+=oElement.y}}}oElement=id;if(typeof id==="string"){oElement=document.getElementById(id)}if(oElement.parentElement){while(oElement.parentElement!=null&&oElement.tagName.toLowerCase()!="html"){scrollTop+=oElement.scrollTop;scrollLeft+=oElement.scrollLeft;oElement=oElement.parentElement}}top-=scrollTop;left-=scrollLeft;if(oElement.style.position.toLowerCase()!="relative"&&oElement.style.position.toLowerCase()!="absolute"&&oElement.tagName.toLowerCase()=="body"&&Utility.IsStandCompliantModeOn()){top+=oElement.offsetTop;left+=oElement.offsetLeft}return{Left:left,Top:top}};Utility.MeasureText=function MeasureText(text,domElement){if(Utility.MeasureElement===undefined){var div=document.createElement("div");div.style.position="absolute";div.style.border="solid 0px";div.style.left="-100000px";div.style.top="-100000px";var textNode=window.document.createTextNode("");div.appendChild(textNode);document.body.appendChild(div);Utility.MeasureElement=div;Utility.MeasureTextElement=textNode}var div=Utility.MeasureElement;var textNode=Utility.MeasureTextElement;if(document!=null){var containsElement=document.body.contains(domElement);if(!containsElement){document.body.appendChild(domElement)}var currentStyle=domElement.currentStyle||window.getComputedStyle(domElement,null);div.style.fontFamily=currentStyle.fontFamily;div.style.fontSize=currentStyle.fontSize;div.style.fontStyle=currentStyle.fontStyle;div.style.fontWeight=currentStyle.fontWeight;if(!containsElement){document.body.removeChild(domElement)}}var result=null;if(typeof(text)=="string"){textNode.nodeValue=text;result={Width:div.clientWidth,Height:div.clientHeight}}else{result=[];for(var i=0;i<text.length;i++){textNode.nodeValue=text[i];result.push({Width:div.clientWidth,Height:div.clientHeight})}}return result};Utility.GetOSDefaultFontFamily=function GetOSDefaultFontFamily(){switch(Utility.GetClientOS().toLowerCase()){case"winxp":return"MS UI Gothic";case"vista":return"";case"win7":return"";case"win8":return"Meiryo UI";case"win2003":return"MS UI Gothic";case"win2000":return"MS UI Gothic"}return"MS UI Gothic"};Utility.IsTouchSupport=function IsTouchSupport(){return window.navigator.userAgent.toLowerCase().indexOf("touch")!=-1};Utility.DisabledHoldVisual=function DisabledHoldVisual(element){if(element!==null&&element!==undefined&&Utility.IsTouchSupport()&&Utility.IsIE10OrLater()){element.addEventListener("MSHoldVisual",function(e){e.preventDefault()},false);element.addEventListener("MSGestureHold",function(e){e.preventDefault()},false);element.addEventListener("contextmenu",function(e){e.preventDefault()},false)}};Utility.IsMouseDownOnClearButton=function IsMouseDownOnClearButton(evt){if(!Utility.IsIE10OrLater()){return false}for(var i=0;i<document.styleSheets.length;i++){var styleSheets=document.styleSheets[i];for(var j=0;j<styleSheets.cssRules.length;j++){if(styleSheets.cssRules[j].selectorText=="::-ms-clear"){if(styleSheets.cssRules[j].style.display=="none"){return false}}}}var x=evt.offsetX;var y=evt.offsetY;var textbox=evt.srcElement||evt.target;var width=textbox.clientWidth;var height=textbox.clientHeight;var paddingLeft=parseInt(textbox.currentStyle.paddingLeft);var paddingRight=parseInt(textbox.currentStyle.paddingRight);if(textbox.readOnly||evt.button!=MouseButton.Left){return false}if(width-height+paddingLeft+paddingRight<Utility.GetClearButtonShowThreshold(textbox)){return false}var xx=width-height;if(x>xx&&x<=width&&y>=0&&y<height){return true}else{return false}};Utility.GetClearButtonShowThreshold=function GetClearButtonShowThreshold(textinput){var height=Utility.MeasureText("ABCDQ",textinput).Height;var result=4.3604432*height-0.76207324;result=Math.round(result);return result};Utility.IsFocusFromIMControl=function IsFocusFromIMControl(id,evt){try{var src=evt.fromElement;while(src!=null){if(src.id==id||src.id==id+this.Hold+"_DropDownObj"||src.id==id+"_DropDown_Container"||src.id==id+"_ContextMenu"||src.id==id+"_HistoryList"||src.id==id+"_EditField"||src.id==id+"_BorderContainer"||src.id==id+"_DropDown_EditField"){return true}src=src.parentNode}return false}catch(e){return false}};Utility.IsFocusToIMControl=function IsFocusToIMControl(id,evt){try{var src=evt.toElement;while(src!=null){if(src.id==id||src.id==id+this.Hold+"_DropDownObj"||src.id==id+"_DropDown_Container"||src.id==id+"_ContextMenu"||src.id==id+"_HistoryList"||src.id==id+this.Hold+"_DropDownObj_PopupMonth"||src.id==id+"_EditField"||src.id==id+"_BorderContainer"||src.id==id+"_DropDown_EditField"){return true}src=src.parentNode}return false}catch(e){return false}};Utility.Trim=function Trim(value){if(value==""){return""}var beginIndex=0;var endIndex=0;for(var i=0;i<value.length;i++){if(value.CharAt(i)!=" "&&value.CharAt(i)!=""){beginIndex=i;break}}for(var i=value.length-1;i>=0;i--){if(value.CharAt(i)!=" "&&value.CharAt(i)!=""){endIndex=i+1;break}}try{var s=value.Substring(beginIndex,endIndex);return s}catch(e){return value}};Utility.GetBrowserType=function GetBrowserType(){var ua=navigator.userAgent.toLowerCase();if(ua.indexOf("msie")!=-1){Utility.ie=ua.match(/msie ([\d.]+)/)[1]}else{if(ua.indexOf("chrome")!=-1){Utility.chrome=ua.match(/chrome\/([\d.]+)/)[1]}else{if(ua.indexOf("safari")!=-1){var version=ua.match(/version\/([\d.]+)/);if(version){Utility.safari=version[1]}}else{if(ua.indexOf("firefox")!=-1){Utility.firefox=ua.match(/firefox\/([\d.]+)/)[1]}else{if(ua.indexOf("opera")!=-1){Utility.opera=ua.match(/opera.([\d.]+)/)[1]}}}}}if(ua.indexOf("ipad")!=-1){Utility.IPad=true}Utility.engine=null;if(window.navigator.appName=="Microsoft Internet Explorer"){if(document.documentMode){Utility.engine=document.documentMode}else{Utility.engine=5;if(document.compatMode){if(document.compatMode=="CSS1Compat"){Utility.engine=7}}if(Utility.ie&&Utility.ie.indexOf("6")==0){Utility.engine=6}}}if(ua.indexOf("rv:")!==-1&&ua.indexOf("firefox")===-1){Utility.ie=Utility.engine=ua.match(/rv:([\d.]+)/)[1]}};Utility.GetTouchPath=function GetTouchPath(beginY,endY){if(beginY===-1||endY===-1){return"Error"}if(beginY>endY){return beginY-endY>20?"ToTop":"NotMove"}else{if(beginY<endY){return endY-beginY>20?"ToBottom":"NotMove"}}return"NotMove"};Utility.IsPad=function IsPad(){var result=Utility.IPad||Utility.GetClientOS().toLowerCase()=="android";return result};Utility.IsJapan=function IsJapan(){if(navigator.userLanguage){return navigator.userLanguage.indexOf("ja")!=-1}else{if(navigator.language){return navigator.language.indexOf("ja")!=-1}}return false};Utility.IsFireFox4OrLater=function IsFireFox4OrLater(){return Utility.firefox!=null&&parseFloat(Utility.firefox)>=4};Utility.IsIE11OrLater=function IsIE11OrLater(){return Utility.IsIE()&&Utility.engine>=11};Utility.IsIE10OrLater=function IsIE10OrLater(){return Utility.IsIE()&&Utility.engine>=10};Utility.IsIE9OrLater=function IsIE9OrLater(){return Utility.IsIE()&&Utility.engine>=9};Utility.IsIE8OrLater=function IsIE8OrLater(){return Utility.IsIE()&&Utility.engine>=8};Utility.IsIE8OrBelow=function IsIE8OrBelow(){return Utility.IsIE()&&Utility.engine<=8};Utility.IsIE8=function IsIE8(){return Utility.IsIE()&&Utility.engine==8};Utility.IsIE7=function IsIE7(){return Utility.IsIE()&&Utility.engine==7};Utility.IsIE7OrLater=function IsIE7OrLater(){return Utility.IsIE()&&Utility.engine>=7};Utility.IsIE=function IsIE(){return Utility.ie!==undefined};Utility.IsIE9=function IsIE9(){return Utility.IsIE()&&Utility.engine==9};Utility.GetClientOS=function GetClientOS(){var appVersion;if(!Utility.IsIE()){var osVersion=navigator.userAgent;var start=osVersion.indexOf("(");var end=osVersion.indexOf(")");appVersion=osVersion.substring(start+1,end)}else{appVersion=navigator.appVersion}if(appVersion.indexOf("NT 6.0")!=-1){return"vista"}else{if(appVersion.indexOf("NT 5.2")!=-1){return"win2003"}else{if(appVersion.indexOf("NT 5.1")!=-1){return"winxp"}else{if(appVersion.indexOf("NT 5.0")!=-1){return"win2000"}else{if(appVersion.indexOf("NT 6.1")!=-1){return"Win7"}else{if(appVersion.indexOf("NT 6.2")!=-1){return"Win8"}else{if(appVersion.indexOf("NT 6.3")!=-1){return"Win8"}else{if(appVersion.indexOf("Android")!=-1){return"Android"}}}}}}}}return"unknow"};Utility.CreateStyleElement=function CreateStyleElement(id){var style=document.createElement("style");style.id=id;style.type="text/css";return style};Utility.CreateClassStyle=function CreateClassStyle(className){return Utility.CreateSelectorStyle("."+className)};Utility.CreateSelectorStyle=function CreateSelectorStyle(selectorName){var tableStyle=document.getElementById("tableStyle");if(tableStyle==null){tableStyle=this.CreateStyleElement("tableStyle");document.body.appendChild(tableStyle)}var sheet=tableStyle.sheet||tableStyle.styleSheet;var rules=sheet.cssRules||sheet.rules;if(sheet.insertRule){sheet.insertRule(selectorName+"{ }",rules.length)}else{sheet.addRule(selectorName,"{ }",rules.length)}return rules.item(rules.length-1)};Utility.SetSelection=function SetSelection(element,start,end,multiLine){$(element).wijtextselection(Math.min(start,end),Math.max(start,end))};Utility.PreventDefault=function PreventDefault(evt){if(evt.preventDefault){evt.preventDefault()}else{evt.returnValue=false}};Utility.CancelBubble=function CancelBubble(evt){if(evt.cancelBubble!==undefined){evt.cancelBubble=true}else{evt.stopPropagation()}};Utility.DragDrop=function DragDrop(obj){try{obj.dragDrop(true)}catch(e){}};Utility.GetMouseButton=function GetMouseButton(evt){var mouseButton=MouseButton.Default;var leftKey=Utility.IsIE8OrBelow()?1:0;if(evt.button==leftKey){mouseButton=MouseButton.Left}else{if(evt.button==1){mouseButton=MouseButton.Middle}else{if(evt.button==2){mouseButton=MouseButton.Right}}}return mouseButton};Utility.GetMouseWheelValue=function GetMouseWheelValue(value,evt){if(Utility.IsFireFox4OrLater()){return -evt.detail/3}if(evt.wheelDelta>=120){value++}else{if(evt.wheelDelta<=-120){value--}}return value};Utility.SetCopy=function SetCopy(text,useClipboard){var selText;try{if(text==null||text==""){if(document.selection){selText=document.selection.createRange().text}if(selText==""){return}}}catch(e){}if(text!=null){selText=text}Utility.CopyDataToClipBoard(selText,useClipboard)};Utility.CopyDataToClipBoard=function CopyDataToClipBoard(copytext,useClipboard){if(useClipboard==false){Utility.SavedText=copytext;return}if(window.clipboardData){setTimeout(function(){try{window.clipboardData.setData("Text",copytext)}catch(ex){}},0)}else{if(Utility.CutCopyPasteEventObject!==null){if(Utility.CutCopyPasteEventObject.clipboardData!==undefined){Utility.CutCopyPasteEventObject.clipboardData.setData("text",copytext)}}}};Utility.SetZoomStyle=function SetZoomStyle(element,value,align){if(element===undefined||element===null){return}var zoomOrigin="top left";if(align===DropDownAlign.Right){zoomOrigin="top right"}if(Utility.firefox){element.style.MozTransformOrigin=value===""?"":zoomOrigin;element.style.MozTransform=value===""?"":"scale("+value+")";element.setAttribute("ZoomValue",value)}else{if(Utility.chrome||Utility.safari){if(value!==""){element.style.MozTransform="scale("+value+")";element.style.WebkitTransform="scale("+value+")";element.style.webkitTransformOrigin=zoomOrigin}else{element.style.MozTransform="";element.style.WebkitTransform="";element.style.WebkitTransformOrigin=""}}else{if(Utility.IsIE9OrLater()){if(value!==""){element.style.msTransform="scale("+value+")";element.style.msTransformOrigin=zoomOrigin}else{element.style.msTransform="";element.style.msTransformOrigin=""}}else{element.style.zoom=value}}}};Utility.FilterText=function FilterText(includeText,intext){if(intext.GetLength()==0){return""}var filterText="";var j=0;var i=0;for(j=0;j<intext.GetLength();j++){var valid=false;for(i=0;i<includeText.GetLength();i++){if(intext.Substring(j,j+1)==includeText.Substring(i,i+1)){valid=true}}if(valid==true){filterText+=intext.Substring(j,j+1)}}return filterText};Utility.IndexOfAny=function IndexOfAny(str,anyOf,startIndex){if(startIndex>=str.length){return -1}for(var i=startIndex;i<str.length;i++){for(var j=0;j<anyOf.length;j++){if(str.charAt(i)==anyOf[j]){return i}}}return -1};return Utility})();input.Utility=Utility;Utility.GetBrowserType();var CharType=(function(){function CharType(){this.OtherChar=0;this.Control=1;this.Numeric=2;this.MathSymbol=3;this.Symbol=4;this.Punctuation=5;this.Space=6;this.UpperCase=7;this.LowerCase=8;this.Katakana=9;this.Hiragana=10;this.FarEastPunctation=11;this.Hangul=12;this.FullWidth=32768}return CharType})();input.CharType=CharType;var CharCategory=(function(){function CharCategory(){this.MinValue="\u0000";this.MaxValue="\uffff";this.ANSISTART=0;this.ANSIEND=255;this.BOTHWIDTHSTART=65280;this.BOTHWIDTHEND=65519;this.FULLALPHASTART=65281;this.FULLUPPERSTART=65313;this.FULLUPPEREND=65338;this.FULLALPHAEND=65374;this.CJKHALFSYMBOLSTART=65377;this.CJKHALFSYMBOLEND=65380;this.KANAHALFSTART=65381;this.KANAHALFEND=65439;this.HANGULHALFSTART=65440;this.HANGULHALFEND=65500;this.FULLSYMBOLSTART=65504;this.FULLSYMBOLEND=65510;this.HALFPUNCTSTART=65512;this.HALFPUNCTEND=65518;this.KATAKANA_VOICED="\uff9e";this.KATAKANA_SEMIVOICED="\uff9f";this.Tab="\u0009";this.Space="\u0020";this._charstarts=["\u0000","\u0080","\u0100","\u0180","\u0250","\u02b0","\u0300","\u0370","\u0400","\u0530","\u0590","\u0600","\u0700","\u0780","\u0900","\u0980","\u0a00","\u0a80","\u0b00","\u0b80","\u0c00","\u0c80","\u0d00","\u0d80","\u0e00","\u0e80","\u0f00","\u1000","\u10a0","\u1100","\u1200","\u13a0","\u1400","\u1680","\u16a0","\u1780","\u1800","\u1e00","\u1f00","\u2000","\u2070","\u20a0","\u20d0","\u2100","\u2150","\u2190","\u2200","\u2300","\u2400","\u2440","\u2460","\u2500","\u2580","\u25a0","\u2600","\u2700","\u2800","\u2e80","\u2f00","\u2ff0","\u3000","\u3040","\u30a0","\u3100","\u3130","\u3190","\u31a0","\u3200","\u3300","\u3400","\u4e00","\ua000","\ua490","\uac00","\uf900","\ufb00","\ufb50","\ufe20","\ufe30","\ufe50","\ufe70","\uff00","\ufff0"];this.Blocks=["BASIC_LATIN","LATIN_1_SUPPLEMENT","LATIN_EXTENDED_A","LATIN_EXTENDED_B","IPA_EXTENSIONS","SPACING_MODIFIER_LETTERS","COMBINING_DIACRITICAL_MARKS","GREEK","CYRILLIC","ARMENIAN","HEBREW","ARABIC","SYRIAC","THAANA","DEVANAGARI","BENGALI","GURMUKHI","GUJARATI","ORIYA","TAMIL","TELUGU","KANNADA","MALAYALAM","SINHALA","THAI","LAO","TIBETAN","MYANMAR","GEORGIAN","HANGUL_JAMO","ETHIOPIC","CHEROKEE","UNIFIED_CANADIAN_ABORIGINAL_SYLLABIC","OGHAM","RUNIC","KUMER","MONGOLIAN","LATIN_EXTENDED_ADDITIONAL","GREEK_EXTENDED","GENERAL_PUNCTUATION","SUPERSCRIPTS_AND_SUBSCRIPTS","CURRENCY_SYMBOLS","COMBINING_MARKS_FOR_SYMBOLS","LETTERLIKE_SYMBOLS","NUMBER_FORMS","ARROWS","MATHEMATICAL_OPERATORS","MISCELLANEOUS_TECHNICAL","CONTROL_PICTURES","OPTICAL_CHARACTER_RECOGNITION","ENCLOSED_ALPHANUMERICS","BOX_DRAWING","BLOCK_ELEMENTS","GEOMETRIC_SHAPES","MISCELLANEOUS_SYMBOLS","DINGBATS","BRAILLE_PATTERNS","CJK_RADICALS_SUPPLEMENT","KANGXI_RADICALS","IDEOGRAPHIC_DESCRIPTION_CHARACTERS","CJK_SYMBOLS_AND_PUNCTUATION","HIRAGANA","KATAKANA","BOPOMOFO","HANGUL_COMPATIBILITY_JAMO","KANBUN","BOPOMOFO_EXTENDED","ENCLOSED_CJK_LETTERS_AND_MONTHS","CJK_COMPATIBILITY","CJK_UNIFIED_IDEOGRAPHS_EXTENSION","CJK_UNIFIED_IDEOGRAPHS","YI_SYLLABLES","YI_RADICALS","HANGUL_SYLLABLES","CJK_COMPATIBILITY_IDEOGRAPHS","ALPHABETIC_PRESENTATION_FORMS","ARABIC_PRESENTATION_FORMS_A","COMBINING_HALF_MARKS","CJK_COMPATIBILITY_FORMS","SMALL_FORM_VARIANTS","ARABIC_PRESENTATION_FORMS_B","HALFWIDTH_AND_FULLWIDTH_FORMS","SPECIALS"];this._fullhalfblocks=["\uff01","\uff10","\uff1a","\uff21","\uff3b","\uff41","\uff5b","\uff61","\uff65","\uffa0","\uffe0","\uffe8"];this._halfkana=["\u30fb","\u30f2","\u30a1","\u30a3","\u30a5","\u30a7","\u30a9","\u30e3","\u30e5","\u30e7","\u30c3","\u30fc","\u30a2","\u30a4","\u30a6","\u30a8","\u30aa","\u30ab","\u30ad","\u30af","\u30b1","\u30b3","\u30b5","\u30b7","\u30b9","\u30bb","\u30bd","\u30bf","\u30c1","\u30c4","\u30c6","\u30c8","\u30ca","\u30cb","\u30cc","\u30cd","\u30ce","\u30cf","\u30d2","\u30d5","\u30d8","\u30db","\u30de","\u30df","\u30e0","\u30e1","\u30e2","\u30e4","\u30e6","\u30e8","\u30e9","\u30ea","\u30eb","\u30ec","\u30ed","\u30ef","\u30f3","\u3099","\u309a"];this._fullkana=["\uff67","\uff71","\uff68","\uff72","\uff69","\uff73","\uff6a","\uff74","\uff6b","\uff75","\uff76","\uff76","\uff77","\uff77","\uff78","\uff78","\uff79","\uff79","\uff7a","\uff7a","\uff7b","\uff7b","\uff7c","\uff7c","\uff7d","\uff7d","\uff7e","\uff7e","\uff7f","\uff7f","\uff80","\uff80","\uff81","\uff81","\uff6f","\uff82","\uff82","\uff83","\uff83","\uff84","\uff84","\uff85","\uff86","\uff87","\uff88","\uff89","\uff8a","\uff8a","\uff8a","\uff8b","\uff8b","\uff8b","\uff8c","\uff8c","\uff8c","\uff8d","\uff8d","\uff8d","\uff8e","\uff8e","\uff8e","\uff8f","\uff90","\uff91","\uff92","\uff93","\uff6c","\uff94","\uff6d","\uff95","\uff6e","\uff96","\uff97","\uff98","\uff99","\uff9a","\uff9b","\uff9c","\uff9c","\uff68","\uff6a","\uff66","\uff9d","\uff73","\uff76","\uff79","\uff9c","\uff68","\uff6a","\uff66","\uff65","\uff70"];this._fullkanaSmall=["\uff67","\uff68","\uff69","\uff6a","\uff6b","\uff6c","\uff6d","\uff6e","\uff6f"];this._accentkana=[0,0,0,0,0,0,0,0,0,0,-1,1,-1,1,-1,1,-1,1,-1,1,-1,1,-1,1,-1,1,-1,1,-1,1,-1,1,-1,1,0,-1,1,-1,1,-1,1,0,0,0,0,0,-3,1,2,-3,1,2,-3,1,2,-3,1,2,-3,1,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,1,1,1,1,0,0];this._feQuotes=["\u2018","\u2019","\u201c","\u201d"];this._jpnMixed=["\u30fc"];this._jpnSpecialFull=["\u3000","\u3001","\u3002","\u300c","\u300d","\u201c","\u201d","\u2018","\u2019","\u309b","\u309c","\uffe5"];this._jpnSpecialHalf=["\u0020","\uff64","\uff61","\uff62","\uff63","\u0022","\u0022","\u0027","\u0027","\uff9e","\uff9f","\u00a5"];var _charType=new CharType();this._mwtable=[_charType.Symbol|_charType.FullWidth,_charType.Numeric|_charType.FullWidth,_charType.Symbol|_charType.FullWidth,_charType.UpperCase|_charType.FullWidth,_charType.Symbol|_charType.FullWidth,_charType.LowerCase|_charType.FullWidth,_charType.Symbol|_charType.FullWidth,_charType.FarEastPunctation,_charType.Katakana,_charType.Hangul,_charType.Symbol|_charType.FullWidth,_charType.Symbol]}return CharCategory})();input.CharCategory=CharCategory;var CharProcess=(function(){function CharProcess(){this.CharCategory=new CharCategory();this.Ctype=new CharType()}CharProcess.LowerKana="\u3041\u3043\u3045\u3047\u3049\u3063\u3083\u3085\u3087\u308e\u30a1\u30a3\u30a5\u30a7\u30a9\u30c3\u30e3\u30e5\u30e7\u30ee\uff67\uff68\uff69\uff6a\uff6b\uff6c\uff6d\uff6e\uff6f\u30F5\u30F6\u3095\u3096";CharProcess.UpperKana="\u3042\u3044\u3046\u3048\u304a\u3064\u3084\u3086\u3088\u308f\u30a2\u30a4\u30a6\u30a8\u30aa\u30c4\u30e4\u30e6\u30e8\u30ef\uff71\uff72\uff73\uff74\uff75\uff94\uff95\uff96\uff82\u30AB\u30B1\u304B\u3051";CharProcess.FullWidthSymbolArray=["\u3001","\u3002","\uFF0C","\uFF0E","\u30FB","\uFF1A","\uFF1B","\uFF1F","\uFF01","\u309B","\u309C","\u00B4","\uFF40","\u00A8","\uFF3E","\uFFE3","\uFF3F","\u30FD","\u30FE","\u309D","\u309E","\u3003","\u4EDD","\u3005","\u3006","\u3007","\u30FC","\u2014","\u2010","\uFF0F","\u301C","\u2016","\uFF5C","\u2026","\u2025","\u2018","\u2019","\u201C","\u201D","\uFF08","\uFF09","\u3014","\u3015","\uFF3B","\uFF3D","\uFF5B","\uFF5D","\u3008","\u3009","\u300A","\u300B","\u300C","\u300D","\u300E","\u300F","\u3010","\u3011","\uFF0B","\u2212","\u00B1","\u00D7","\u00F7","\uFF1D","\u2260","\uFF1C","\uFF1E","\u2266","\u2267","\u221E","\u2234","\u2642","\u2640","\u00B0","\u2032","\u2033","\u2103","\uFFE5","\uFF04","\u00A2","\u00A3","\uFF05","\uFF03","\uFF06","\uFF0A","\uFF20","\u00A7","\u2606","\u2605","\u25CB","\u25CF","\u25CE","\u25C7","\u25C6","\u25A1","\u25A0","\u25B3","\u25B2","\u25BD","\u25BC","\u203B","\u3012","\u2192","\u2190","\u2191","\u2193","\u3013","\uFF07","\uFF02","\uFF0D","\u3033","\u3034","\u3035","\u303B","\u303C","\u30FF","\u309F","\u2208","\u220B","\u2286","\u2287","\u2282","\u2283","\u222A","\u2229","\u2284","\u2285","\u228A","\u228B","\u2209","\u2205","\u2305","\u2306","\u2227","\u2228","\u00AC","\u21D2","\u21D4","\u2200","\u2203","\u2295","\u2296","\u2297","\u2225","\u2226","\u2985","\u2986","\u3018","\u3019","\u3016","\u3017","\u2220","\u22A5","\u2312","\u2202","\u2207","\u2261","\u2252","\u226A","\u226B","\u221A","\u223D","\u221D","\u2235","\u222B","\u222C","\u2262","\u2243","\u2245","\u2248","\u2276","\u2277","\u2194","\u212B","\u2030","\u266F","\u266D","\u266A","\u2020","\u2021","\u00B6","\u266E","\u266B","\u266C","\u2669","\u25EF","\uFF3C","\uFF5E","\uFFE0","\uFFE1","\uFFE2","\u2015"];CharProcess.HalfWidthSymbolArray=["\u005C","\u007E","\u0021","\u0022","\u0023","\u0024","\u0025","\u0026","\u0027","\u0028","\u0029","\u002A","\u002B","\u002C","\u002D","\u002E","\u002F","\u003A","\u003B","\u003C","\u003D","\u003E","\u003F","\u0040","\u005B","\u005D","\u005E","\u005F","\u0060","\u007B","\u007C","\u007D","\uFF61","\uFF62","\uFF63","\uFF64","\uFF65","\u00A1","\u00A4","\u00A5"];CharProcess.CharEx=new CharProcess();CharProcess.prototype.ToHalfKatakana=function(c){var result="";if(this.IsFullWidth(c)){if(this.IsKatakana(c)){var katakana=c;var n=katakana.charCodeAt(0)-(this.CharCategory._charstarts[62].charCodeAt(0)+1);if(n<0||n>91){return katakana}katakana=this.CharCategory._fullkana[n];var accent=this.CharCategory._accentkana[n];if(accent>0){katakana=katakana+String.fromCharCode(accent==1?this.CharCategory.KATAKANA_VOICED.charCodeAt(0):this.CharCategory.KATAKANA_SEMIVOICED.charCodeAt(0))}result=katakana}else{if(this.IsHiragana(c)){var katakana=String.fromCharCode(c.charCodeAt(0)-this.CharCategory._charstarts[61].charCodeAt(0)+this.CharCategory._charstarts[62].charCodeAt(0));var n=katakana.charCodeAt(0)-(this.CharCategory._charstarts[62].charCodeAt(0)+1);if(n<0||n>91){return katakana}katakana=this.CharCategory._fullkana[n];var accent=this.CharCategory._accentkana[n];if(accent>0){katakana=katakana+String.fromCharCode(accent==1?this.CharCategory.KATAKANA_VOICED.charCodeAt(0):this.CharCategory.KATAKANA_SEMIVOICED.charCodeAt(0))}result=katakana}}}else{if(this.IsKatakana(c)){result=c}}return result};CharProcess.prototype.GetCharType=function(c){var ctype=this.Ctype.OtherChar;var block=this.BelongTo(c);if(c=="\u007f"||("\u0000"<=c&&c<="\u001f")||("\u0080"<=c&&c<="\u009f")){return this.Ctype.Control}if("A"<=c&&c<="Z"){return this.Ctype.UpperCase}if("a"<=c&&c<="z"){return this.Ctype.LowerCase}if("0"<=c&&c<="9"){return this.Ctype.Numeric}if(this.IsFullWidthSymbol(c)||this.IsHalfWidthSymbol(c)){ctype=this.Ctype.Symbol}if(c.charCodeAt(0)==8216||c.charCodeAt(0)==8217||c.charCodeAt(0)==8220||c.charCodeAt(0)==8221){ctype=this.Ctype.Punctuation}if(c.charCodeAt(0)==12288){ctype=this.Ctype.Space}switch(this.CharCategory.Blocks[block]){case"HALFWIDTH_AND_FULLWIDTH_FORMS":return this.MultiWidthDetails(c);case"KATAKANA":return this.Ctype.Katakana|this.Ctype.FullWidth;case"HIRAGANA":return this.Ctype.Hiragana|this.Ctype.FullWidth}if(this.IsFarEastBlock(block,c)){ctype|=this.Ctype.FullWidth}return ctype};CharProcess.prototype.IsCharOfType=function(c,type){return this.GetCharType(c)==type};CharProcess.prototype.IsMultiWidth=function(c){var block=this.BelongTo(c);var category=this.CharCategory.Blocks[block];return(category=="KATAKANA"||category=="CJK_SYMBOLS_AND_PUNCTUATION"||category=="HALFWIDTH_AND_FULLWIDTH_FORMS"||(category=="BASIC_LATIN"&&c>="\u0020"))};CharProcess.prototype.IsFullWidthSymbol=function(c){for(var i=0;i<CharProcess.FullWidthSymbolArray.length;i++){if(c===CharProcess.FullWidthSymbolArray[i]){return true}}return false};CharProcess.prototype.IsHalfWidthSymbol=function(c){for(var i=0;i<CharProcess.HalfWidthSymbolArray.length;i++){if(c===CharProcess.HalfWidthSymbolArray[i]){return true}}return false};CharProcess.prototype.IsFullWidth=function(c){if(this.IsFullWidthSymbol(c)){return true}if(this.IsHalfWidthSymbol(c)){return false}var block=this.BelongTo(c);var bFullWidth=this.IsFarEastBlock(block,c);if(this.CharCategory.Blocks[block]=="HALFWIDTH_AND_FULLWIDTH_FORMS"){bFullWidth=((this.MultiWidthDetails(c)&this.Ctype.FullWidth)==this.Ctype.FullWidth)}return bFullWidth};CharProcess.prototype.IsSurrogatePair=function(c){if(c.charCodeAt(0)>="\uD800".charCodeAt(0)&&c.charCodeAt(0)<="\uDBFF".charCodeAt(0)&&c.charCodeAt(1)>="\uDC00".charCodeAt(0)&&c.charCodeAt(1)<="\uDFFF".charCodeAt(0)){return true}return false};CharProcess.prototype.IsSurrogate=function(c){return c!=null&&((c.charCodeAt(0)>="\uD800".charCodeAt(0))&&c.charCodeAt(0)<="\uDFFF".charCodeAt(0))};CharProcess.prototype.IsOther=function(c){return((this.GetCharType(c)&~this.Ctype.FullWidth)==this.Ctype.OtherChar)};CharProcess.prototype.IsControl=function(c){return((this.GetCharType(c)&~this.Ctype.FullWidth)==this.Ctype.Control)};CharProcess.prototype.IsKatakana=function(c){return((this.GetCharType(c)&~this.Ctype.FullWidth)==this.Ctype.Katakana)};CharProcess.prototype.IsSmallHalfKatakana=function(c){var _halfkanaSmall=new Array("\u30a1","\u30a3","\u30a5","\u30a7","\u30a9","\u30e3","\u30e5","\u30e7","\u30c3","\u30ee");var c1=c;if(c.charCodeAt(0)>this.CharCategory.KANAHALFSTART){c1=this.CharCategory._halfkana[c.charCodeAt(0)-this.CharCategory.KANAHALFSTART]}for(var i=0;i<_halfkanaSmall.length;i++){if(c1==_halfkanaSmall[i]){return true}}return false};CharProcess.prototype.IsHiragana=function(c){return(((this.GetCharType(c)&~this.Ctype.FullWidth)==this.Ctype.Hiragana)||(this.CharCategory._jpnMixed[0]==c))};CharProcess.prototype.IsShiftJIS=function(c){return false};CharProcess.prototype.IsJISX0208=function(c){return false};CharProcess.prototype.IsDigit=function(c){return((this.GetCharType(c)&~this.Ctype.FullWidth)==this.Ctype.Numeric)};CharProcess.prototype.IsPunctuation=function(c){return((this.GetCharType(c)&~this.Ctype.FullWidth)==this.Ctype.Punctuation)};CharProcess.prototype.IsMathSymbol=function(c){return((this.GetCharType(c)&~this.Ctype.FullWidth)==this.Ctype.MathSymbol)};CharProcess.prototype.IsSymbol=function(c){return((this.GetCharType(c)&~this.Ctype.FullWidth)==this.Ctype.Symbol)};CharProcess.prototype.IsLower=function(c){return((this.GetCharType(c)&~this.Ctype.FullWidth)==this.Ctype.LowerCase)};CharProcess.prototype.IsUpper=function(c){return((this.GetCharType(c)&~this.Ctype.FullWidth)==this.Ctype.UpperCase)};CharProcess.prototype.IsDigitOrSymbol=function(c){return(this.IsDigit(c)||this.IsMathSymbol(c))};CharProcess.prototype.IsAlphabet=function(c){return(this.IsUpper(c)||this.IsLower(c))};CharProcess.prototype.IsAlphaOrDigit=function(c){return(this.IsUpper(c)||this.IsLower(c)||this.IsDigit(c))};CharProcess.prototype.IsUpperKana=function(c){return !this.IsLowerKana(c)};CharProcess.prototype.IsLowerKana=function(c){return(CharProcess.LowerKana.search(c)!=-1)};CharProcess.prototype.HasLowerKana=function(c){return(CharProcess.UpperKana.search(c)!=-1||this.IsLowerKana(c))};CharProcess.prototype.ToUpperKana=function(c){var index=CharProcess.LowerKana.search(c);return(index==-1)?c:CharProcess.UpperKana.substr(index,1)};CharProcess.prototype.ToLowerKana=function(c){var index=CharProcess.UpperKana.search(c);if(index>=CharProcess.UpperKana.length-4&&index<CharProcess.UpperKana.length){return c}return(index==-1)?c:CharProcess.LowerKana.substr(index,1)};CharProcess.prototype.ToLower=function(c){if(this.IsUpper(c)){return String.fromCharCode(c.charCodeAt(0)+32)}return c};CharProcess.prototype.ToUpper=function(c){if(this.IsLower(c)){return String.fromCharCode(c.charCodeAt(0)-32)}return c};CharProcess.prototype.IsSpace=function(c){return c=="\u0020"||c==="\u3000"};CharProcess.prototype.ToFullWidth=function(c){var retObj={text:"",processedAll:false};retObj.text=c;retObj.processedAll=false;if(c.length==0){return retObj}var c1=c.Substring(0,1);if(this.IsMultiWidth(c1)){if(c1<this.CharCategory._charstarts[1]){if(c1=="\u0020"){retObj.text="\u3000";return retObj}var temp="\u0021";retObj.text=String.fromCharCode(c1.charCodeAt(0)-temp.charCodeAt(0)+(this.CharCategory._charstarts[81].charCodeAt(0)+1));return retObj}if((this.MultiWidthDetails(c1)&this.Ctype.Katakana)==this.Ctype.Katakana){if(c1.charCodeAt(0)<this.CharCategory.KANAHALFSTART){var c2=this.GetFullHalfWidthSpecialChar(c1,true);retObj.text=(c2!=="")?c2:c1;return retObj}c1=this.CharCategory._halfkana[c1.charCodeAt(0)-this.CharCategory.KANAHALFSTART];if(c.length<2){retObj.text=c1;return retObj}var daku=c.charCodeAt(1)-(this.CharCategory.KATAKANA_VOICED.charCodeAt(0)-1);if(daku==1||daku==2){retObj.processedAll=true;var accent=this.CharCategory._accentkana[(c1.charCodeAt(0)-(this.CharCategory._charstarts[62].charCodeAt(0)+1))];if(accent!=0){if((Math.abs(accent)&2)==daku){c1=String.fromCharCode(c1.charCodeAt(0)+1)}c1=String.fromCharCode(c1.charCodeAt(0)+1)}}if(daku==1&&c1=="\u30A6"){c1="\u30F4"}}}retObj.text=c1;return retObj};CharProcess.prototype.ToHalfWidth=function(c){return this.ToHalfWidthEx(c)};CharProcess.prototype.ToHalfWidthEx=function(c){var ctype=this.GetCharType(c);var multiWidth=this.IsMultiWidth(c);if((ctype&this.Ctype.FullWidth)==this.Ctype.FullWidth){switch(ctype&~this.Ctype.FullWidth){case this.Ctype.Punctuation:case this.Ctype.UpperCase:case this.Ctype.LowerCase:case this.Ctype.Symbol:case this.Ctype.Numeric:case this.Ctype.MathSymbol:var c1=this.GetFullHalfWidthSpecialChar(c,false);if(c1!==""){c=c1}else{if(multiWidth){var temp="\u0021";c=String.fromCharCode(c.charCodeAt(0)-(this.CharCategory._charstarts[81].charCodeAt(0)+1)+temp.charCodeAt(0))}}break;case this.Ctype.Katakana:var n=c.charCodeAt(0)-(this.CharCategory._charstarts[62].charCodeAt(0)+1);if(n<0||n>91){return c}c=this.CharCategory._fullkana[n];var accent=this.CharCategory._accentkana[n];if(accent>0){c=c+String.fromCharCode(accent==1?this.CharCategory.KATAKANA_VOICED.charCodeAt(0):this.CharCategory.KATAKANA_SEMIVOICED.charCodeAt(0));return c}break;case this.Ctype.Space:c="\u0020";break;case this.Ctype.Hangul:break}}return c};CharProcess.prototype.ToKatakana=function(c){if(!this.IsCharOfType(c,this.Ctype.Hiragana|this.Ctype.FullWidth)){return c}var c1=this.GetFullHalfWidthSpecialChar(c,false);if(c1!==""){return c1}return String.fromCharCode(c.charCodeAt(0)-this.CharCategory._charstarts[61].charCodeAt(0)+this.CharCategory._charstarts[62].charCodeAt(0))};CharProcess.prototype.ToHiragana=function(c){if(!this.IsKatakana(c)){return c}if(!this.IsFullWidth(c)){c=this.ToFullWidth(c).text}if(!this.IsCharOfType(c,this.Ctype.Katakana|this.Ctype.FullWidth)){return c}if(c>="\u30f7"&&c<="\u30ff"){return c}if(c=="\u30f5"){return"\u304b"}if(c=="\u30f6"){return"\u3051"}return String.fromCharCode(c.charCodeAt(0)+this.CharCategory._charstarts[61].charCodeAt(0)-this.CharCategory._charstarts[62].charCodeAt(0))};CharProcess.prototype.ToBigHalfKatakana=function(c){if(!this.IsSmallHalfKatakana(c)){return c}var c1=this.CharCategory._halfkana[c.charCodeAt(0)-this.CharCategory.KANAHALFSTART];c1=String.fromCharCode(c1.charCodeAt(0)+1);return c1};CharProcess.prototype.BelongTo=function(c){var bottom=0;var top=83;var current=top>>1;while(top-bottom>1){if(c>=this.CharCategory._charstarts[current]){bottom=current}else{top=current}current=(top+bottom)>>1}return current};CharProcess.prototype.MultiWidthDetails=function(c){var bottom=0;var top=this.CharCategory._fullhalfblocks.length;var current=top>>1;while(top-bottom>1){if(c>=this.CharCategory._fullhalfblocks[current]){bottom=current}else{top=current}current=(top+bottom)>>1}return this.CharCategory._mwtable[current]};CharProcess.prototype.IsFarEastBlock=function(block,c){switch(this.CharCategory.Blocks[block]){case"CJK_COMPATIBILITY":case"CJK_COMPATIBILITY_FORMS":case"CJK_COMPATIBILITY_IDEOGRAPHS":case"CJK_RADICALS_SUPPLEMENT":case"CJK_SYMBOLS_AND_PUNCTUATION":case"CJK_UNIFIED_IDEOGRAPHS":case"CJK_UNIFIED_IDEOGRAPHS_EXTENSION":case"HALFWIDTH_AND_FULLWIDTH_FORMS":case"BOPOMOFO":case"BOPOMOFO_EXTENDED":case"HIRAGANA":case"KATAKANA":case"KANBUN":case"HANGUL_COMPATIBILITY_JAMO":case"HANGUL_JAMO":case"HANGUL_SYLLABLES":return true;default:for(var i=0;i<this.CharCategory._feQuotes.length;i++){if(c==this.CharCategory._feQuotes[i]){return true}}if(c.charCodeAt(0)>255){return true}if(c.charCodeAt(0)==8216||c.charCodeAt(0)==8217||c.charCodeAt(0)==8220||c.charCodeAt(0)==8221){return true}break}return false};CharProcess.prototype.GetFullHalfWidthSpecialChar=function(c,toFull){if(toFull==true){var srctable=this.CharCategory._jpnSpecialHalf;var desttable=this.CharCategory._jpnSpecialFull}else{var srctable=this.CharCategory._jpnSpecialFull;var desttable=this.CharCategory._jpnSpecialHalf}var found=-1;var tempIndex=0;while(tempIndex<srctable.length){if(srctable[tempIndex]==c){found=tempIndex;break}tempIndex++}if(found!=-1){if(tempIndex<desttable.length){return desttable[tempIndex]}}return""};return CharProcess})();input.CharProcess=CharProcess;(function(FocusType){FocusType._map=[];FocusType.None=0;FocusType.Click=1;FocusType.ContextMenu=2;FocusType.ClientEvent=3;FocusType.KeyExit=4;FocusType.Default=5;FocusType.SpinButton=6;FocusType.DropDown=7;FocusType.ImeInput=8;FocusType.Left=9;FocusType.Right=10;FocusType.DragDrop=11})(input.FocusType||(input.FocusType={}));var FocusType=input.FocusType;(function(DateCursorPosition){DateCursorPosition._map=[];DateCursorPosition.Default=0;DateCursorPosition.Era=1;DateCursorPosition.Year=2;DateCursorPosition.Month=3;DateCursorPosition.Day=4;DateCursorPosition.AMPM=5;DateCursorPosition.Hour=6;DateCursorPosition.Minute=7;DateCursorPosition.Second=8})(input.DateCursorPosition||(input.DateCursorPosition={}));var DateCursorPosition=input.DateCursorPosition;(function(CrLfMode){CrLfMode._map=[];CrLfMode.NoControl=0;CrLfMode.Filter=1;CrLfMode.Cut=2})(input.CrLfMode||(input.CrLfMode={}));var CrLfMode=input.CrLfMode;(function(ClipContent){ClipContent._map=[];ClipContent.IncludeLiterals=0;ClipContent.ExcludeLiterals=1})(input.ClipContent||(input.ClipContent={}));var ClipContent=input.ClipContent;(function(EditMode){EditMode._map=[];EditMode.Insert=0;EditMode.Overwrite=1;EditMode.FixedInsert=2;EditMode.FixedOverwrite=3})(input.EditMode||(input.EditMode={}));var EditMode=input.EditMode;(function(ShowLiterals){ShowLiterals._map=[];ShowLiterals.Always=1;ShowLiterals.PostDisplay=2;ShowLiterals.PreDisplay=3})(input.ShowLiterals||(input.ShowLiterals={}));var ShowLiterals=input.ShowLiterals;(function(ExitOnLeftRightKey){ExitOnLeftRightKey._map=[];ExitOnLeftRightKey.None=0;ExitOnLeftRightKey.Left=1;ExitOnLeftRightKey.Right=2;ExitOnLeftRightKey.Both=3})(input.ExitOnLeftRightKey||(input.ExitOnLeftRightKey={}));var ExitOnLeftRightKey=input.ExitOnLeftRightKey;(function(HighlightText){HighlightText._map=[];HighlightText.None=0;HighlightText.Field=1;HighlightText.All=2})(input.HighlightText||(input.HighlightText={}));var HighlightText=input.HighlightText;(function(MouseButton){MouseButton._map=[];MouseButton.Default=-1;MouseButton.Left=0;MouseButton.Middle=1;MouseButton.Right=2})(input.MouseButton||(input.MouseButton={}));var MouseButton=input.MouseButton;(function(DropDownAlign){DropDownAlign._map=[];DropDownAlign.Left=1;DropDownAlign.Right=2})(input.DropDownAlign||(input.DropDownAlign={}));var DropDownAlign=input.DropDownAlign;(function(ScrollBarMode){ScrollBarMode._map=[];ScrollBarMode._map[0]="Automatic";ScrollBarMode.Automatic=0;ScrollBarMode._map[1]="Fixed";ScrollBarMode.Fixed=1})(input.ScrollBarMode||(input.ScrollBarMode={}));var ScrollBarMode=input.ScrollBarMode;(function(ScrollBars){ScrollBars._map=[];ScrollBars._map[0]="None";ScrollBars.None=0;ScrollBars._map[1]="Horizontal";ScrollBars.Horizontal=1;ScrollBars._map[2]="Vertical";ScrollBars.Vertical=2;ScrollBars._map[3]="Both";ScrollBars.Both=3})(input.ScrollBars||(input.ScrollBars={}));var ScrollBars=input.ScrollBars;(function(ControlStatus){ControlStatus._map=[];ControlStatus.Normal=0;ControlStatus.Hover=1;ControlStatus.Pressed=2;ControlStatus.Focused=4;ControlStatus.Disabled=8})(input.ControlStatus||(input.ControlStatus={}));var ControlStatus=input.ControlStatus;(function(ExitKeys){ExitKeys._map=[];ExitKeys.Tab=1;ExitKeys.ShiftTab=2;ExitKeys.NextControl=3;ExitKeys.PreviousControl=4;ExitKeys.Right=5;ExitKeys.Left=6;ExitKeys.CtrlRight=7;ExitKeys.CtrlLeft=8;ExitKeys.CharInput=9})(input.ExitKeys||(input.ExitKeys={}));var ExitKeys=input.ExitKeys;(function(TabAction){TabAction._map=[];TabAction.Control=0;TabAction.Field=1})(input.TabAction||(input.TabAction={}));var TabAction=input.TabAction;(function(Key){Key._map=[];Key.BackSpace=8;Key.Tab=9;Key.Clear=12;Key.Enter=13;Key.Shift=16;Key.Control=17;Key.Alt=18;Key.Pause=19;Key.Caps_Lock=20;Key.Escape=27;Key.Space=32;Key.PageUp=33;Key.PageDown=34;Key.End=35;Key.Home=36;Key.Left=37;Key.Up=38;Key.Right=39;Key.Down=40;Key.Select=41;Key.Print=42;Key.Execute=43;Key.Insert=45;Key.Delete=46;Key.Help=47;Key.equalbraceright=48;Key.exclamonesuperior=49;Key.quotedbltwosuperior=50;Key.sectionthreesuperior=51;Key.dollar=52;Key.percent=53;Key.ampersand=54;Key.slashbraceleft=55;Key.parenleftbracketleft=56;Key.parenrightbracketright=57;Key.A=65;Key.B=66;Key.C=67;Key.D=68;Key.E=69;Key.F=70;Key.G=71;Key.H=72;Key.I=73;Key.J=74;Key.K=75;Key.L=76;Key.M=77;Key.N=78;Key.O=79;Key.P=80;Key.Q=81;Key.R=82;Key.S=83;Key.T=84;Key.U=85;Key.V=86;Key.W=87;Key.X=88;Key.Y=89;Key.Z=90;Key.KP_0=96;Key.KP_1=97;Key.KP_2=98;Key.KP_3=99;Key.KP_4=100;Key.KP_5=101;Key.KP_6=102;Key.KP_7=103;Key.KP_8=104;Key.KP_9=105;Key.KP_Multiply=106;Key.KP_Add=107;Key.KP_Separator=108;Key.KP_Subtract=109;Key.KP_Decimal=110;Key.KP_Divide=111;Key.F1=112;Key.F2=113;Key.F3=114;Key.F4=115;Key.F5=116;Key.F6=117;Key.F7=118;Key.F8=119;Key.F9=120;Key.F10=121;Key.F11=122;Key.F12=123;Key.F13=124;Key.F14=125;Key.F15=126;Key.F16=127;Key.F17=128;Key.F18=129;Key.F19=130;Key.F20=131;Key.F21=132;Key.F22=133;Key.F23=134;Key.F24=135;Key.Num_Lock=136;Key.Scroll_Lock=137})(input.Key||(input.Key={}));var Key=input.Key;var BaseUIProcess=(function(){function BaseUIProcess(){this.isMulSelected=false;this.isDblClick=false;this.isTriClick=false;this.isOverWrite=false;this.moveFocusExitOnLastChar=false}BaseUIProcess.prototype.GetInputElement=function(){return this.Owner.GetInputElement()};BaseUIProcess.prototype.GetElementId=function(){return this.Owner.GetInputElement().id};BaseUIProcess.prototype.GetShowLiterals=function(){if(this.Owner.GetShowLiterals!==undefined){return this.Owner.GetShowLiterals()}return ShowLiterals.Always};BaseUIProcess.prototype.SetCursorPositionAndSelection=function(highlightText,text,cursorPos,startPos){var retInfo={};if(highlightText==true||highlightText==HighlightText.All){retInfo.SelectionStart=0;retInfo.SelectionEnd=text.GetLength()}return retInfo};BaseUIProcess.prototype.Clear=function(){return null};BaseUIProcess.prototype.Focus=function(data){var text=data.Text;var displayText=data.DisplayText;var focusType=data.FocusType;var oText=data.Element;var highlightText=data.HighlightText;var cursorPos=data.CursorPosition;var retInfo={};this.isMulSelected=false;if(focusType==FocusType.Click){retInfo.SelectionStart=Utility.GetCursorPosition(oText);retInfo.SelectionEnd=retInfo.SelectionStart}retInfo.Text=text;if(retInfo.SelectionStart==-1){retInfo.SelectionStart=0;retInfo.SelectionEnd=0}else{if(retInfo.SelectionStart>retInfo.Text.GetLength()){retInfo.SelectionStart=retInfo.Text.GetLength();retInfo.SelectionEnd=retInfo.Text.GetLength()}else{if(retInfo.SelectionStart==displayText.GetLength()){retInfo.SelectionStart=retInfo.Text.GetLength();retInfo.SelectionEnd=retInfo.Text.GetLength()}}}if(focusType==FocusType.Left&&cursorPos==DateCursorPosition.Default){retInfo.SelectionStart=0;retInfo.SelectionEnd=0}else{if(focusType==FocusType.Right&&cursorPos==DateCursorPosition.Default){retInfo.SelectionStart=retInfo.Text.GetLength();retInfo.SelectionEnd=retInfo.Text.GetLength()}}if(highlightText==HighlightText.None&&cursorPos==DateCursorPosition.Default){return retInfo}if(focusType==FocusType.ContextMenu){return retInfo}var startPos=retInfo.SelectionStart==null?data.SelectionStart:retInfo.SelectionStart;var ret=this.SetCursorPositionAndSelection(highlightText,retInfo.Text,cursorPos,startPos);if(ret!=null){retInfo.SelectionStart=ret.SelectionStart;retInfo.SelectionEnd=ret.SelectionEnd;retInfo.IsSelectionDeterminedByHighlightText=true}return retInfo};BaseUIProcess.prototype.LoseFocus=function(data){};BaseUIProcess.prototype.MouseDown=function(mouseButton){var retInfo={};this.isTriClick=false;if(this.isDblClick&&!Utility.GrapeCityTimeout&&mouseButton==MouseButton.Left){this.isTriClick=true;retInfo=this.SelectAll()}this.isDblClick=false;return retInfo};BaseUIProcess.prototype.MouseUp=function(obj,start,end,mouseButton,ctrlPressed){var retInfo={};if(this.isTriClick){Utility.SetSelection(obj,start,end);return null}if(ctrlPressed){retInfo=this.SelectAll();Utility.SetSelection(obj,retInfo.SelectionStart,retInfo.SelectionEnd);return retInfo}retInfo.SelectionStart=start;retInfo.SelectionEnd=end;if(mouseButton==MouseButton.Left){retInfo.SelectionStart=Utility.GetSelectionStartPosition(obj);retInfo.SelectionEnd=Utility.GetSelectionEndPosition(obj)}if(retInfo.SelectionStart!=retInfo.SelectionEnd){this.isMulSelected=true}else{this.isMulSelected=false}return retInfo};BaseUIProcess.prototype.ProcessShortcutKey=function(keyAction,readOnly,end,start){var retInfo={};switch(keyAction){case"Clear":if(readOnly){retInfo.System=false;return retInfo}return this.Clear();case"NextControl":var ret=this.MoveControl(this.GetInputElement(),true,false,"NextControl");if(ret!=null){retInfo.EventInfo=ret.EventInfo;retInfo.FocusType=ret.FocusType;retInfo.FocusExit=true}retInfo.System=false;return retInfo;case"PreviousControl":var ret=this.MoveControl(this.GetInputElement(),false,false,"PreviousControl");if(ret!=null){retInfo.EventInfo=ret.EventInfo;retInfo.FocusType=ret.FocusType;retInfo.FocusExit=true}retInfo.System=false;return retInfo;case"NextField":retInfo=this.MoveField(end,true);return retInfo;case"PreviousField":retInfo=this.MoveField(end,false);return retInfo;case"NextField/NextControl":var retInfo=this.MoveFieldAndControl(end,true);return retInfo;case"PreviousField/PreviousControl":var retInfo=this.MoveFieldAndControl(end,false);return retInfo}};BaseUIProcess.prototype.ProcessCharKeyInput=function(k,start,end,isExitOnLastChar,text){return null};BaseUIProcess.prototype.ProcessNavigatorKeyInput=function(k,editMode,clipContent,text,start,end,exitOnLeftRightKey,isExitOnLastChar){var retInfo={};switch(k){case 45:if(editMode==EditMode.FixedInsert){this.isOverWrite=false}else{if(editMode==EditMode.FixedOverwrite){this.isOverWrite=true}else{this.isOverWrite=!this.isOverWrite}}retInfo.Overwrite=this.isOverWrite;retInfo.System=false;if(this.Format.Fields.fieldCount==0){retInfo.System=true}return retInfo;case 8:retInfo=this.ProcessBackSpace(start,end,text);retInfo.System=false;break;case 46:retInfo=this.ProcessDelete(start,end,text);retInfo.System=false;break;case 196643:case 196644:case 196645:case 196647:case 65569:case 196641:case 65570:case 196642:if(k==65569||k==196641){k=196644}else{if(k==65570||k==196642){k=196643}}retInfo.SelectionEnd=this.GetCaretPosition(end,k);this.isMulSelected=true;retInfo.System=false;break;case 65582:case 65544:if(this.isMulSelected){if(this.Owner._isSupportClipBoard()){retInfo=this.Cut(clipContent,start,end)}else{retInfo.System=true;break}}else{retInfo=this.ProcessBackSpace(start,end)}retInfo.System=false;break;case 65581:case 131158:if(this.Owner._isSupportClipBoard()){var pasteData=Utility.GetPasteData(this.Owner?this.Owner.GetUseClipboard():true);retInfo=this.Paste(start,end,pasteData,isExitOnLastChar);retInfo.System=false}else{retInfo.System=true}break;case 65571:case 65572:case 65573:case 65575:case 65574:case 65576:this.isMulSelected=true;retInfo.SelectionEnd=this.GetCaretPosition(end,k);retInfo.System=false;break;case 131139:case 131117:if(this.Owner._isSupportClipBoard()){this.Copy(clipContent,start,end);retInfo.System=false}else{retInfo.System=true}break;case 131118:if(!this.isMulSelected){end=this.GetCaretPosition(end,k)}retInfo=this.ProcessDelete(start,end);retInfo.System=false;break;case 131080:case 196616:if(!this.isMulSelected){end=this.GetCaretPosition(end,k)}retInfo=this.ProcessBackSpace(start,end);retInfo.System=false;break;case 131137:retInfo=this.SelectAll();retInfo.System=false;break;case 131160:if(this.Owner._isSupportClipBoard()){retInfo=this.Cut(clipContent,start,end);retInfo.System=false}else{retInfo.System=true}break;case 131162:retInfo=this.Undo();retInfo.System=false;break;case 131109:case 37:if(start==0&&(exitOnLeftRightKey==ExitOnLeftRightKey.Both||exitOnLeftRightKey==ExitOnLeftRightKey.Left)){var exitType=k==37?"Left":"CtrlLeft";var ret=this.MoveControl(this.GetInputElement(),false,true,exitType);if(ret!=null){retInfo.EventInfo=ret.EventInfo;retInfo.FocusType=ret.FocusType;retInfo.FocusExit=true}return retInfo}case 131108:case 131110:case 36:case 33:case 131105:if(k==33||k==131105){k=131108}retInfo=this.ProcessLeftDirection(start,end,k);retInfo.System=false;break;case 131111:case 39:if(start==text.GetLength()&&(exitOnLeftRightKey==ExitOnLeftRightKey.Both||exitOnLeftRightKey==ExitOnLeftRightKey.Right)){var exitType=k==39?"Right":"CtrlRight";var ret=this.MoveControl(this.GetInputElement(),true,true,exitType);if(ret!=null){retInfo.EventInfo=ret.EventInfo;retInfo.FocusType=ret.FocusType;retInfo.FocusExit=true}return retInfo}case 131107:case 131112:case 35:case 34:case 131106:if(k==34||k==131106){k=131107}retInfo=this.ProcessRightDirection(start,end,k);retInfo.System=false;break;default:retInfo=null;break}return retInfo};BaseUIProcess.prototype.ProcessLeftDirection=function(start,end,k){};BaseUIProcess.prototype.ProcessRightDirection=function(start,end,k){};BaseUIProcess.prototype.KeyDown=function(data){var k=data.KeyCode;var start=data.SelectionStart;var end=data.SelectionEnd;var text=data.Text;var editMode=data.EditMode;var keyAction=data.KeyAction;var readOnly=data.ReadOnly;var clipContent=data.ClipContent;var isExitOnLastChar=data.ExitOnLastChar;var exitOnLeftRightKey=data.ExitOnLeftRightKey;var tabAction=data.TabAction;var retInfo={};switch(editMode){case EditMode.Insert:this.isOverWrite=false;break;case EditMode.Overwrite:this.isOverWrite=true;break;case EditMode.FixedInsert:this.isOverWrite=false;break;case EditMode.FixedOverwrite:this.isOverWrite=true;break}if(start!=end){this.isMulSelected=true}else{this.isMulSelected=false}switch(k){case 9:retInfo=this.ProcessTabKey(end,true,tabAction);return retInfo;case 65545:retInfo=this.ProcessTabKey(end,false,tabAction);return retInfo}if(keyAction!=null){return this.ProcessShortcutKey(keyAction,readOnly,end,start)}if(readOnly){if(k==27||k==262182||k==262184||k==38||k==40){return null}if(k!=131117&&k!=131139&&k!=9&&k!=65545&&k!=131081&&k!=196617&&k!=131137&&k!=37&&k!=39&&k!=38&&k!=40){return retInfo}}if(this.Format.Fields.fieldCount==0){switch(k){case 45:if(editMode==EditMode.FixedInsert){this.isOverWrite=false}else{if(editMode==EditMode.FixedOverwrite){this.isOverWrite=true}else{this.isOverWrite=!this.isOverWrite}}retInfo.Overwrite=this.isOverWrite;if(this.Format.Fields.fieldCount==0){retInfo.System=true}return retInfo;case 37:case 131109:if(start==0&&(exitOnLeftRightKey==ExitOnLeftRightKey.Both||exitOnLeftRightKey==ExitOnLeftRightKey.Left)){var exitType=k==37?"Left":"CtrlLeft";var ret=this.MoveControl(this.GetInputElement(),false,true,exitType);if(ret!=null){retInfo.EventInfo=ret.EventInfo;retInfo.FocusType=ret.FocusType;retInfo.FocusExit=true}return retInfo}break;case 39:case 131111:if(start==text.GetLength()&&(exitOnLeftRightKey==ExitOnLeftRightKey.Both||exitOnLeftRightKey==ExitOnLeftRightKey.Right)){var exitType=k==39?"Right":"CtrlRight";var ret=this.MoveControl(this.GetInputElement(),true,true,exitType);if(ret!=null){retInfo.EventInfo=ret.EventInfo;retInfo.FocusType=ret.FocusType;retInfo.FocusExit=true}return retInfo}break}return null}var processInfo=this.ProcessCharKeyInput(k,start,end,isExitOnLastChar,text);if(processInfo!=null){return processInfo}retInfo=this.ProcessNavigatorKeyInput(k,editMode,clipContent,text,start,end,exitOnLeftRightKey,isExitOnLastChar);return retInfo};BaseUIProcess.prototype.KeyPress=function(e){};BaseUIProcess.prototype.KeyUp=function(e){};BaseUIProcess.prototype.ShowContextMenu=function(oText,selText){var retInfo={};if(selText==""){retInfo.SelectionStart=Utility.GetCursorPosition(oText);retInfo.SelectionEnd=retInfo.SelectionStart}return retInfo};BaseUIProcess.prototype.SelectStart=function(obj,selText,mouseButton){var retInfo={};if(selText==""&&!this.isTriClick&&!this.isDblClick&&mouseButton!=MouseButton.Default){retInfo.SelectionStart=Utility.GetCursorPosition(obj);retInfo.SetFalse=true}return retInfo};BaseUIProcess.prototype.DoubleClick=function(pos){var retInfo={};var fieldIndex=this.Format.Fields.GetFieldIndexByPos(pos);var fieldPos=this.Format.Fields.GetFieldRange(fieldIndex.index);retInfo.SelectionStart=fieldPos.start;retInfo.SelectionEnd=fieldPos.length+fieldPos.start;Utility.GrapeCityTimeout=false;this.isDblClick=true;this.isMulSelect=true;setTimeout(function(){Utility.GrapeCityTimeout=true},300);return retInfo};BaseUIProcess.prototype.Undo=function(){};BaseUIProcess.prototype.Cut=function(clipContent,start,end){var retInfo={};if(start==end){return retInfo}this.FireClientEvent("OnBeforeCut");this.Copy(clipContent,start,end);retInfo=this.ProcessDelete(start,end);this.FireClientEvent("OnCut");return retInfo};BaseUIProcess.prototype.Copy=function(clipContent,start,end){var text=null;var useClipboard=true;if(clipContent==ClipContent.ExcludeLiterals){var length=Math.abs(start-end);var start=Math.min(start,end);if(length==0){return}text=this.Format.Fields.GetNonLiteralsText(start,length)}else{if(!Utility.IsIE()||Utility.IsIE11OrLater()){text=Utility.GetSelectionText(this.Owner.GetInputElement())}else{text=document.selection.createRange().text}}if(this.Owner){text=BaseUIProcess.UpdateCrLfString(text,this.Owner.GetAcceptsCrlf());useClipboard=this.Owner.GetUseClipboard()}if(Utility.IsIE()){setTimeout(function(){Utility.SetCopy(text,useClipboard)})}else{Utility.SetCopy(text,useClipboard)}};BaseUIProcess.prototype.Paste=function(start,end,text,exitonlastChar){};BaseUIProcess.prototype.SelectAll=function(){var retInfo={SelectionStart:0,SelectionEnd:0};retInfo.SelectionStart=0;var ShowLiterals;if(this.ID){ShowLiterals=this.GetShowLiterals()}if(ShowLiterals=="PostDisplay"||ShowLiterals=="PreDisplay"){retInfo.SelectionEnd=Utility.FindIMControl(this.ID).GetText().GetLength()}else{retInfo.SelectionEnd=this.Format.Fields.GetLength()}this.isMulSelected=true;return retInfo};BaseUIProcess.prototype.FireEvent=function(oControl,eName,eArgs,eType){if(Utility.FireEvent(oControl,eName,eArgs,eType)){return FocusType.ClientEvent}};BaseUIProcess.prototype.ProcessCharKey=function(start,end,charInput,isExitOnLastChar){var processInfo={};var selectionStart=Math.min(start,end);var selectionLength=Math.abs(end-start);var retInfo={};processInfo.start=selectionStart;processInfo.success=false;if(this.Format.Fields.GetFieldIndex(selectionStart).index==-1){var eventInfo={};eventInfo.Name=this.Owner.InvalidInputEvent;eventInfo.Args=null;eventInfo.Type="invalidInput";processInfo.EventInfo=eventInfo;return processInfo}var text=charInput.toString();if(selectionLength==0&&!this.isOverWrite){retInfo=this.Format.Fields.Insert(selectionStart,text,false)}else{if(selectionLength==0){if(selectionStart==this.Format.Fields.GetLength()){retInfo=this.Format.Fields.Insert(selectionStart,text,false)}else{var isReplace=false;var posInfo=this.Format.Fields.GetFieldIndexByPos(selectionStart);var fieldIndex=posInfo.index;var fieldOffset=posInfo.offset;var fieldRange=this.Format.Fields.GetFieldRange(fieldIndex);if(this.Format.Fields.GetFieldByIndex(fieldIndex).fieldLabel=="PromptField"){if(selectionStart-fieldOffset+fieldRange.length==this.Format.Fields.GetLength()){isReplace=false}else{isReplace=true;selectionLength=fieldRange.length-fieldOffset+1}}else{isReplace=true;selectionLength=charInput.GetLength()}if(this.Format.Fields.GetFieldIndexByPos(selectionStart+selectionLength).index==-1){var eventInfo={};eventInfo.Name=this.Owner.InvalidInputEvent;eventInfo.Args=null;eventInfo.Type="invalidInput";processInfo.EventInfo=eventInfo;return processInfo}if(isReplace){retInfo=this.Format.Fields.Replace(selectionStart,selectionLength,text,false)}else{retInfo=this.Format.Fields.Insert(selectionStart,text,false)}}}else{retInfo=this.Format.Fields.Replace(selectionStart,selectionLength,text,false)}}selectionStart=retInfo.cursorPos;if(retInfo.text!=""){var eventInfo={};eventInfo.Name=this.Owner.InvalidInputEvent;eventInfo.Args=null;eventInfo.Type="invalidInput";processInfo.EventInfo=eventInfo;processInfo.start=selectionStart;processInfo.success=false;return processInfo}if(isExitOnLastChar==true){if(selectionStart==this.Format.Fields.GetLength()){this.moveFocusExitOnLastChar=true}else{var posInfo=this.Format.Fields.GetFieldIndexByPos(selectionStart);var fieldIndex=posInfo.index;var fieldOffset=posInfo.offset;if(fieldIndex==this.Format.Fields.fieldCount-1&&fieldOffset==0&&this.Format.Fields.GetFieldByIndex(fieldIndex).fieldLabel=="PromptField"){this.moveFocusExitOnLastChar=true}}}processInfo.start=selectionStart;processInfo.success=true;return processInfo};BaseUIProcess.prototype.ProcessDeleteKey=function(start,end){var selectionStart=Math.min(start,end);var selectionLength=Math.abs(start-end);var retInfo={};if(selectionStart==this.Format.Fields.GetLength()&&selectionLength==0){return retInfo}var startFieldIndex;var fieldPosInfo=this.Format.Fields.GetFieldIndexByPos(selectionStart);startFieldIndex=fieldPosInfo.index;if(startFieldIndex==-1){return retInfo}if(selectionLength==0){if(this.Format.Fields.GetFieldByIndex(startFieldIndex).fieldLabel=="PromptField"){return retInfo}selectionStart=this.Format.Fields.Delete(selectionStart,1).cursorPos;retInfo.SelectionStart=selectionStart;retInfo.SelectionEnd=retInfo.SelectionStart}else{var endFieldOffset;var endFieldIndex;fieldPosInfo=this.Format.Fields.GetFieldIndexByPos(selectionStart+selectionLength);endFieldOffset=fieldPosInfo.offset;endFieldIndex=fieldPosInfo.index;if(endFieldIndex==-1){return retInfo}if(endFieldOffset==0){endFieldIndex--}if(startFieldIndex==endFieldIndex&&this.Format.Fields.GetFieldByIndex(startFieldIndex).fieldLabel=="PromptField"){return retInfo}var info=this.Format.Fields.Delete(selectionStart,selectionLength);if(!info.isSucceed){return retInfo}retInfo.SelectionStart=info.cursorPos;if(retInfo.SelectionStart==0&&this.Format.Fields.GetFieldByIndex(0).fieldLabel=="PromptField"){retInfo.SelectionStart=this.Format.Fields.GetFieldByIndex(0).GetLength()}retInfo.SelectionEnd=retInfo.SelectionStart;var currentFieldOffset;var currentFieldIndex;var currentFieldInfo=this.Format.Fields.GetFieldIndexByPos(retInfo.SelectionStart);currentFieldIndex=currentFieldInfo.index;currentFieldOffset=currentFieldInfo.offset;if(currentFieldOffset!=0&&this.Format.Fields.GetFieldByIndex(currentFieldIndex).fieldLabel=="PromptField"){retInfo.SelectionStart=retInfo.SelectionStart-currentFieldOffset+this.Format.Fields.GetFieldByIndex(currentFieldIndex).GetLength();retInfo.SelectionEnd=retInfo.SelectionStart}}return retInfo};BaseUIProcess.prototype.ProcessBackSpace=function(start,end,text){};BaseUIProcess.prototype.ProcessDelete=function(start,end,text){};BaseUIProcess.prototype.GetCaretPosition=function(cursorPos,keyCode,startPos,endPos,literalFieldLabel){var fields=this.Format.Fields;var fieldPosInfo=fields.GetFieldIndexByPos(cursorPos);var fieldIndex=fieldPosInfo.index;var fieldOffset=fieldPosInfo.offset;var fieldRange;var startPos;var endPos;var i=0;switch(keyCode){case 36:case 65572:case 65574:if(cursorPos<=startPos){return 0}else{return startPos}case 35:case 65571:case 65576:if(cursorPos>=endPos){return fields.GetLength()}else{return endPos}case 37:if(cursorPos==0){return 0}if(fields.GetFieldByIndex(fieldIndex).fieldLabel==literalFieldLabel){if(fieldOffset>0){cursorPos-=fieldOffset}else{cursorPos--}}else{if(fieldOffset==0&&fields.GetFieldByIndex(fieldIndex-1).fieldLabel==literalFieldLabel){cursorPos-=fields.GetFieldRange(fieldIndex-1).length}else{cursorPos--}}break;case 39:if(cursorPos==fields.GetLength()){return cursorPos}if(fields.GetFieldByIndex(fieldIndex).fieldLabel==literalFieldLabel){fieldRange=fields.GetFieldRange(fieldIndex);startPos=fieldRange.start;endPos=startPos+fieldRange.length;if(cursorPos<endPos){return endPos}}else{cursorPos++}break;case 131109:if(cursorPos==0||fieldIndex==0){return 0}if(fields.GetFieldByIndex(fieldIndex).fieldLabel==literalFieldLabel){fieldRange=fields.GetFieldRange(fieldIndex-1);cursorPos=fieldRange.start}else{if(fieldOffset==0){for(i=fieldIndex-1;i>=0;i--){if(fields.GetFieldByIndex(i).fieldLabel!=literalFieldLabel){fieldRange=fields.GetFieldRange(i);return fieldRange.start}}return 0}else{cursorPos-=fieldOffset}}break;case 196645:if(cursorPos==0||fieldIndex==0){return 0}if(fieldOffset==0){fieldRange=fields.GetFieldRange(fieldIndex-1);cursorPos=fieldRange.start}else{cursorPos-=fieldOffset}break;case 131111:if(cursorPos==fields.GetLength()||fieldIndex==fields.fieldCount-1){return fields.GetLength()}if(fields.GetFieldByIndex(fieldIndex).fieldLabel==literalFieldLabel){fieldRange=fields.GetFieldRange(fieldIndex+1);cursorPos=fieldRange.start}else{for(i=fieldIndex+1;i<fields.fieldCount;i++){if(fields.GetFieldByIndex(i).fieldLabel!=literalFieldLabel){fieldRange=fields.GetFieldRange(i);return fieldRange.start}}return fields.GetLength()}break;case 196647:if(cursorPos==fields.GetLength()||fieldIndex==fields.fieldCount-1){return fields.GetLength()}fieldRange=fields.GetFieldRange(fieldIndex+1);cursorPos=fieldRange.start;break;case 131118:if(cursorPos==fields.GetLength()||fields.GetFieldByIndex(fieldIndex).fieldLabel==literalFieldLabel){return cursorPos}else{fieldRange=fields.GetFieldRange(fieldIndex);return fieldRange.start+fieldRange.length}case 131080:case 196616:if(cursorPos==0||(fields.GetFieldByIndex(fieldIndex).fieldLabel==literalFieldLabel&&fieldIndex==0)){return cursorPos}else{if(fields.GetFieldByIndex(fieldIndex).fieldLabel==literalFieldLabel){return fields.GetFieldRange(fieldIndex-1).start}else{if(fieldOffset==0){for(i=fieldIndex-1;i>=0;i--){if(fields.GetFieldByIndex(i).fieldLabel!=literalFieldLabel){fieldRange=fields.GetFieldRange(i);return fieldRange.start}}return cursorPos}else{cursorPos-=fieldOffset}}}break;case 196643:case 131107:case 131112:return fields.GetLength();case 196644:case 131108:case 131110:return 0;case 65573:if(cursorPos==0){return 0}else{return --cursorPos}case 65575:if(cursorPos==fields.GetLength()){return cursorPos}else{return ++cursorPos}}return cursorPos};BaseUIProcess.prototype.CompareShortcut=function(keyCode,shortcut){if(shortcut.toString().IndexOf("|")==-1){if(shortcut==keyCode){return true}else{return false}}else{var index=null;while(index!=-1){index=shortcut.toString().IndexOf("|");var length=shortcut.toString().GetLength();if(shortcut.Substring(0,index==-1?length:index)==keyCode){return true}else{shortcut=shortcut.Substring(index+1,length)}}return false}};BaseUIProcess.prototype.MoveControl=function(currentElement,isForward,isUseLeftRightKey,exitType){var elements=Utility.GetElements();var ret=null;var retInfo={};if(elements.length<2){return null}var nextElement=Utility.GetNextFocusableControl(currentElement,elements,isForward);if(exitType=="CharInput"||(!Utility.IsIE())){Utility.NextID=nextElement;setTimeout(function(){Utility.SetElementFocus(nextElement)},0)}else{Utility.SetElementFocus(nextElement)}if(isUseLeftRightKey){var obj=document.getElementById(nextElement);if(obj!=null&&(obj.tagName.toLowerCase()=="textarea"||obj.type=="text")){if(Utility.IsIE()){var range=obj.createTextRange();if(exitType=="Left"||exitType=="CtrlLeft"){range.moveStart("character",obj.value.length);range.select()}}}}var eArgs={Key:ExitKeys.CharInput};switch(exitType){case"NextControl":eArgs.Key=ExitKeys.NextControl;break;case"PreviousControl":eArgs.Key=ExitKeys.PreviousControl;break;case"Right":eArgs.Key=ExitKeys.Right;break;case"Left":eArgs.Key=ExitKeys.Left;break;case"CtrlRight":eArgs.Key=ExitKeys.CtrlRight;break;case"CtrlLeft":eArgs.Key=ExitKeys.CtrlLeft;break;case"CharInput":eArgs.Key=ExitKeys.CharInput;break}ret={};ret.Name=this.Owner.KeyExitEvent;ret.Args=eArgs;ret.Type="KeyExit";if(ret!=null){retInfo.EventInfo=ret}return retInfo};BaseUIProcess.prototype.MoveField=function(pos,isForward){var nextPos=this.Format.Fields.MoveField(pos,isForward);var retInfo={};if(nextPos==-1){retInfo.NextPos=nextPos;return retInfo}retInfo.SelectionStart=nextPos;retInfo.SelectionEnd=nextPos;return retInfo};BaseUIProcess.prototype.ProcessTabKey=function(pos,isForward,tabAction){var eArgs={Key:ExitKeys.Tab};var retInfo={};if(isForward){eArgs.Key=ExitKeys.Tab}else{eArgs.Key=ExitKeys.ShiftTab}var eventInfo={};eventInfo.Name=this.Owner.KeyExitEvent;eventInfo.Args=eArgs;eventInfo.Type="KeyExit";retInfo.EventInfo=eventInfo;retInfo.FocusType=FocusType.KeyExit;retInfo.System=true;return retInfo};BaseUIProcess.prototype.MoveFieldAndControl=function(pos,isForward){var retInfo=this.MoveField(pos,isForward);if(retInfo.NextPos!=-1){return retInfo}var exitType=isForward?"NextControl":"PreviousControl";var ret=this.MoveControl(this.GetInputElement(),isForward,false,exitType);if(ret!=null){retInfo.EventInfo=ret.EventInfo;retInfo.FocusType=ret.FocusType;retInfo.FocusExit=true}return retInfo};BaseUIProcess.prototype.DragStart=function(){};BaseUIProcess.prototype.DragEnd=function(){};BaseUIProcess.prototype.Drop=function(){};BaseUIProcess.prototype.DragOver=function(){};BaseUIProcess.prototype.GetKeyActionName=function(keyCode,strShortcut){if(strShortcut==null){return null}var s=strShortcut;var shortcuts=new Array();var index=s.IndexOf(",");var i=0;if(strShortcut!=""){while(index!=-1){shortcuts[i++]=s.Substring(0,index);s=s.Substring(index+1,s.GetLength());index=s.IndexOf(",")}shortcuts[i++]=s;for(var j=0;j<i;j=j+2){if(this.IsKeyCodeContained(keyCode,shortcuts[j+1])){return shortcuts[j]}}}return null};BaseUIProcess.prototype.IsKeyCodeContained=function(keyCode,shortcut){var s=shortcut;var index=s.IndexOf("|");while(index!=-1){if(s.Substring(0,index)==keyCode){return true}s=s.Substring(index+1,s.GetLength());index=s.IndexOf("|")}if(s==keyCode){return true}return false};BaseUIProcess.prototype.FireClientEvent=function(evenType){};BaseUIProcess.prototype.PerformSpin=function(curpos,increment,wrap){};BaseUIProcess.UpdateCrLfString=function UpdateCrLfString(text,crlfMode){var ret=text;if(text){if(crlfMode==CrLfMode.Filter){ret=text.replace(new RegExp("[\r\n]","g"),"")}else{if(crlfMode==CrLfMode.Cut){var splits=text.split(new RegExp("[\r\n]","g"));if(splits.length>0){ret=splits[0]}else{ret=""}}}}return ret};BaseUIProcess.FilterReturnChar=function FilterReturnChar(text){if(text!=null){text=text.replace(new RegExp("[\r]","g"),"")}return text};return BaseUIProcess})();input.BaseUIProcess=BaseUIProcess;var InputUIUpdate=(function(){function InputUIUpdate(owner){this.Owner=owner}InputUIUpdate.prototype.SetLastClientValues=function(text){};InputUIUpdate.prototype.GetText=function(){if(this.Owner.GetInputElement()!=null){return this.Owner.GetInputElement().value}};InputUIUpdate.prototype.SetText=function(text){if(this.GetText()==null){return}if(this.GetText().replace(/\r\n/g,"\n")==text.replace(/\r\n/g,"\n")){return}if(this.Owner.GetInputElement()!=null){this.Owner.GetInputElement().value=text}};InputUIUpdate.prototype.SetFocus=function(){try{if(this.Owner.GetInputElement()!=null){this.Owner.GetInputElement().focus()}}catch(e){}};InputUIUpdate.prototype.GetTextHAlign=function(){if(this.Owner.GetInputElement()!==null){return this.Owner.GetInputElement().style.textAlign}return""};InputUIUpdate.prototype.SetTextHAlign=function(value){if(this.Owner.GetInputElement()!==null){this.Owner.GetInputElement().style.textAlign=value;if(Utility.IsIE()){var old=this.Owner.GetInputElement().style.width;var length=parseInt(old);if(isNaN(length)){length=120}this.Owner.GetInputElement().style.width=length+1+"px";var self=this;setTimeout(function(){self.InputElement.style.width=old},0)}}};InputUIUpdate.prototype.SetForeColor=function(foreColor){if(this.Owner.GetInputElement()!=null){this.Owner.GetInputElement().style.color=foreColor}};InputUIUpdate.prototype.WriteCssStyle=function(style){try{var styleContainer=document.getElementById("gcsh_InputManWeb_Style_Container");if(Utility.IsIE()){styleContainer.styleSheet.cssText=style}else{var sheet=styleContainer.sheet;for(var i=sheet.cssRules.length-1;i>=0;i--){sheet.deleteRule(i)}var ruleLines=style.split("}");for(var j=0;j<ruleLines.length;j++){var rule=ruleLines[j];var index=rule.indexOf("{");if(index==-1){continue}var style=rule.substring(index+1);if(style.length!=0){var selector=rule.substring(0,index);sheet.insertRule(selector+"{"+style+"}",sheet.cssRules.length)}}}}catch(e){}};InputUIUpdate.prototype.ClearCssStyle=function(){};return InputUIUpdate})();input.InputUIUpdate=InputUIUpdate;var GlobalEventHandler=(function(){function GlobalEventHandler(){}GlobalEventHandler.OnKeyDown=function OnKeyDown(control,evt,forShortcutExtender){if(control.ImeMode===true&&!Utility.IsIE8OrBelow()){return}var k=evt.keyCode;if(forShortcutExtender){k|=524288}var funcKeysPressed={};funcKeysPressed.Shift=false;funcKeysPressed.Ctrl=false;funcKeysPressed.Alt=false;if(evt.shiftKey){funcKeysPressed.Shift=true}if(evt.ctrlKey){funcKeysPressed.Ctrl=true}if(evt.altKey){funcKeysPressed.Alt=true}var useSystem=null;Utility.FuncKeysPressed=funcKeysPressed;try{useSystem=control.KeyDown(evt)}catch(e){}if(useSystem!=null&&useSystem.KeyCode!=null){if(Utility.IsIE()){evt.keyCode=useSystem.KeyCode}if(!Utility.IsIE()){Utility.ShouldInvokeKeyPress=false}return}if(!useSystem){Utility.PreventDefault(evt);if(!Utility.IsIE()){Utility.ShouldInvokeKeyPress=false}}else{if(!Utility.IsIE()){Utility.ShouldInvokeKeyPress=true}else{if(evt!=null){evt.returnValue=true}}}};GlobalEventHandler.OnKeyPress=function OnKeyPress(control,evt){if((evt.charCode===118||evt.charCode===120||evt.charCode===99)&&evt.ctrlKey){return}if(Utility.IPad&&evt.charCode>256){return}if(evt.keyCode==46&&evt.shiftKey){return}if(control.ImeMode===true){return}var obj=control;if(!Utility.IsIE()&&(evt.charCode==0||!Utility.ShouldInvokeKeyPress)){if(!Utility.ShouldInvokeKeyPress||((evt.keyCode==38||evt.keyCode==40)&&obj.Type!="Edit")){Utility.ShouldInvokeKeyPress=true;Utility.PreventDefault(evt);if(obj!=null&&obj.Type=="Edit"&&obj.DropDownObj!=null&&obj.DropDownObj.IsKeyFromDropDown){obj.DropDownObj.IsKeyFromDropDown=false}return}else{if(!(evt.keyCode==13&&obj.Type=="Edit")){return}}}var keyCode=evt.keyCode||evt.charCode;if(keyCode!=13||obj.Type=="Edit"){var str=String.fromCharCode(keyCode);try{if(CharProcess.CharEx.IsSurrogate(str.charAt(0))){obj.IsSurrogateKeyPressing=true;return}}catch(e){}if(str!=null){var useSystem=null;try{useSystem=control.KeyPress(str,evt)}catch(e){}}if(!useSystem){Utility.PreventDefault(evt);return}}};GlobalEventHandler.OnKeyUp=function OnKeyUp(control,evt){if(control.ImeMode===true&&!Utility.IsIE8OrBelow()){return}try{var imControl=control;if(imControl.IsSurrogateKeyPressing){try{if(imControl.InputElement!=null){var value=imControl.InputElement.value;var selectionStart=imControl.InputElement.selectionStart;var str=value.substr(selectionStart-2,selectionStart);imControl.KeyPress(str,evt)}}finally{imControl.IsSurrogateKeyPressing=false}}Utility.FuncKeysPressed={Shift:evt.shiftKey,Ctrl:evt.ctrlKey,Alt:evt.altKey};imControl.KeyUp(evt)}catch(e){}};GlobalEventHandler.OnCompositionStart=function OnCompositionStart(control,evt){try{control.CompositionStart(evt)}catch(e){}};GlobalEventHandler.OnCompositionUpdate=function OnCompositionUpdate(control,evt){try{control.CompositionUpdate(evt)}catch(e){}};GlobalEventHandler.OnCompositionEnd=function OnCompositionEnd(control,evt){try{control.CompositionEnd(evt)}catch(e){}};GlobalEventHandler.OnWebkitEditableContentChanged=function OnWebkitEditableContentChanged(control,evt){try{control.WebkitEditableContentChanged(evt)}catch(e){}};GlobalEventHandler.OnMouseOver=function OnMouseOver(control,evt){try{if(control.MouseOver){control.MouseOver()}}catch(e){}};GlobalEventHandler.OnMouseOut=function OnMouseOut(control,evt){try{control.MouseOut()}catch(e){}};GlobalEventHandler.OnMouseMove=function OnMouseMove(control,evt){try{if(control.MouseMove){control.MouseMove(evt)}}catch(e){}};GlobalEventHandler.OnMouseDown=function OnMouseDown(control,evt){if(control.ImeMode&&control.ImeMode===true&&!Utility.IsIE8OrBelow()){return}try{control.MouseDown(evt);if(!Utility.IsIE()){Utility.DragStartElementID=control}}catch(e){}};GlobalEventHandler.OnMouseUp=function OnMouseUp(imControl,evt){if(imControl.ImeMode&&imControl.ImeMode===true&&!Utility.IsIE8OrBelow()){return}try{if(imControl.MouseUpPointerType!=null&&imControl.MouseUpPointerType!==4&&imControl.MouseUpPointerType!=="mouse"){var evtClone={};for(var item in evt){evtClone[item]=evt[item]}setTimeout(function(parameters){imControl.MouseUp(evtClone)},300)}else{imControl.MouseUp(evt)}if(!Utility.IsIE()){Utility.DragStartElementID=""}}catch(e){}};GlobalEventHandler.OnSelectStart=function OnSelectStart(control,evt){if(Utility.InnerSelect===true&&Utility.ShouldFireOnSelectStart==false){Utility.CancelBubble(evt)}var selText=Utility.GetSelectionText(control.GetInputElement());if(typeof(selText)=="undefined"||selText==null){selText=""}var useSystem=null;try{useSystem=control.SelectStart(selText)}catch(e){}if(useSystem==false){Utility.PreventDefault(evt)}};GlobalEventHandler.OnDblClick=function OnDblClick(control,evt){var useSystem=null;try{useSystem=control.DoubleClick()}catch(e){}if(!useSystem){Utility.PreventDefault(evt)}};GlobalEventHandler.OnHTML5BeforeCopy=function OnHTML5BeforeCopy(control,evt){try{Utility.CutCopyPasteEventObject=evt?evt.originalEvent:evt;control.Copy(evt)}catch(e){}finally{Utility.CutCopyPasteEventObject=null}};GlobalEventHandler.OnHTML5Cut=function OnHTML5Cut(control,evt){try{var input=control.GetInputElement();var text=input.value;var selStart=input.selectionStart;var selEnd=input.selectionEnd;setTimeout(function(){input.value=text;input.selectionStart=selStart;input.selectionEnd=selEnd;control.Cut(evt)},0)}catch(e){}};GlobalEventHandler.OnHTML5Paste=function OnHTML5Paste(control,evt){try{if(Utility.chrome&&Utility.GetClientOS().toLowerCase()!=="android"){Utility.CutCopyPasteEventObject=evt?evt.originalEvent:evt;control.Paste(Utility.GetDataFromClipboard(true));Utility.PreventDefault(evt)}else{var selStart=control.SelectionStart;var selEnd=control.SelectionEnd;setTimeout(function(){if(Utility.GetClientOS().toLowerCase()==="android"){control.SelectionStart=selStart;control.SelectionEnd=selEnd}control.isPasting=true;control.ImeInput("DirectInput")},0)}}catch(e){}finally{Utility.CutCopyPasteEventObject=null}};GlobalEventHandler.OnMouseWheel=function OnMouseWheel(control,evt){try{control.MouseWheel(evt);if(control.ShouldCancelMouseWheelDefaultBehavior()){Utility.PreventDefault(evt)}}catch(e){}};GlobalEventHandler.OnDragStart=function OnDragStart(control,evt){try{control.DragStart()}catch(e){}};GlobalEventHandler.OnDragEnd=function OnDragEnd(control,evt){try{control.DragEnd(evt)}catch(e){}};GlobalEventHandler.OnDrop=function OnDrop(control,evt){try{var text=evt.originalEvent.dataTransfer.getData("Text");control.DragDrop(text,evt)}catch(e){}};GlobalEventHandler.OnTouchStart=function OnTouchStart(control,evt){Utility.TouchStartTime=new Date();Utility.TouchStartEvt=evt};GlobalEventHandler.OnTouchEnd=function OnTouchEnd(control,evt){if(Utility.TouchStartTime!==undefined){Utility.TouchEndTime=new Date();var offset=Utility.TouchEndTime.valueOf()-Utility.TouchStartTime.valueOf();if(offset>1000){var text="";try{text=Utility.GetSelectionText(control.GetInputElement())}catch(e){}control.ShowContextMenu(text,Utility.TouchStartEvt);if(control.GetEnabled()){Utility.PreventDefault(evt)}}Utility.TouchStartTime=undefined;Utility.TouchEndTime=undefined}};GlobalEventHandler.OnDragEnter=function OnDragEnter(control,evt){try{control.DragEnter()}catch(e){}};GlobalEventHandler.OnDragLeave=function OnDragLeave(control,evt){try{control.DragLeave()}catch(e){}};GlobalEventHandler.OnSelect=function OnSelect(control,evt){try{if(control&&control.Focused){control.Select()}}catch(e){}};GlobalEventHandler.OnPropertyChanged=function OnPropertyChanged(control,evt){try{control.PropertyChange(evt)}catch(e){}};GlobalEventHandler.OnMSPointerUp=function OnMSPointerUp(control,evt){control.MSPointerUp(evt)};GlobalEventHandler.OnMSPointerDown=function OnMSPointerDown(control,evt){try{control.MSPointerDown(evt)}catch(e){}};GlobalEventHandler.OnMSGestureTap=function OnMSGestureTap(control,evt){try{control.MSGestureTap(evt)}catch(e){}};GlobalEventHandler.OnEditFieldFocus=function OnEditFieldFocus(control,evt){if(Utility.IsFocusFromIMControl(control._id,evt)){if(Utility.IsIE()||Utility.HasGetFocus){return}}Utility.IsOnFocus=true;if(!Utility.IsIE()){Utility.HasGetFocus=true}this.OnFocus(control,evt)};GlobalEventHandler.OnEditFieldLoseFocus=function OnEditFieldLoseFocus(control,evt){try{var obj=control;if(obj!=null&&obj.Type=="Edit"&&obj.IsFocusToDropDownEdit){obj.IsFocusToDropDownEdit=false;return}if(Utility.IsFocusToIMControl(control._id,evt)){return}if(Utility.firefox){if(Utility.IsOnFocus&&Utility.IsIE()&&Utility.IsOnActivate&&Utility.IsOnActivateControlID==control._id){if(Utility.FocusToBorder!=null&&Utility.FocusToBorder==true){Utility.FocusToBorder=false;obj.SetInnerFocus()}return}Utility.FocusToBorder=false;if(!Utility.IsIE()){Utility.HasGetFocus=false}else{Utility.IsOnFocus=false}}GlobalEventHandler.OnLostFocus(control,evt);Utility.FuncKeysPressed={Shift:false,Ctrl:false,Alt:false}}catch(e){}};GlobalEventHandler.OnFocusOut=function OnFocusOut(control,evt){Utility.FocusToBorder=false;if(Utility.IsIE()){if(evt.toElement){var toID=evt.toElement.id;if(toID==control._id+"_Inside_Div_Container"){Utility.FocusToBorder=true}}}if(Utility.IsFocusToIMControl(control._id,evt)){if(Utility.IsIE()&&Utility.engine>=9){Utility.IsOnActivate=true;Utility.IsOnActivateControlID=control._id;Utility.IsOnFocus=true}return}if(Utility.IsIE()&&Utility.IsOnActivate){Utility.IsOnActivate=false;Utility.IsOnActivateControlID=""}if(Utility.IsOnFocus){Utility.IsOnFocus=false}};GlobalEventHandler.OnActivate=function OnActivate(control,evt){Utility.IsOnActivate=true;Utility.IsOnActivateControlID=control._id;if(Utility.IsFocusFromIMControl(control._id,evt)){return}Utility.IsOnActivate=true;Utility.IsOnActivateControlID=control._id};GlobalEventHandler.OnDeActivate=function OnDeActivate(control,evt){if(Utility.IsFocusToIMControl(control._id,evt)){return}Utility.IsOnActivate=false;Utility.IsOnActivateControlID="";Utility.IsOnFocus=false};GlobalEventHandler.OnFocus=function OnFocus(control,evt){try{var handler=function(){control.Focus();control.Focused=true;if(Utility.IsPad()){control.IPadSelectionRefreshTimer=setInterval(function(){control.Select()},400)}};if(Utility.IsIE()){handler.call(this)}else{setTimeout(handler,0)}}catch(e){}};GlobalEventHandler.OnLostFocus=function OnLostFocus(control,evt){try{control.LoseFocus(evt);control.Focused=false;if(Utility.IsPad()){clearInterval(control.IPadSelectionRefreshTimer)}}catch(e){}};return GlobalEventHandler})();input.GlobalEventHandler=GlobalEventHandler;String.prototype.GetLength=function(){return this.length};String.prototype.Substring=function(start,end){return this.substring(start,end)};String.prototype.IndexOf=function(text,startIndex){return this.indexOf(text,startIndex)};String.prototype.LastIndexOf=function(text){return this.lastIndexOf(text)};String.prototype.CharAt=function(position){return this.charAt(position)}})(wijmo.input||(wijmo.input={}));var input=wijmo.input})(wijmo||(wijmo={}));