(function(a){a.widget("wijmo.wijgrid",{options:{allowColMoving:false,allowColSizing:false,allowEditing:false,allowKeyboardNavigation:false,allowPaging:false,allowSorting:false,alwaysParseData:true,cellStyleFormatter:undefined,columns:[],columnsAutogenerationMode:"merge",culture:"",customFilterOperators:[],data:null,ensureColumnsPxWidth:false,filterOperatorsSortMode:"alphabeticalCustomFirst",groupAreaCaption:"Drag a column here to group by that column.",groupIndent:10,highlightCurrentCell:false,loadingText:"Loading...",nullString:undefined,pageIndex:0,pageSize:10,pagerSettings:{mode:"numeric",pageButtonCount:10,position:"bottom"},readAttributesFromData:false,rowStyleFormatter:undefined,scrollMode:"none",selectionMode:"singleRow",showFilter:false,showFooter:false,showGroupArea:false,showRowHeader:false,staticColumnIndex:-1,staticRowIndex:-1,afterCellEdit:null,afterCellUpdate:null,beforeCellEdit:null,beforeCellUpdate:null,columnDragging:null,columnDragged:null,columnDropping:null,columnDropped:null,columnGrouping:null,columnGrouped:null,columnResizing:null,columnResized:null,columnUngrouping:null,columnUngrouped:null,currentCellChanging:null,currentCellChanged:null,filterOperatorsListShowing:null,filtering:null,filtered:null,groupAggregate:null,groupText:null,invalidCellValue:null,pageIndexChanging:null,pageIndexChanged:null,selectionChanged:null,sorting:null,sorted:null,ajaxError:null,dataLoading:null,dataLoaded:null,loading:null,loaded:null,rendering:null,rendered:null},_data$prefix:"wijgrid",_customSortOrder:1000,_reverseKey:false,_pageSizeKey:10,_mergeWidgetsWithOptions:true,_ajaxError:function(b,d,c){this._trigger("ajaxError",null,{XMLHttpRequest:b,textStatus:d,errorThrown:c});this._deactivateSpinner()},_dataLoading:function(b){this._trigger("dataLoading")},_dataLoaded:function(b){this._trigger("dataLoaded");this.doRefresh(b);this._loaded()},_loading:function(){this._activateSpinner();this._trigger("loading")},_loaded:function(){this._deactivateSpinner();this._trigger("loaded")},ensureControl:function(c,b){this._loading();if(!a.isPlainObject(b)){b={data:null,afterRefresh:null,beforeRefresh:null}}if(this._initialized){if(this._mergeWidgetsWithOptions){this._ownerise(false);this._widgetsToOptions()}}else{this._prepareColumnOptions(false)}this._ownerise(true);if(c===true){this._dataStore.load(b)}else{this.doRefresh(b);this._loaded()}},doRefresh:function(f){if(!this._initialized){try{this._prepareColumnOptions(true)}catch(n){throw n}finally{this._ownerise(true);this._initialized=true}}else{if(f&&a.isFunction(f.beforeRefresh)){f.beforeRefresh.apply(this)}}this._rebuildLeaves();var b=this._dataStore.getDataSlice(),p=b.data,l,o,d,c,j,h,k,m,g;a.each(this._field("leaves"),function(){this._totalsValue=(b.totals)?b.totals[this.dataKey]:undefined});this._setPageCount(b);l=this._field("leaves");this.sketchTable=[];if(d=p.length){for(o=0;o<d;o++){c=p[o];j=[];for(h=0,k=l.length;h<k;h++){m=l[h];if(a.wijmo.wijgrid.validDataKey(m.dataKey)){j.push({value:c.values[m.dataKey],__attr:(c.attributes)?c.attributes.cellsAttributes[m.dataKey]:{},__style:{}});j.originalRowIndex=c.originalRowIndex}}j.rowType=a.wijmo.wijgrid.rowType.data;if(o%2!==0){j.rowType|=a.wijmo.wijgrid.rowType.dataAlt}j.__style={};j.__attr=(c.attributes)?c.attributes.rowAttributes:{};this.sketchTable.push(j)}}else{if(b.emptyData&&(d=b.emptyData.length)){for(o=0;o<d;o++){c=b.emptyData[o];j=[];g=this._field("visibleLeaves").length;for(h=0,k=c.length;h<k;h++){j.push({html:c[h],__attr:{colSpan:((g>0&&o===d-1)?g-o:1)},__style:{}})}j.rowType=a.wijmo.wijgrid.rowType.emptyDataRow;j.__style={};j.__attr={};this.sketchTable.push(j)}}}this._onRendering();this._refresh();this._onRendered();if(f&&a.isFunction(f.afterRefresh)){f.afterRefresh.apply(this)}},getFilterOperatorsByDataType:function(b){var c=this.filterOperatorsCache.getByDataType(b||"string");this.filterOperatorsCache.sort(c,this.options.filterOperatorsSortMode);return c},setSize:function(f,c){var d=this._view(),e={type:"",hScrollValue:null,vScrollValue:null},g=this.outerDiv,h=this._field("frozener"),b=this._field("visibleLeaves");if(d&&d.getScrollValue){e=d.getScrollValue()}if(f||(f===0)){this._autoWidth=false;g.width(f)}if(c||(c===0)){this._autoHeight=false;g.height(c)}a.each(b,function(j,i){var k=d.getHeaderCell(j),l=d.getJoinedCols(j);a(k).css("width","");a.each(l,function(n,m){a(m).css("width","")})});this._updateSplits(e);if(h){h.refresh()}},_prepareColumnOptions:function(e){a.wijmo.wijgrid.traverse(this.options.columns,function(h){h.isBand=(a.isArray(h.columns)||(h.clientType==="c1band"));h._originalDataKey=h.dataKey;h._originalHeaderText=h.headerText});new a.wijmo.wijgrid.bandProcessor()._getVisibleHeight(this.options.columns,true);var g=[],f,d=this._originalHeaderRowData(),c=this._originalFooterRowData(),b=(this.options.columnsAutogenerationMode||"").toLowerCase();if(e){f=this._dataStore.dataMode()===a.wijmo.wijgrid.dataMode.dom;if(b!=="none"){(new a.wijmo.wijgrid.columnsGenerator(this)).generate(b,this._dataStore,this.options.columns)}}a.wijmo.wijgrid.setTraverseIndex(this.options.columns);a.wijmo.wijgrid.traverse(this.options.columns,function(h){h.isBand=(a.isArray(h.columns)||(h.clientType==="c1band"));a.wijmo.wijgrid.shallowMerge(h,a.wijmo.c1basefield.prototype.options);if(!h.isBand){a.wijmo.wijgrid.shallowMerge(h,a.wijmo.c1field.prototype.options);if(!h.clientType){h.clientType="c1field"}}else{h.clientType="c1band"}if(h.isLeaf&&!h.isBand){g.push(h)}});this._field("leaves",g);if(e){a.each(g,function(k,h){var j=(typeof(h.dataKey)==="number")?h.dataKey:k;if(b==="merge"||h.dynamic===true){if(h.headerText===undefined){if(f&&d&&(j<d.length)){h.headerText=a.trim(d[j])}else{if(a.wijmo.wijgrid.validDataKey(h.dataKey)){h.headerText=""+h.dataKey}}}}if(f&&c&&(j<c.length)){h._footerTextDOM=a.trim(c[j])}})}},_rebuildLeaves:function(){var b=[],d=[],c;if(this.options.showRowHeader){c=a.wijmo.wijgrid.createDynamicField({clientType:"c1basefield",dataIndex:-1,travIdx:-1,parentVis:true,allowMoving:false,allowSizing:false,allowSort:false,isRowHeader:true});c.owner=this;b.push(c)}a.each(this.options.columns,function(e,f){b.push(f)});this._field("columnHeadersTable",new a.wijmo.wijgrid.bandProcessor().generateSpanTable(b,d));this._field("leaves",d);this._onLeavesCreated()},_onLeavesCreated:function(){var e=this._field("leaves"),d=0,b=0,c=this;this._field("visibleLeaves",a.grep(e,function(f,g){f.leavesIdx=g;if(a.wijmo.wijgrid.validDataKey(f.dataKey)){f.dataIndex=d++}else{f.dataIndex=-1}if(!f.isBand){c._ensureDataParser(f);if(a.isFunction(f.dataParser)){f.dataParser=new f.dataParser()}}if(f.parentVis){f.visLeavesIdx=b++;return true}return false}))},_create:function(){if(!this.element.is("table")){throw"invalid markup"}if(a.isFunction(window.wijmoASPNetParseOptions)){wijmoASPNetParseOptions(this.options)}this.destroyed=false;var c=this.element[0].style.height,b=this.element[0].style.width;this._dataStore=new a.wijmo.wijgrid.dataStore(this);this._originalHtml=this.element.html();this.element.addClass("wijmo-wijgrid-root");this.element.wrap('<div class="ui-widget wijmo-wijgrid ui-widget-content ui-corner-all"></div>');this.outerDiv=this.element.parent();if(c){this.outerDiv.css("height",this.element[0].style.height)}if(c!==""&&c!=="auto"){this._autoHeight=false}else{this._autoHeight=true}if(b){this.outerDiv.css("width",this.element[0].style.width)}if(b!==""&&b!=="auto"){this._autoWidth=false}else{this._autoWidth=true}this.element.css({height:"",width:""});this.filterOperatorsCache=new a.wijmo.wijgrid.filterOperatorsCache();this._registerFilterOperator(a.wijmo.wijgrid.embeddedFilters);if(this.options.disabled){this.disable()}this.cellFormatter=new a.wijmo.wijgrid.cellFormatterHelper();this.rowStyleFormatter=new a.wijmo.wijgrid.rowStyleFormatterHelper(this);this.cellStyleFormatter=new a.wijmo.wijgrid.cellStyleFormatterHelper(this)},_init:function(){this.$superPanelHeader=null;this.$topPagerDiv=null;this.$bottomPagerDiv=null;this.$groupArea=null;this.filterOperatorsCache.removeCustom();a.each(this.options.customFilterOperators,function(b,c){if(c){c.custom=true}});this._registerFilterOperator(this.options.customFilterOperators);this._field("closestCulture",Globalize.findClosestCulture(this.options.culture)||Globalize.findClosestCulture("default"));if(!this.options.data){if(!this._field("thead")){this._field("thead",a.wijmo.wijgrid.readTableSection(this.element,1))}if(!this._field("tfoot")){this._field("tfoot",a.wijmo.wijgrid.readTableSection(this.element,3))}}this._initialized=this._initialized||false;this.ensureControl(true)},_setOption:function(d,f){var g=this["_preset_"+d],c=this.options[d],e,b;if(g!==undefined){f=g.apply(this,[f,c])}e=(f!==c);a.Widget.prototype._setOption.apply(this,[d,f]);if(e){b=this["_postset_"+d];if(b!==undefined){b.apply(this,[f,c])}}},destroy:function(){var c,b=this;try{this._view().dispose();this._detachEvents(true);if(c=this._field("resizer")){c.dispose()}if(c=this._field("frozener")){c.dispose()}a.wijmo.wijgrid.iterateChildrenWidgets(this.outerDiv,function(d,e){if(e!==b){e.destroy()}});if(c=this._field("selectionui")){c.dispose()}if(c=this._field("dragndrop")){c.dispose()}a.wijmo.wijgrid.remove$dataByPrefix(this.element,this._data$prefix);this.element.removeClass("wijmo-wijgrid-root");this.element.html(this._originalHtml);this.element.insertBefore(this.outerDiv);this.outerDiv.remove();a.Widget.prototype.destroy.apply(this,arguments)}finally{this.destroyed=true}},columns:function(){return this._field("columns")||[]},currentCell:function(c,f){var e,b=this._view(),d=this._rows();if(arguments.length===0){e=this._field("currentCell");if(!e){this._field("currentCell",e=a.wijmo.wijgrid.cellInfo.prototype.outsideValue)}return e}else{e=(arguments.length===1)?c._clone():new a.wijmo.wijgrid.cellInfo(c,f);if(!e.isEqual(a.wijmo.wijgrid.cellInfo.prototype.outsideValue)){if(!e._isValid()){throw"invalid arguments"}e._clip(this._getDataCellsRange());if(e.rowIndex()>=0){if(!(b._getRowInfo(d.item(e.rowIndex())).type&a.wijmo.wijgrid.rowType.data)){return}}}e._setGridView(this);this._changeCurrentCell(e);return this._field("currentCell")}},data:function(){return this._dataStore.dataSource().items},selection:function(){var b=this._field("selection");if(!b){this._field("selection",b=new a.wijmo.wijgrid.selection(this))}return b},beginEdit:function(){return this._beginEditInternal(null)},endEdit:function(){return this._endEditInternal(null)},pageCount:function(){return this.options.allowPaging?this._field("pageCount")||1:1},_dragndrop:function(){var b=this._field("dragndrop");if(!b){this._field("dragndrop",b=new a.wijmo.wijgrid.dragAndDropHelper(this))}return b},_headerRows:function(){return this._view().headerRows()},_filterRow:function(){return this._view().filterRow()},_localizeFilterOperators:function(c){var b=this;a.each(c,function(d,f){if(f.name){var e=b.filterOperatorsCache.getByName(f.name);if(e){e.displayName=f.displayName}}})},_rows:function(){return this._view().bodyRows()},_selectionui:function(){var b=this._field("selectionui");if(!b){this._field("selectionui",b=new a.wijmo.wijgrid.selectionui(this))}return b},_setPageCount:function(b){this._field("pageCount",Math.ceil(b.totalRows/this.options.pageSize)||1)},_registerFilterOperator:function(d){var b=this,c=d&&(a.isArray(d)||(a.isPlainObject(d)&&!d.operator))?d:arguments;a.each(c,function(e,f){b.filterOperatorsCache.add(f)})},_postset_allowColMoving:function(d,c){var b=this;a.each(this.columns(),function(e,f){if(d){b._dragndrop().attach(f)}else{b._dragndrop().detach(f)}});a.each(this._field("groupedWidgets"),function(e,f){if(d){b._dragndrop().attach(f)}else{b._dragndrop().detach(f)}})},_postset_allowSorting:function(c,b){this.ensureControl(false)},_postset_columns:function(c,b){throw"read-only"},_postset_allowPaging:function(c,b){this.ensureControl(true)},_postset_culture:function(c,b){throw"read-only"},_postset_customFilterOperators:function(c,b){this.filterOperatorsCache.removeCustom();a.each(this.options.customFilterOperators,function(d,e){e.custom=true});this._registerFilterOperator(c)},_postset_data:function(c,b){this._ownerise(false);a.wijmo.wijgrid.traverse(this.options.columns,function(f,e){if(f.dynamic){var d=a.inArray(f,e);if(d>=0){e.splice(d,1)}}else{f.dataKey=f._originalDataKey;f.headerText=f._originalHeaderText}});this._initialized=false;this.options.pageIndex=0;this._dataStore=new a.wijmo.wijgrid.dataStore(this);this.ensureControl(true)},_postset_disabled:function(e,d){var c=this,b=this._view();a.wijmo.wijgrid.iterateChildrenWidgets(this.outerDiv,function(f,g){if(g!==c){g.option("disabled",e)}});if(b){b.ensureDisabledState()}},_postset_groupIndent:function(c,b){this.ensureControl(false)},_postset_groupAreaCaption:function(d,c){var b=this._field("groupedColumns");if(this.$groupArea&&(!b||!b.length)){this.$groupArea.html(d||"&nbsp;")}},_postset_highlightCurrentCell:function(c,b){var d=this.currentCell();if(d&&d._isValid()){this._highlightCellPosition(d,c)}},_preset_pageIndex:function(d,c){if(isNaN(d)){throw"out of range"}var b=this.pageCount();if(d>b-1){d=b-1}if(d<0){d=0}if(this.options.allowPaging&&d!==c){if(!this._onPageIndexChanging({newPageIndex:d})){d=c}}return d},_postset_pageIndex:function(c,b){if(this.options.allowPaging){this.ensureControl(true,{afterRefresh:function(){this._onPageIndexChanged()}})}},_preset_pageSize:function(c,b){if(isNaN(c)){throw"out of range"}if(c<=0){c=1}return c},_postset_pageSize:function(c,b){this.options.pageIndex=0;if(this.options.allowPaging){this.ensureControl(true)}},_postset_pagerSettings:function(c,b){this.ensureControl(false)},_postset_scrollMode:function(c,b){if(c==="none"||b==="none"){this.ensureControl(false)}else{this._view().refreshPanel()}},_postset_selectionMode:function(d,b){var c=this.selection(),e=this.currentCell();c.beginUpdate();c.clear();if(e&&e._isValid()){c._selectRange(new a.wijmo.wijgrid.cellInfoRange(e,e),false,false,0,null)}c.endUpdate();this._view().toggleDOMSelection(d==="none")},_postset_showFilter:function(c,b){this.ensureControl(false)},_postset_showGroupArea:function(c,b){this.ensureControl(false)},_postset_showRowHeader:function(c,b){this.ensureControl(false)},_postset_staticRowIndex:function(){if(this.options.scrollMode!=="none"){this.ensureControl(false)}},_postset_staticColumnIndex:function(){if(this.options.scrollMode!=="none"){this.ensureControl(false)}},_activateSpinner:function(){var b=this.outerDiv.append('<div class="wijmo-wijgrid-overlay ui-widget-overlay"></div><span class="wijmo-wijgrid-loadingtext ui-widget-content ui-corner-all"><span class="ui-icon ui-icon-clock"></span>'+this.options.loadingText+"</span>").find("> .wijmo-wijgrid-loadingtext");b.position({my:"center",at:"center center",of:this.outerDiv,collision:"none"})},_deactivateSpinner:function(){this.outerDiv.find("> .wijmo-wijgrid-overlay, > .wijmo-wijgrid-loadingtext").remove()},_columnWidgetsFactory:function(b,e){var c,d=e.clientType;if(!d&&e.isBand){d="c1band"}e=a.extend({owner:this},e,{disabled:this.options.disabled});switch(d){case"c1basefield":c=b.c1basefield(e);break;case"c1band":c=b.c1band(e);break;default:c=b.c1field(e)}return c},_field:function(b,c){return a.wijmo.wijgrid.dataPrefix(this.element,this._data$prefix,b,c)},_removeField:function(b){var c=this._data$prefix+b;this.element.removeData(c)},_prepareFilterRequest:function(c){var d=this._field("leaves"),b;if(!d){return[]}b=a.map(d,a.proxy(function(g,e){if(!g.isBand&&(a.wijmo.wijgrid.validDataKey(g.dataKey))&&g.filterOperator){var h=a.extend(true,{},{foo:g.filterValue}).foo,f=a.extend(true,{},{foo:g.filterOperator}).foo,i=a.wijmo.wijgrid.filterHelper.verify(f,h,g.dataType,this.filterOperatorsCache);if(i){return(c)?[{column:g,filterOperator:i.filterOperator,filterValue:i.filterValue}]:[{dataKey:g.dataKey,filterOperator:i.filterOperator,filterValue:i.filterValue}]}}return null},this));return b},_preparePageRequest:function(b){if(this.options.allowPaging){return{pageIndex:this.options.pageIndex,pageSize:this.options.pageSize}}return null},_prepareSortRequest:function(c){var d=this._field("leaves"),b;if(!d||!this.options.allowSorting){return[]}b=a.map(d,function(f,e){var g=null;if(!f.isBand&&f.allowSort&&(a.wijmo.wijgrid.validDataKey(f.dataKey))){if(f.groupInfo&&(f.groupInfo.position!=="none")&&(f.sortDirection==="none")){f.sortDirection="ascending"}g=(f.sortDirection==="ascending"||f.sortDirection==="descending")?[{dataKey:f.dataKey,sortDirection:f.sortDirection,sortOrder:f.sortOrder||0}]:null}return g});b.sort(function(f,e){return f.sortOrder-e.sortOrder});a.each(b,function(e,f){delete f.sortOrder});return b},_prepareTotalsRequest:function(c){var d=this._field("leaves"),b;if(!d||!this.options.showFooter){return[]}b=a.map(d,function(f,e){if(!f.isBand&&a.wijmo.wijgrid.validDataKey(f.dataKey)&&f.aggregate&&f.aggregate!=="none"){return(c)?[{column:f,aggregate:f.aggregate}]:[{dataKey:f.dataKey,aggregate:f.aggregate}]}return null});return b},_widgetsToOptions:function(){var b=a.wijmo.wijgrid.flatten(this.options.columns);a.each(this.columns(),function(e,d){delete d.options.columns;var c=b[d.options.travIdx];a.extend(true,c,d.options);c.filterValue=d.options.filterValue;c.filterOperator=d.options.filterOperator})},_recreateColumnWidgets:function(){a.each(this.columns(),function(i,l){l.destroy()});var f=[],h=this._headerRows(),k,g,j,e,d,b,c;if(h&&h.length()){k=[];a.wijmo.wijgrid.traverse(this.options.columns,function(i){if(i.parentVis){k.push(i)}});for(g=0,j=k.length;g<j;g++){e=k[g];d=h.item(e.thY);b=new a.wijmo.wijgrid.rowAccessor().getCell(d,e.thX);c=this._columnWidgetsFactory(a(b),e);f.push(c.data(c.data(a.wijmo.c1basefield.prototype._data$prefix+"widgetName")))}}this._field("columns",f)},_ownerise:function(b){if(b){var c=this;a.wijmo.wijgrid.traverse(this.options.columns,function(g){g.owner=c;var f,e,d;if((f=g.groupInfo)){f.owner=g;if(f.expandInfo){for(e=0,d=f.expandInfo.length;e<d;e++){f.expandInfo[e].owner=f}}}})}else{a.wijmo.wijgrid.traverse(this.options.columns,function(g){delete g.owner;var f,e,d;if((f=g.groupInfo)){delete f.owner;if(f.expandInfo){for(e=0,d=f.expandInfo.length;e<d;e++){delete f.expandInfo[e].owner}}}})}},_updateSplits:function(b){if(this._view().updateSplits!==null){this._view().updateSplits(b)}},_refresh:function(){var b=this._view(),f,g,e,d={type:"",hScrollValue:null,vScrollValue:null},c=[];if(b&&b.getScrollValue){d=b.getScrollValue()}this._detachEvents(false);this.element.detach();this.element.empty();this.outerDiv.empty();this.outerDiv.append(this.element);if(this._field("selectionui")){this._field("selectionui").dispose();this._field("selectionui",null)}if(this._field("resizer")){this._field("resizer").dispose()}if(this._field("frozener")){this._field("frozener").dispose()}new a.wijmo.wijgrid.grouper().group(this,this.sketchTable,this._field("leaves"));new a.wijmo.wijgrid.merger().merge(this.sketchTable,this._field("visibleLeaves"));if(this.options.scrollMode!=="none"){this._field("view",b=new a.wijmo.wijgrid.fixedView(this))}else{this._field("view",b=new a.wijmo.wijgrid.flatView(this))}this._render();this._ownerise(false);this._recreateColumnWidgets();this._ownerise(true);if(this.options.allowPaging){if(this.$topPagerDiv){this.$topPagerDiv.wijpager(this._pagerSettings2PagerWidgetSettings()).css("zIndex",5)}if(this.$bottomPagerDiv){this.$bottomPagerDiv.wijpager(this._pagerSettings2PagerWidgetSettings()).css("zIndex",5)}}this._attachEvents();b.focusableElement().attr("tabIndex",0);if(this.currentCell()._isValid()&&this.currentCell(this.currentCell())){this.currentCell()._isEdit(false)}else{this.currentCell(this._getFirstDataRowCell(0))}this._field("selection",null);f=this.currentCell();if(f._isValid()){this.selection()._startNewTransaction(f);this.selection()._selectRange(new a.wijmo.wijgrid.cellInfoRange(f,f),false,false,0,null)}this._selectionui();g=new a.wijmo.wijgrid.resizer(this);a.each(this.columns(),function(i,h){var j=h.options;if(j.visible&&j.parentVis&&j.isLeaf){g.addElement(h)}});this._field("resizer",g);this._updateSplits(d);if(this.options.scrollMode!=="none"){e=new a.wijmo.wijgrid.frozener(this);e.addVElement(this._getStaticIndex(false));e.addHElement(this._getStaticIndex(true));e.attachDivEvent();this._field("frozener",e)}a.each(this.columns(),function(i,h){if(!h.options.isBand&&h.options.showFilter===true){var j=h._getFilterEditorWidth();if(j!==undefined){c.push({widget:h,width:j})}}});a.each(c,function(h,i){i.widget._setFilterEditorWidth(i.width)})},_needToCreatePagerItem:function(){return this.options.allowPaging},_render:function(){var b=this._view(),d=this.options,c;b.render();c=this.outerDiv;if(d.scrollMode!=="none"){c=this.outerDiv.find("div.wijmo-wijgrid-scroller:first")}this.$superPanelHeader=null;if(this.$topPagerDiv){if(this.$topPagerDiv.data("wijpager")){this.$topPagerDiv.wijpager("destroy")}this.$topPagerDiv.remove()}this.$topPagerDiv=null;if(this._needToCreatePagerItem()&&((d.pagerSettings.position==="top")||(d.pagerSettings.position==="topAndBottom"))){if(!this.$topPagerDiv){c.prepend(this.$superPanelHeader=a('<div class="wijmo-wijsuperpanel-header"></div>'));this.$superPanelHeader.prepend(this.$topPagerDiv=a('<div class="wijmo-wijgrid-header ui-widget-header ui-corner-top"></div>'))}}if(d.showGroupArea){this._processGroupArea(c)}else{this.$groupArea=null}if(this.$bottomPagerDiv){if(this.$bottomPagerDiv.data("wijpager")){this.$bottomPagerDiv.wijpager("destroy")}this.$bottomPagerDiv.remove()}this.$bottomPagerDiv=null;if(this._needToCreatePagerItem()&&((d.pagerSettings.position==="bottom")||(d.pagerSettings.position==="topAndBottom"))){if(!this.$bottomPagerDiv){c.append(this.$bottomPagerDiv=a('<div class="wijmo-wijgrid-footer wijmo-wijsuperpanel-footer ui-state-default ui-corner-bottom"></div>'))}}},_processGroupArea:function(d){var b=this,c=this._field("groupedColumns"),e=[];this.$groupArea=a('<div class="ui-widget-content ui-helper-clearfix"></div>');if(c.length>0){a.each(c,function(f,h){var g=a('<a href="#"></a>').appendTo(b.$groupArea);g.c1groupedfield(a.extend({owner:b},{allowMoving:h.allowMoving,allowSort:h.allowSort,dataIndex:h.dataIndex,headerText:h.headerText,isBand:h.isBand,isLeaf:h.isLeaf,linearIdx:h.linearIdx,parentIdx:h.parentIdx,sortDirection:h.sortDirection,travIdx:h.travIdx,groupedIndex:h.groupedIndex},{disabled:b.options.disabled}));e.push(g.data("c1groupedfield"))})}else{this.$groupArea.addClass("wijmo-wijgrid-group-area").html(this.options.groupAreaCaption||"&nbsp;")}this._field("groupedWidgets",e);if(!this.$superPanelHeader){d.prepend(this.$superPanelHeader=a('<div class="wijmo-wijsuperpanel-header"></div>'))}this.$superPanelHeader.prepend(this.$groupArea);this._dragndrop().attachGroupArea(this.$groupArea)},_attachEvents:function(){var b=this._view(),c=b.focusableElement();c.bind("keydown."+this.widgetName,a.proxy(this._onKeyDown,this));c.bind("keypress."+this.widgetName,a.proxy(this._onKeyPress,this));a.each(b.subTables(),a.proxy(function(d,e){var f=e.element();if(f){if(f.tHead){a(f.tHead).bind("click."+this.widgetName,a.proxy(this._onClick,this))}if(f.tBodies.length){a(f.tBodies[0]).bind("click."+this.widgetName,a.proxy(this._onClick,this)).bind("dblclick."+this.widgetName,a.proxy(this._onDblClick,this)).bind("mousemove."+this.widgetName,a.proxy(this._onMouseMove,this)).bind("mouseout."+this.widgetName,a.proxy(this._onMouseOut,this)).find("> tr.wijmo-wijgrid-groupheaderrow > td .wijmo-wijgrid-grouptogglebtn").bind("click."+this.widgetName,a.proxy(this._onGroupBtnClick,this))}}},this))},_detachEvents:function(e){var b=this._view(),d=this,c;if(b){c=b.focusableElement();c.unbind("keydown."+this.widgetName);c.unbind("keypress."+this.widgetName);a.each(b.subTables(),function(){var f=this.element();if(f){if(f.tHead){a(f.tHead).unbind("."+d.widgetName)}if(f.tBodies.length){a(f.tBodies[0]).unbind("."+d.widgetName)}}});if(e){a.each(b.getJoinedTables(true,0),function(f,g){if(g&&typeof(g)!=="number"){a(g.element()).find("> tbody").find("> tr.wijmo-wijgrid-groupheaderrow > td .wijmo-wijgrid-grouptogglebtn").unbind("."+d.widgetName)}})}}},_handleSort:function(g,c){var f=this.options.columns,b=g.travIdx,e,d;if(g&&this.options.allowSorting){e=((g.sortDirection==="none")?"ascending":((g.sortDirection==="ascending")?"descending":"ascending"));d={column:g,sortDirection:e};if(this._onColumnSorting(d)){d.column.sortDirection=d.sortDirection;if(c){d.column.sortOrder=this._customSortOrder++}else{this._customSortOrder=1000;a.each(this.columns(),function(h,i){i.options.sortOrder=0;if(i.options.travIdx!==b&&!(i.options.groupInfo&&i.options.groupInfo.position!=="none")){i.options.sortDirection="none"}});a.wijmo.wijgrid.traverse(f,function(h){h.sortOrder=0;if(h.travIdx!==b&&!(h.groupInfo&&h.groupInfo.position!=="none")){h.sortDirection="none"}})}this.ensureControl(true,{afterRefresh:function(){this._onColumnSorted({column:d.column})}})}}},_pagerSettings2PagerWidgetSettings:function(){return a.extend({},this.options.pagerSettings,{disabled:this.options.disabled,pageCount:this.pageCount(),pageIndex:this.options.pageIndex,pageIndexChanging:a.proxy(this._onPagerWidgetPageIndexChanging,this),pageIndexChanged:a.proxy(this._onPagerWidgetPageIndexChanged,this)})},_handleDragnDrop:function(f,j,e,b,i){var h=a.wijmo.wijgrid.getColumnByTravIdx(this.options.columns,f),d=a.wijmo.wijgrid.getColumnByTravIdx(this.options.columns,j),c=b?"groupArea":"columns",g=i?"groupArea":"columns";if(i){if(this._onColumnGrouping({drag:h.found,drop:d?d.found:null,dragSource:c,dropSource:g,at:e})){this.ensureControl(true,{beforeRefresh:function(){if(!d){h.found.groupedIndex=0}else{switch(e){case"left":h.found.groupedIndex=d.found.groupedIndex-0.5;break;case"right":h.found.groupedIndex=d.found.groupedIndex+0.5;break}}if(!b){a.extend(true,h.found,{groupInfo:{position:"header"}})}},afterRefresh:function(){this._onColumnGrouped({drag:h.found,drop:d?d.found:null,dragSource:c,dropSource:g,at:e})}})}}else{if(this._onColumnDropping({drag:h.found,drop:d.found,at:e})){this.ensureControl(false,{beforeRefresh:function(){h.at.splice(h.found.linearIdx,1);switch(e){case"left":if(h.at===d.at&&h.found.linearIdx<d.found.linearIdx){d.at.splice(d.found.linearIdx-1,0,h.found)}else{d.at.splice(d.found.linearIdx,0,h.found)}break;case"right":if(h.at===d.at&&h.found.linearIdx<d.found.linearIdx){d.at.splice(d.found.linearIdx,0,h.found)}else{d.at.splice(d.found.linearIdx+1,0,h.found)}break;case"center":d.found.columns.push(h.found);break}a.wijmo.wijgrid.setTraverseIndex(this.options.columns)},afterRefresh:function(){this._onColumnDropped({drag:h.found,drop:d.found,at:e})}})}}},_handleFilter:function(e,h,g){var b=this.filterOperatorsCache.getByName(h),f,d,c;if(b){if(b.arity>1){f=this._parse(e.options,g);d=(f!==null&&(e.options.dataType==="string"||!isNaN(f)))}else{d=true}if(d){c={column:e.options,operator:b.name,value:f};if(this._onColumnFiltering(c)){e.options.filterValue=c.value;e.options.filterOperator=c.operator;this.options.pageIndex=0;this.ensureControl(true,{afterRefresh:function(){this._onColumnFiltered({column:e.options})}})}}}},_handleUngroup:function(c){var b=a.wijmo.wijgrid.getColumnByTravIdx(this.options.columns,c);if(b&&b.found){b=b.found;if(this._onColumnUngrouping({column:b})){this.ensureControl(false,{beforeRefresh:function(){delete b.groupedIndex;a.extend(true,b,{groupInfo:{position:"none"}})},afterRefresh:function(){this._onColumnUngrouped({column:b})}})}}},_onColumnDropping:function(b){return this._trigger("columnDropping",null,b)},_onColumnDropped:function(b){this._trigger("columnDropped",null,b)},_onColumnGrouping:function(b){return this._trigger("columnGrouping",null,b)},_onColumnGrouped:function(b){this._trigger("columnGrouped",null,b)},_onColumnUngrouping:function(b){return this._trigger("columnUngrouping",null,b)},_onColumnUngrouped:function(b){this._trigger("columnUngrouped",null,b)},_onColumnFiltering:function(b){return this._trigger("filtering",null,b)},_onColumnFiltered:function(b){this._trigger("filtered",null,b)},_onColumnSorting:function(b){return this._trigger("sorting",null,b)},_onColumnSorted:function(b){this._trigger("sorted",null,b)},_onCurrentCellChanged:function(){var c=this.options,b;if(c.allowKeyboardNavigation){b=this._field("currentCell");if(c.scrollMode!=="none"&&b&&!b.isEqual(b.outsideValue)){this._view().scrollTo(b)}}this._trigger("currentCellChanged")},_onPageIndexChanging:function(b){return this._trigger("pageIndexChanging",null,b)},_onPageIndexChanged:function(b){this._trigger("pageIndexChanged")},_onPagerWidgetPageIndexChanging:function(c,b){b.handled=true},_onPagerWidgetPageIndexChanged:function(c,b){this._setOption("pageIndex",b.newPageIndex)},_onRendering:function(){this._rendered=false;this._trigger("rendering")},_onRendered:function(){this._rendered=true;this._trigger("rendered")},_onClick:function(g){if(!this._canInteract()||!g.target){return}var i=this._view(),b=this._getParentSubTable(g.target,["td","th"],i.subTables()),e,f,c,d=0,h,j;if(b){e=b[0];f=a(e).closest("tr");if(!(f.is(".wijmo-wijgrid-datarow")||f.is(".wijmo-wijgrid-headerrow"))){return}if(!f.length){return}c=i.getAbsoluteCellInfo(e)._absToData(this._getDataToAbsOffset());if(c.cellIndex()<0||c.rowIndex()<0){if(c.rowIndex()>=0){c=new a.wijmo.wijgrid.cellInfo(0,c.rowIndex());d=2}else{c=this._getFirstDataRowCell(c.cellIndex());d=1}}this._changeCurrentCell(c);h=this.currentCell();j=this.selection();if(!g.shiftKey||(!j._multipleRangesAllowed()&&this.options.selectionMode.toLowerCase()!=="singlerange")){j._startNewTransaction(h)}j.beginUpdate();if(g.shiftKey&&g.ctrlKey){j._clearRange(new a.wijmo.wijgrid.cellInfoRange(h,h),d)}else{j._selectRange(new a.wijmo.wijgrid.cellInfoRange(j._anchorCell(),h),g.ctrlKey,g.shiftKey,d,null)}j.endUpdate()}},_onDblClick:function(b){this._beginEditInternal(b)},_onGroupBtnClick:function(d){if(!this._canInteract()){return}var b=a(d.target).closest("tr"),c=new a.wijmo.wijgrid.groupHelper(),e=c.getGroupInfo(b[0]),f,g;if(e){f=c.getColumnByGroupLevel(this._field("leaves"),e.level);if(f){g=f.groupInfo.expandInfo[e.index];if(g.isExpanded){g.collapse(d.shiftKey)}else{g.expand(d.shiftKey)}this._view().ensureHeight()}}},_onKeyDown:function(e){if(!this._canInteract()){return true}var c=e.target.tagName.toLowerCase(),d=false,g,b,h,f;if((c==="input"||c==="option"||c==="select"||c==="textarea")&&(a(e.target).closest("tr.wijmo-wijgrid-datarow").length===0)){return true}if(this.options.allowEditing){if((e.which===a.ui.keyCode.ESCAPE||e.which===113)&&(this.currentCell()._isValid()&&this.currentCell()._isEdit())){this._endEditInternal(e);return false}else{if(e.which===113){this._beginEditInternal(e);return false}}}if(!this.options.allowKeyboardNavigation||(e.which===a.ui.keyCode.TAB)){return true}switch(e.which){case a.ui.keyCode.LEFT:case a.ui.keyCode.RIGHT:case a.ui.keyCode.DOWN:case a.ui.keyCode.UP:case a.ui.keyCode.PAGE_DOWN:case a.ui.keyCode.PAGE_UP:case a.ui.keyCode.HOME:case a.ui.keyCode.END:case a.ui.keyCode.TAB:g=this._getNextCurrencyPos(this._getDataCellsRange(),this.currentCell(),e.keyCode,e.shiftKey);d=this._canMoveToAnotherCell(e.target,e.which);break}if(d){this._changeCurrentCell(new a.wijmo.wijgrid.cellInfo(g.cellIndex,g.rowIndex));h=this.currentCell();f=this.selection();if(!e.shiftKey||(!f._multipleRangesAllowed()&&this.options.selectionMode.toLowerCase()!=="singlerange")){f._startNewTransaction(h)}f.beginUpdate();f._selectRange(new a.wijmo.wijgrid.cellInfoRange(f._anchorCell(),h),false,e.shiftKey,0,null);f.endUpdate();return false}return true},_onKeyPress:function(e){if(this._canInteract()&&this.options.allowEditing){var c=e.which,g=this.currentCell(),b,f,d;if(c&&g._isValid()&&!g._isEdit()){b=e.target.tagName.toLowerCase();if(b!=="input"&&b!=="option"&&b!=="select"&&b!=="textarea"){f=a(e.target).closest(".wijmo-wijgrid-table");if(f.length){d=a.map(this._view().subTables(),function(i,h){return i.element()});if(a.inArray(f[0],d)>=0){if(a.wij.charValidator.isPrintableChar(String.fromCharCode(c))){this._beginEditInternal(e);return false}}}}}}},_onMouseMove:function(g){if(!this._canInteract()){return}var j=this._view(),e=this._getParentSubTable(g.target,["td","th"],j.subTables()),f,d,k,h,i,b,c=a.wijmo.wijgrid.renderState;if(e){f=e[0];d=a(f).closest("tr");if(!d.length||d.is(".wijmo-wijgrid-foorow")||!(d.is(".wijmo-wijgrid-datarow")||d.is(".wijmo-wijgrid-headerrow"))){return}k=j.getAbsoluteCellInfo(f)._absToData(this._getDataToAbsOffset());h=this._field("hoveredRow");if(h!==undefined&&k.rowIndex()!==h){i=this._rows().item(h);if(i){b=j._getRowInfo(i);j._changeRowRenderState(b,c.hovered,false);this.rowStyleFormatter.format(b)}}h=k.rowIndex();this._field("hoveredRow",h);if(h>=0){i=this._rows().item(h);if(i){b=j._getRowInfo(i);j._changeRowRenderState(b,c.hovered,true);this.rowStyleFormatter.format(b)}}}},_onMouseOut:function(e){if(a(e.relatedTarget).closest(".wijmo-wijgrid-data").length===0){var d=this._field("hoveredRow"),c,f,b=this._view();if(d>=0){c=this._rows().item(d);if(c){f=b._getRowInfo(c);b._changeRowRenderState(f,a.wijmo.wijgrid.renderState.hovered,false);this.rowStyleFormatter.format(f)}}}},_fieldResized:function(d,b,c){if(b<0){b=0}if(c<=0){c=1}if(this._trigger("columnResizing",null,{column:d.options,oldWidth:b,newWidth:c})!==false){d.option("width",c);this._trigger("columnResized",null,{column:d.options})}},_changeCurrentCell:function(e){var g=this.currentCell(),d=this._getDataCellsRange(),c,f,b=this.options.highlightCurrentCell;if((d._isValid()&&d._containsCellInfo(e))||(e.isEqual(e.outsideValue))){if(g.cellIndex()!==e.cellIndex()||g.rowIndex()!==e.rowIndex()){c={cellIndex:e.cellIndex(),rowIndex:e.rowIndex(),oldCellIndex:g.cellIndex(),oldRowIndex:g.rowIndex()};if(this._trigger("currentCellChanging",null,c)){f=false;if(!this.options.allowEditing||!g._isEdit()||(f=this._endEditInternal(null))){if(b&&d._containsCellInfo(g)){this._highlightCellPosition(g,false)}g=e._clone();g._setGridView(this);if(b){this._highlightCellPosition(g,true)}this._field("currentCell",g);this._onCurrentCellChanged()}}}else{if(b){this._highlightCellPosition(g,true)}}}else{}},_highlightCellPosition:function(e,k){if(e&&e._isValid()){var g=e._clone()._dataToAbs(this._getDataToAbsOffset()),j=g.cellIndex(),h=g.rowIndex(),d=a.wijmo.wijgrid.renderState,i=this._view(),f,c,b;f=i.getHeaderCell(j);if(f){c=i._getRowInfo(this._headerRows().item(e.column().thY));f=a(f);b=i._changeCellRenderState(f,d.current,k);this.cellStyleFormatter.format(f,j,e.column(),c,b)}f=i.getJoinedRows(h,0);if(f){c=i._getRowInfo(f);i._changeRowRenderState(c,d.current,k);this.rowStyleFormatter.format(c)}f=i.getCell(j,h);if(f){f=a(f);b=i._changeCellRenderState(f,d.current,k);this.cellStyleFormatter.format(f,j,e.column(),c,b)}}},_beginEditInternal:function(d){if(this._canInteract()&&this.options.allowEditing){var c=this.currentCell().column(),b;if(c&&!c.readOnly){b=new a.wijmo.wijgrid.cellEditorHelper().currentCellEditStart(this,d);if(b){}return b}}return false},_endEditInternal:function(c){if(this._canInteract()&&this.options.allowEditing){var b=new a.wijmo.wijgrid.cellEditorHelper().currentCellEditEnd(this,c);if(b){this._view().ensureHeight(this.currentCell().rowIndex())}return b}return false},_onViewInsertEmptyRow:function(f,b,c,d,e){return null},_onViewCreateEmptyCell:function(d,b,c){return null},_onViewCellRendered:function(e,d,b,c){},_onViewRowRendered:function(b){},_ensureDataParser:function(b){switch(b.dataType){case undefined:case"string":if(!b.dataParser){b.dataParser=a.wijmo.wijgrid.embeddedParsers.stringParser}break;case"boolean":if(!b.dataParser){b.dataParser=a.wijmo.wijgrid.embeddedParsers.boolParser}break;case"number":if(!b.dataParser){b.dataParser=a.wijmo.wijgrid.embeddedParsers.numberParser}break;case"currency":if(!b.dataParser){b.dataParser=a.wijmo.wijgrid.embeddedParsers.currencyParser}break;case"datetime":if(!b.dataParser){b.dataParser=a.wijmo.wijgrid.embeddedParsers.dateTimeParser}break;default:throw a.wijmo.wijgrid.stringFormat('Unsupported dataType value: "{0}"',b.dataType)}},_parseDOM:function(b,c){return b.dataParser.parseDOM(c,this._field("closestCulture"),b.dataFormatString,this.options.nullString,true)},_parse:function(c,d){var b=c.dataParser.parse(d,this._field("closestCulture"),c.dataFormatString,this.options.nullString,true);switch(c.dataType){case"datetime":if(b!==null&&!(b instanceof Date)){throw"invalid value."}break;case"number":case"currency":if(b!==null&&(typeof(b)!=="number"||isNaN(b))){throw"invalid value."}break;case"boolean":if(b!==null&&(typeof(b)!=="boolean"||isNaN(b))){throw"invalid value."}break;case"string":if(b!==null&&typeof(b)!=="string"){throw"invalid value."}break}return b},_toStr:function(b,c){return b.dataParser.toStr(c,this._field("closestCulture"),b.dataFormatString,this.options.nullString,true)},_funcOptions:function(){return["cellStyleFormatter","rowStyleFormatter","afterCellEdit","afterCellUpdate","beforeCellEdit","beforeCellUpdate","columnDragging","columnDragged","columnDropping","columnDropped","columnResizing","columnResized","columnGrouping","columnGrouped","columnUngrouping","columnUngrouped","currentCellChanging","currentCellChanged","filtering","filtered","filterOperatorsListShowing","groupAggregate","groupText","invalidCellValue","pageIndexChanging","pageIndexChanged","selectionChanged","sorting","sorted","ajaxError","dataLoading","dataLoaded","loading","loaded","rendering","rendered"]},_canInteract:function(){return !this.options.disabled},_canMoveToAnotherCell:function(g,f){var c=g.tagName.toLowerCase(),b,h,e,d;switch(c){case"input":if(a(g).hasClass("wijgridinput")){if(g.type==="text"){b=g.value.length;h=new a.wijmo.wijgrid.domSelection(g).getSelection();e=a.ui.keyCode;d=((f===e.UP||f===e.DOWN||f===e.PAGE_DOWN||f===e.PAGE_UP)||(h.length===0&&((h.start===0&&(f===e.LEFT||f===e.HOME))||(h.end>=b&&(f===e.RIGHT||f===e.END)))));return d}return true}return false;case"textarea":case"select":return false}return true},_getDataToAbsOffset:function(){var b=0,d=0,c=this._headerRows();if(this.options.showRowHeader){b++}if(c){d+=c.length()}if(this._filterRow()){d++}return{x:b,y:d}},_getDataCellsRange:function(){var d=0,b=0,c=this._field("visibleLeaves").length-1,e=(this._rendered)?this._rows().length()-1:this.sketchTable.length-1;if(this.options.showRowHeader){c--}if(c<0||e<0){d=b=c=e=-1}return new a.wijmo.wijgrid.cellInfoRange(new a.wijmo.wijgrid.cellInfo(d,b),new a.wijmo.wijgrid.cellInfo(c,e))},_getDataItem:function(b){return this.data()[b]},_getFirstDataRowCell:function(g){var h,c,f,d=this._view(),e=this._rows(),b=a.wijmo.wijgrid.rowType;for(h=0,c=e.length();h<c;h++){f=d._getRowInfo(e.item(h));if(f.type&b.data){return new a.wijmo.wijgrid.cellInfo(g,h)}}return a.wijmo.wijgrid.cellInfo.prototype.outsideValue},_getNextCurrencyPos:function(e,d,g,b){var c=d.cellIndex(),h=d.rowIndex(),f;switch(g){case a.ui.keyCode.PAGE_UP:if(this._reverseKey&&h===e.topLeft().rowIndex()){h=e.bottomRight().rowIndex()}else{h-=this._pageSizeKey;if(h<(f=e.topLeft().rowIndex())){h=f}}break;case a.ui.keyCode.PAGE_DOWN:if(this._reverseKey&&h===e.bottomRight().rowIndex()){h=e.TopLeft().RowIndex()}else{h+=this._pageSizeKey;if(h>(f=e.bottomRight().rowIndex())){h=f}}break;case a.ui.keyCode.END:c=(this._reverseKey&&c===e.bottomRight().cellIndex())?e.topLeft().cellIndex():e.bottomRight().cellIndex();break;case a.ui.keyCode.HOME:c=(this._reverseKey&&c===e.topLeft().cellIndex())?e.bottomRight().cellIndex():e.topLeft().cellIndex();break;case a.ui.keyCode.LEFT:if(c>e.topLeft().cellIndex()){c--}else{if(this._reverseKey){c=e.bottomRight().cellIndex()}}break;case a.ui.keyCode.UP:if(h>e.topLeft().rowIndex()){h--}else{if(this._reverseKey){h=e.bottomRight().rowIndex()}}break;case a.ui.keyCode.RIGHT:if(c<e.bottomRight().cellIndex()){c++}else{if(this._reverseKey){c=e.topLeft().cellIndex()}}break;case a.ui.keyCode.ENTER:case a.ui.keyCode.DOWN:if(h<e.bottomRight().rowIndex()){h++}else{if(this._reverseKey){h=e.topLeft().rowIndex()}}break;case a.ui.keyCode.TAB:if(false){if(b){c--;if(c<e.topLeft().cellIndex()){c=e.bottomRight().cellIndex();h--;if(h<e.topLeft().rowIndex()){h=e.bottomRight().rowIndex()}}}else{c++;if(c>e.bottomRight().cellIndex()){c=e.topLeft().cellIndex();h++;if(h>e.bottomRight().rowIndex()){h=e.topLeft().rowIndex()}}}}break}return{cellIndex:c,rowIndex:h}},_getParentSubTable:function(c,f,d){var e=a.map(d,function(j,i){return j.element()}),g=null,h=null,b;for(;c!==null&&g===null;c=c.parentNode){b=(c.tagName)?c.tagName.toLowerCase():undefined;if(a.inArray(b,f)>=0){h=c}else{if(a.inArray(c,e)>=0){g=c}}}return(h&&g)?[h,g]:null},_getStaticIndex:function(d){var b,c=this._getDataCellsRange();if(this._hasSpannedCells()){return -1}if(d){b=Math.min(this.options.staticRowIndex,c.bottomRight().rowIndex())}else{b=Math.min(this.options.staticColumnIndex,c.bottomRight().cellIndex())}if(b<-1){b=-1}return b},_getRealStaticColumnIndex:function(h){var g,c,f=0,e=this._getStaticIndex(false),b,d;if(this.options.showRowHeader===true){f++}if(h){return f}b=e+f;if(e>=0){g=this._field("visibleLeaves");c=g.length;d=b;for(;b<c;b++){if(g[b].parentIdx===-1){if(b>d){b--}break}}if(b>=c){b=c-1}}return b},_getRealStaticRowIndex:function(c){var b=this._field("columnHeadersTable").length;if(this.options.showFilter){b++}if(c){return b}return this._getStaticIndex(true)+b},_hasSpannedCells:function(){var f=this._field("leaves"),e,c,d,b=false;for(e=0,c=f.length;(e<c)&&!b;e++){d=f[e];b=d.groupInfo&&(d.groupInfo.position!=="none");b|=d.parentVis&&(d.rowMerge!=="none")}return b},_view:function(){return this._field("view")},_originalFooterRowData:function(){var b=this._field("tfoot");return(b&&b.length)?b[0]:null},_originalHeaderRowData:function(){var b=this._field("thead");return(b&&b.length)?b[0]:null}})})(jQuery);(function(a){a.widget("wijmo.c1basefield",{_data$prefix:"c1basefield",options:{allowMoving:true,allowSizing:true,cellFormatter:undefined,dataKey:undefined,ensurePxWidth:undefined,footerText:undefined,headerText:undefined,visible:true,width:undefined},_create:function(){var b=this.options.owner;this.element.addClass("ui-widget wijmo-c1basefield ui-state-default");this._field("owner",b);delete this.options.owner;this._field("widgetName",this.widgetName);if(this.options.disabled){this.disable()}if(b.options.allowColMoving){b._dragndrop().attach(this)}},_init:function(){this.element.wrapInner("<div class='wijmo-wijgrid-innercell'></div>");this._refreshHeaderCell()},destroy:function(){var b=this._owner();if(b){b._dragndrop().detach(this)}a.wijmo.wijgrid.remove$dataByPrefix(this.element,this._data$prefix);this.element.removeClass("ui-widget wijmo-c1basefield ui-state-default").html(this.element.find(".wijmo-wijgrid-headertext").contents())},_field:function(b,c){return a.wijmo.wijgrid.dataPrefix(this.element,this._data$prefix,b,c)},_removeField:function(b){var c=this._data$prefix+b;this.element.removeData(c)},_setOption:function(e,g,b){var h=this["_preset_"+e],d=this.options[e],f,c;if(h!==undefined){g=h.apply(this,[g,d,b])}f=(g!==d);a.Widget.prototype._setOption.apply(this,[e,g]);if(f){c=this["_postset_"+e];if(c!==undefined){c.apply(this,[g,d,b])}}},_postset_allowMoving:function(d,c,b){this._invokeGroupedColumn("allowMoving",d,b)},_preset_clientType:function(c,b){throw"read-only"},_postset_headerText:function(d,c,b){this._refreshHeaderCell();this._invokeGroupedColumn("headerText",d,b)},_postset_visible:function(c,b){this._owner().ensureControl(false)},_postset_width:function(f,d){var b=this._owner()._view(),c=this.options.visLeavesIdx,e=a(b.getHeaderCell(c)).outerWidth();b.ensureWidth(c,f,e)},_invokeGroupedColumn:function(d,e,c){if(!c&&this.options.groupedIndex!==undefined){var b=this._owner()._field("groupedWidgets")[this.options.groupedIndex];b._setOption(d,e,true)}},_owner:function(){return this._field("owner")},_canSize:function(){return this.options.allowSizing&&this._owner().options.allowColSizing},_canDrag:function(){return this.options.allowMoving===true},_canDropTo:function(b){if(a.wijmo.wijgrid.isChildOf(this._owner().options.columns,b,this)){return false}return true},_refreshHeaderCell:function(){var b=this.element.children(".wijmo-wijgrid-innercell").empty().html(this.options.headerText||"").wrapInner('<span class="wijmo-wijgrid-headertext" />')}})})(jQuery);(function(a){a.widget("wijmo.c1field",a.wijmo.c1basefield,{options:{aggregate:"none",allowSort:true,dataType:"string",dataParser:undefined,dataFormatString:undefined,filterOperator:"nofilter",filterValue:undefined,groupInfo:{expandInfo:[],groupSingleRow:true,collapsedImageClass:"ui-icon-triangle-1-e",expandedImageClass:"ui-icon-triangle-1-se",position:"none",outlineMode:"startExpanded",headerText:undefined,footerText:undefined},readOnly:false,rowMerge:"none",showFilter:true,sortDirection:"none",valueRequired:false},_create:function(){a.wijmo.c1basefield.prototype._create.apply(this,arguments);this.element.addClass("ui-widget wijmo-c1field")},destroy:function(){this.element.find("*").unbind("."+this.widgetName);if(this.$filterEditor){this.$filterEditor.closest("td").find("*").unbind("."+this.widgetName);switch(this._getInputEditorType(this.options)){case"date":if(this.$filterEditor.data("wijinputdate")){this.$filterEditor.wijinputdate("destroy")}break;case"mask":if(this.$filterEditor.data("wijinputmask")){this.$filterEditor.wijinputmask("destroy")}break;case"numberCurrency":case"numberNumber":case"numberPercent":if(this.$filterEditor.data("wijinputnumber")){this.$filterEditor.wijinputnumber("destroy")}break}this.$filterEditor=null}this.element.removeClass("ui-widget wijmo-c1field").find(".wijmo-wijgrid-headertext > span.ui-icon").remove();this._removeDropDownFilterList();a.wijmo.c1basefield.prototype.destroy.apply(this,arguments)},_init:function(){a.wijmo.c1basefield.prototype._init.apply(this,arguments);this.$filterEditor=null;var b=this._owner();this.filterRow=b._filterRow();if(b.options.showFilter&&this.options.showFilter&&(this.options.dataIndex>=0)){this._prepareFilterCell()}},_postset_aggregate:function(c,b){this._owner().ensureControl(false)},_postset_allowSort:function(d,c,b){this._refreshHeaderCell();this._invokeGroupedColumn("allowSort",d,b)},_postset_dataType:function(c,b){throw"read-only"},_postset_dataParser:function(c,b){this._owner().ensureControl(false)},_postset_dataFormatString:function(c,b){this._owner().ensureControl(false)},_postset_filterOperator:function(c,b){this._owner().ensureControl(true)},_postset_filterValue:function(c,b){this._owner().ensureControl(true)},_postset_groupInfo:function(c,b){this._owner().ensureControl(true)},_postset_rowMerge:function(c,b){this._owner().ensureControl(false)},_postset_showFilter:function(c,b){this._owner().ensureControl(false)},_postset_sortDirection:function(c,b){this.options.sortOrder=0;this._owner().ensureControl(true)},_postset_width:function(c,b){this._setFilterEditorWidth(1);a.wijmo.c1basefield.prototype._postset_width.apply(this,arguments);this._setFilterEditorWidth(this._getFilterEditorWidth())},_canDropTo:function(b){if(a.wijmo.c1basefield.prototype._canDropTo.apply(this,arguments)){if(this.options.groupedIndex!==undefined&&(b instanceof a.wijmo.c1groupedfield)){return false}return true}return false},_canSort:function(){var b=this._owner();return(b&&b.options.allowSorting&&this.options.allowSort&&(this.options.dataIndex>=0))},_refreshHeaderCell:function(){if(this._canSort()){var b,c=this.element.children(".wijmo-wijgrid-innercell").empty().html(this.options.headerText||"").wrapInner('<a class="wijmo-wijgrid-headertext" href="#" role="button" />');b=c.children("a").bind("click."+this.widgetName,this,this._onHrefClick);switch(this.options.sortDirection){case"ascending":b.append(a('<span class="ui-icon ui-icon-triangle-1-n">ascending</span>'));break;case"descending":b.append(a('<span class="ui-icon ui-icon-triangle-1-s">descending</span>'));break}}else{a.wijmo.c1basefield.prototype._refreshHeaderCell.apply(this,arguments)}},_prepareFilterCell:function(){var h=this.options.visLeavesIdx,f=null,c=null,e,g,d=this,b;if(h>=0){f=this._owner();if(this.filterRow){c=a(new a.wijmo.wijgrid.rowAccessor().getCell(this.filterRow,h))}else{throw"exception"}this.$filterEditor=c.find("input");c.bind((a.support.selectstart?"selectstart":"mousedown"),function(i){i.stopPropagation()});e=f._parse(this.options,a.wijmo.wijgrid.filterHelper.getSingleValue(this.options.filterValue));if(e===null){switch(this.options.dataType){case"boolean":e=false;break;case"number":case"currency":case"datetime":e=0;break;default:e=""}}g={culture:f.options.culture,disabled:f.options.disabled,decimalPlaces:(function(i){var j=/^(n|p|c){1}(\d*)$/.exec(i);if(j){if(j[2]){return parseInt(j[2],10)}}return 2})(this.options.dataFormatString)};switch(b=this._getInputEditorType(this.options)){case"date":this.$filterEditor.wijinputdate(a.extend(g,{date:e,dateFormat:this.options.dataFormatString||undefined}));break;case"mask":this.$filterEditor.wijinputmask({text:e+""});break;case"numberCurrency":this.$filterEditor.wijinputnumber(a.extend(g,{type:"currency",value:e}));break;case"numberNumber":this.$filterEditor.wijinputnumber(a.extend(g,{value:e}));break;case"numberPercent":this.$filterEditor.wijinputnumber(a.extend(g,{type:"percent",value:e*100}));break;default:throw a.wijmo.wijgrid.stringFormat('Unsupported editor type: "{0}"',b)}c.find(".wijmo-wijgrid-filter-trigger").attr({role:"button","aria-haspopup":"true"}).bind("mouseenter."+this.widgetName,function(i){if(!d.options.disabled){a(this).addClass("ui-state-hover")}}).bind("mouseleave."+this.widgetName,function(i){if(!d.options.disabled){a(this).removeClass("ui-state-hover ui-state-active")}}).bind("mouseup."+this.widgetName,this,function(i){if(!d.options.disabled){a(this).removeClass("ui-state-active")}}).bind("mousedown."+this.widgetName,{column:this},this._onFilterBtnClick).bind("click."+this.widgetName,function(i){i.preventDefault()})}},_onFilterBtnClick:function(j){var f=j.data.column,h=8,i,g,k,l,m,n,d,c,b;if(f.options.disabled){return false}if(f.$dropDownFilterList){f._removeDropDownFilterList();return false}i=f._owner();g=a.wijmo.wijgrid.filterHelper.getSingleOperatorName(f.options.filterOperator).toLowerCase();k=i.filterOperatorsCache.getByDataType(f.options.dataType);i.filterOperatorsCache.sort(k,i.options.filterOperatorsSortMode);l=a.extend(true,{},{operators:k,column:f.options});i._trigger("filterOperatorsListShowing",null,l);m=[];if(l.operators){for(n in l.operators){if(l.operators.hasOwnProperty(n)){d=l.operators[n];m.push({label:d.displayName||d.name,value:d.name,selected:d.name.toLowerCase()===g})}}}f.$dropDownFilterList=a('<div class="wijmo-wijgrid-filterlist"></div').appendTo(document.body).wijlist({autoSize:true,maxItemsCount:h,selected:function(p,o){var q,e;switch(e=f._getInputEditorType(f.options)){case"date":q=f.$filterEditor.wijinputdate("option","date")||new Date();break;case"mask":q=f.$filterEditor.wijinputmask("option","text");break;case"numberCurrency":case"numberNumber":case"numberPercent":q=f.$filterEditor.wijinputnumber("option","value");if(e==="numberPercent"){q/=100}break}f._removeDropDownFilterList();i._handleFilter(f,o.item.value,q)}});f.$dropDownFilterList.wijlist("setItems",m).wijlist("renderList");c=f.$dropDownFilterList.width()|150;f.$dropDownFilterList.width(m.length>h?c+20:c).wijlist("refreshSuperPanel").position({of:a(this),my:"left top",at:"left bottom"});f.$dropDownFilterList.$button=a(this);b=f.$dropDownFilterList.eventGuid=new Date().getTime();a(document).bind("mousedown."+f.widgetName+"."+b,{column:f},f._onDocMouseDown)},_onDocMouseDown:function(f){var b=a(f.target),c=b.parents(".wijmo-wijgrid-filterlist:first"),d=b.is(".wijmo-wijgrid-filter-trigger")?b:b.parents(".wijmo-wijgrid-filter-trigger:first");if((d.length&&(d[0]===f.data.column.$dropDownFilterList.$button[0]))||(c.length&&(c[0]===f.data.column.$dropDownFilterList[0]))){}else{f.data.column._removeDropDownFilterList()}},_onHrefClick:function(b){if(b.data.options.disabled){return false}if(b.data.options.allowSort){b.data._owner()._handleSort(b.data.options,b.ctrlKey)}return false},_removeDropDownFilterList:function(){if(this.$dropDownFilterList){var b=this.$dropDownFilterList.eventGuid;this.$dropDownFilterList.remove();this.$dropDownFilterList=null;a(document).unbind("mousedown."+this.widgetName+"."+b,this._onDocMouseDown)}},_getFilterEditorWidth:function(){if(this.$filterEditor){var b=this.$filterEditor.closest(".wijmo-wijgrid-filter"),c=b.width()-b.find(".wijmo-wijgrid-filter-trigger").width();if(!c||c<0){c=0}return c}return undefined},_setFilterEditorWidth:function(b){if(this.$filterEditor){b-=this.$filterEditor.leftBorderWidth()+this.$filterEditor.rightBorderWidth();if(b<0){b=0}switch(this._getInputEditorType(this.options)){case"date":this.$filterEditor.wijinputdate("widget").width(b);break;case"mask":this.$filterEditor.wijinputmask("widget").width(b);break;case"numberCurrency":case"numberNumber":case"numberPercent":this.$filterEditor.wijinputnumber("widget").width(b);break}this.$filterEditor.setOutWidth(b)}},_getInputEditorType:function(b){switch(b.dataType){case"number":return(b.dataFormatString&&b.dataFormatString.indexOf("p")===0)?"numberPercent":"numberNumber";case"currency":return"numberCurrency";case"datetime":return"date";default:return"mask"}}})})(jQuery);(function(a){a.widget("wijmo.c1groupedfield",{_data$prefix:"c1groupedfield",options:{allowMoving:true,allowSort:true,headerText:undefined,sortDirection:"none"},_create:function(){var b=this.options.owner;this.element.addClass("wijmo-wijgrid-group-button ui-state-default ui-corner-all");this._field("owner",b);delete this.options.owner;if(this.options.disabled){this.disable()}if(b.options.allowColMoving){b._dragndrop().attach(this)}},_init:function(){this._refreshHeaderCell()},destroy:function(){this.element.find("*").unbind("."+this.widgetName);var b=this._owner();if(b){b._dragndrop().detach(this)}a.wijmo.wijgrid.remove$dataByPrefix(this.element,this._data$prefix)},_field:function(b,c){return a.wijmo.wijgrid.dataPrefix(this.element,this._data$prefix,b,c)},_removeField:function(b){var c=this._data$prefix+b;this.element.removeData(c)},_setOption:function(e,g,b){var h=this["_preset_"+e],d=this.options[e],f,c;if(h!==undefined){g=h.apply(this,[g,d,b])}f=(g!==d);a.Widget.prototype._setOption.apply(this,[e,g]);if(f){c=this["_postset_"+e];if(c!==undefined){c.apply(this,[g,d,b])}}},_postset_headerText:function(d,c,b){this._refreshHeaderCell()},_postset_allowSort:function(d,c,b){this._refreshHeaderCell()},_owner:function(){return this._field("owner")},_canSize:function(){return this.options.allowSizing&&this._owner().options.allowColSizing},_canDrag:function(){return this.options.allowMoving===true},_canDropTo:function(b){if(!(b instanceof a.wijmo.c1groupedfield)){return false}if(a.wijmo.wijgrid.isChildOf(this._owner().options.columns,b,this)){return false}return true},_canSort:function(){var b=this._owner();return(b&&b.options.allowSorting&&this.options.allowSort&&(this.options.dataIndex>=0))},_refreshHeaderCell:function(){var b=a('<span class="wijmo-wijgrid-group-button-close ui-state-default ui-corner-all"><span class="ui-icon ui-icon-close"></span></span>').bind("click."+this.widgetName,this,this._onCloseClick);this.element.html(this.options.headerText||"").prepend(b).bind("click."+this.widgetName,this,this._onHrefClick);if(this._canSort()){switch(this.options.sortDirection){case"ascending":this.element.append(a('<span class="wijmo-wijgrid-group-button-sort ui-icon ui-icon-triangle-1-n"></span>'));break;case"descending":this.element.append(a('<span class="wijmo-wijgrid-group-button-sort ui-icon ui-icon-triangle-1-s"></span>'));break}}},_onCloseClick:function(c){var b=c.data.options;if(!b.disabled){c.data._owner()._handleUngroup(c.data.options.travIdx)}return false},_onHrefClick:function(c){var d=c.data._owner(),b=c.data.options,e;if(!b.disabled&&b.allowSort){e=a.wijmo.wijgrid.search(d.columns(),function(f){return f.options.travIdx===b.travIdx});e=(!e.found)?a.wijmo.wijgrid.getColumnByTravIdx(d.options.columns,b.travIdx).found:e.found.options;if(e){d._handleSort(e,c.ctrlKey)}}return false}})})(jQuery);(function(a){a.widget("wijmo.c1band",a.wijmo.c1basefield,{options:{columns:[]},_create:function(){a.wijmo.c1basefield.prototype._create.apply(this,arguments);this.element.addClass("ui-widget wijmo-c1band")},_canDropTo:function(b){if(a.wijmo.c1basefield.prototype._canDropTo.apply(this,arguments)){return !(b instanceof a.wijmo.c1groupedfield)}return false}})})(jQuery);(function(a){a.extend(a.wijmo.wijgrid,{bandProcessor:function(){var c,e,f,h,d,g,b;this.generateSpanTable=function(i,k){c=e=g=d=0;f=[];h=[];b=[];var j=this._generateSpanTable(i,k,true);return j};this._generateSpanTable=function(k,o,m){var n,l;c=this._getVisibleHeight(k,m);o=o||[];a.wijmo.wijgrid.traverse(k,function(i){if(i.isLeaf){o.push(i)}h.push(i)});e=o.length;for(n=0;n<c;n++){f[n]=[];for(l=0;l<e;l++){f[n][l]={column:null,colSpan:0,rowSpan:0}}}this._setTableValues(k,0,0);return f};this._getVisibleHeight=function(l,m){var o,k,p,n,j=0;if(a.isArray(l)){for(o=0,k=l.length;o<k;o++){n=this._getVisibleHeight(l[o],m);j=Math.max(j,n)}}else{p=(l.visible===undefined)?true:l.visible;l.parentVis=p&&m;if(l.isBand){for(o=0,k=l.columns.length;o<k;o++){n=this._getVisibleHeight(l.columns[o],l.parentVis);j=Math.max(j,n)}if(!l.parentVis){return j}l.isLeaf=(j===0);j++}else{l.isLeaf=true;if(l.parentVis){j=1}}}return j};this._getVisibleParent=function(i){while(i){i=h[i.parentIdx];if(i&&(i.parentVis||i.parentVis===undefined)){return i}}return null};this._setTableValues=function(p,o,q){var l,n,m,k,r,j;if(a.isArray(p)){for(l=0,n=p.length;l<n;l++){this._setTableValues(p[l],o,q)}}else{if(p.travIdx===undefined){throw"undefined travIdx"}m=q+d;if(p.parentVis){k=m+g;f[o][k].column=p;b[p.travIdx]=k}if(p.isBand){for(l=0,n=p.columns.length;l<n;l++){this._setTableValues(p.columns[l],o+1,q)}}if(p.parentVis){if(d-m===0){f[o][b[p.travIdx]].rowSpan=c-o;d++}else{f[o][b[p.travIdx]].colSpan=d-m}}else{if(!p.isBand&&c>0){j=this._getVisibleParent(p);r=(j)?j.isLeaf:false;if(r){g++}if(o>=c){o=c-1}k=q+d+g;f[o][k].column=p;if(!r){if(j&&(b[j.travIdx]===k)){this._shiftTableElements(k,o)}g++}}}}};this._shiftTableElements=function(j,k){var l;for(l=0;l<k;l++){f[l][j+1]=f[l][j];f[l][j]={column:null,colSpan:0,rowSpan:0};if(f[l][j+1].column){b[f[l][j+1].column.travIdx]++}}}},getAllLeaves:function(b){var c=[];this._getAllLeaves(b,c);return c},_getAllLeaves:function(e,g){var d,c,f,b;if(e){for(d=0,c=e.length;d<c;d++){f=e[d];if(f.options){f=f.options}b=f.columns;if(b&&b.length){this._getAllLeaves(b,g)}else{g.push(f)}}}},getColumnByTravIdx:function(f,d){var e,c,g,b=null;if(f&&d>=0){for(e=0,c=f.length;e<c&&!b;e++){g=f[e];if(g.options){g=g.options}if(g.travIdx===d){return{found:g,at:f}}if(g.columns){b=this.getColumnByTravIdx(g.columns,d)}}}return b},isChildOf:function(b,e,c){if(e.options){e=e.options}if(c.options){c=c.options}if(c.isBand&&e.parentIdx>=0){if(e.parentIdx===c.travIdx){return true}if(e.parentIdx>c.travIdx){var d=this.flatten(b);while(true){e=d[e.parentIdx];if(e.travIdx===c.travIdx){return true}if(e.parentIdx===-1){break}}}}return false},getLeaves:function(b){var c=[];this._getLeaves(b,c);return c},_getLeaves:function(d,f){var c,b,e;if(d){for(c=0,b=d.length;c<b;c++){e=d[c];if(e.isLeaf){f.push(e)}if(e.columns){this._getLeaves(e.columns,f)}}}},setTraverseIndex:function(b){return this._setTraverseIndex(b,0,-1)},_setTraverseIndex:function(e,c,g){var d,b,f;if(e){for(d=0,b=e.length;d<b;d++){f=e[d];if(f.options){f=f.options}f.linearIdx=d;f.travIdx=c++;f.parentIdx=g;if(f.columns){c=this._setTraverseIndex(f.columns,c,c-1)}}}return c},flatten:function(c){var b=[];this.traverse(c,function(d){b.push(d)});return b},traverse:function(d,f){var c,b,e;if(d&&(a.isFunction(f))){for(c=0;c<d.length;c++){e=d[c];if(e.options){e=e.options}b=d.length;f(e,d);if(d.length!==b){c--;continue}if(e.columns){this.traverse(e.columns,f)}}}},getAriaHeaders:function(d,h){var f,c,e,g,b=[];for(f=0,c=d.length;f<c;f++){e=d[f];g="";do{g+=escape(e.headerText)+" "}while((e=h[e.parentIdx]));b[f]=a.trim(g)}return b}})})(jQuery);(function(a){a.extend(a.wijmo.wijgrid,{getTableSection:function(b,c){if(b&&!b.nodeType){b=b[0]}if(b){switch(c){case 1:return b.tHead;case 2:if(b.tBodies){return b.tBodies[0]||null}break;case 3:return b.tFoot;default:return b}}return null},getTableSectionLength:function(b,c){if(b&&!b.nodeType){b=b[0]}return(b&&(c=this.getTableSection(b,c)))?c.rows.length:0},getTableSectionRow:function(b,c,d){if(b&&!b.nodeType){b=b[0]}return(b&&(c=this.getTableSection(b,c)))?c.rows[d]||null:null},readTableSection:function(i,g,e){var f,h,l,b,k,c,j=[],d=function(m){m=m.toLowerCase();return m==="rowspan"||m==="colspan"};if(i&&!i.nodeType){i=i[0]}if(i&&(g=this.getTableSection(i,g))){for(f=0,h=g.rows.length;f<h;f++){k=g.rows[f];c=[];if(e){c.rowAttributes=null;c.cellsAttributes=[]}for(l=0,b=k.cells.length;l<b;l++){c[l]=a.trim(k.cells[l].innerHTML);if(e){c.cellsAttributes[l]=a.wijmo.wijgrid.getAttributes(k.cells[l],d)}}j[f]=c}}return j}})})(jQuery);(function($){$.extend($.wijmo.wijgrid,{dataMode:{dom:1,statical:2,remoteStatical:4,dynamical:8},dataStore:function(wijgrid){var _dataSource=null,_self=this,_isLoaded=false,_clonedItems=null,_attributes=null,_transformedData,_parsed=false,_transformed=false;this.dataMode=function(){return _dataMode()};this.dataSource=function(){return _dataSource};this.getFieldNames=function(){if(!_isLoaded){throw"data is not loaded yet"}var result=[],key,firstItem;if(_dataSource.items&&_dataSource.items.length){firstItem=_dataSource.items[0]}else{if((_dataMode()===$.wijmo.wijgrid.dataMode.dom)&&_dataSource.header&&_dataSource.header.length){firstItem=_dataSource.header[0]}}if(firstItem){$.each(firstItem,function(key,val){result.push((!isNaN(key))?parseInt(key,10):key)})}return result};this.getDataSlice=function(){if(!_isLoaded){throw"data is not loaded yet"}if(!_parsed){_parsed=true;_parseData(_clonedItems)}if(!_transformed){_transformed=true;if(_dataMode()!==$.wijmo.wijgrid.dataMode.dynamical){_transformedData=_transform(_clonedItems,_dataSource.emptyData)}else{_transformedData={data:_clonedItems,totalRows:_dataSource.data.totalRows,totals:_dataSource.data.totals||{},emptyData:_dataSource.emptyData}}}return _transformedData};this.load=function(userData){if(!_dataSource){_dataSource=$.proxy(_createDataSource,this)(wijgrid)}if(_dataMode()===$.wijmo.wijgrid.dataMode.dynamical){userData.data=_prepareRequest();if(_dataSource.proxy){_dataSource.proxy.options.data=$.extend(_dataSource.proxy.options.data,userData.data)}_attributes=null;_dataSource.load(userData,true)}else{if(!_isLoaded){_attributes=null;_dataSource.load(userData)}else{_dataLoading(_dataSource,userData);_dataLoaded(_dataSource,userData)}}};this.isLoaded=function(){return _isLoaded};this.updateValue=function(originalRowIndex,dataKey,newValue){if(!_isLoaded){throw"data is not loaded yet"}this.dataSource().items[originalRowIndex][dataKey]=newValue};function _createDataSource(grid){var dataSource=null,gridData=grid.options.data,oldError;if(gridData===null){dataSource=new wijdatasource({data:grid.element,reader:new _dataReaderWrapper(new _domTableDataReader()),loading:$.proxy(_dataLoading,this),loaded:$.proxy(_dataLoaded,this)})}else{if($.isArray(gridData)){dataSource=new wijdatasource({data:gridData,reader:new _dataReaderWrapper(new wijarrayreader()),loading:$.proxy(_dataLoading,this),loaded:$.proxy(_dataLoaded,this)})}else{dataSource=new wijdatasource(gridData);dataSource.reader=new _dataReaderWrapper(gridData.reader);dataSource.loading=$.proxy(function(ds,data){if($.isFunction(gridData.loading)){gridData.loading(ds,data)}$.proxy(_dataLoading,this)(ds,data)},this);dataSource.loaded=$.proxy(function(ds,data){if($.isFunction(gridData.loaded)){gridData.loaded(ds,data)}$.proxy(_dataLoaded,this)(ds,data)},this);if(dataSource.proxy&&dataSource.proxy.options){oldError=dataSource.proxy.options.error;dataSource.proxy.options.error=function(){_error.apply(this,arguments);if($.isFunction(oldError)){oldError.apply(this,arguments)}}}}}return dataSource}function _dataLoading(wijDataSource,userData){if(_self.dataMode()===$.wijmo.wijgrid.dataMode.dynamical||wijgrid.options.alwaysParseData){_parsed=false}_transformed=false;_transformedData=null;_clonedItems=null;wijgrid._dataLoading(userData)}function _dataLoaded(wijDataSource,userData){_isLoaded=true;var i,len,item,dataKey,dataValue,tmp,mode=_dataMode(),readAttributes=(!_attributes&&wijgrid.options.readAttributesFromData);if(!_attributes){_attributes=[]}_clonedItems=[];for(i=0,len=wijDataSource.items.length;i<len;i++){item=wijDataSource.items[i];if(readAttributes){if(mode===$.wijmo.wijgrid.dataMode.dom){_attributes.push({rowAttributes:item.rowAttributes,cellsAttributes:item.cellsAttributes});delete item.rowAttributes;delete item.cellsAttributes}else{tmp={};for(dataKey in item){if(item.hasOwnProperty(dataKey)&&$.isArray(dataValue=item[dataKey])){tmp[dataKey]=dataValue[1];item[dataKey]=dataValue[0]}}_attributes.push({rowAttributes:{},cellsAttributes:tmp})}}_clonedItems.push({values:item,originalRowIndex:i,attributes:_attributes[i]})}wijgrid._dataLoaded(userData)}function _error(){wijgrid._ajaxError.apply(wijgrid,arguments)}function _dataMode(){if(!_dataSource.data||_dataSource.data.jquery){return $.wijmo.wijgrid.dataMode.dom}if(_dataSource.dynamic===true){return $.wijmo.wijgrid.dataMode.dynamical}return $.wijmo.wijgrid.dataMode.statical}function _parseData(data){if(data&&data.length){var dataLeaves=[],dataLen,ri,len,dataRow,di,value,dataLeaf;$.wijmo.wijgrid.traverse(wijgrid.options.columns,function(column){if($.wijmo.wijgrid.validDataKey(column.dataKey)){dataLeaves.push(column)}});dataLen=Math.min(dataLeaves.length,_self.getFieldNames().length);for(ri=0,len=data.length;ri<len;ri++){dataRow=data[ri];for(di=0;di<dataLen;di++){value=null;dataLeaf=dataLeaves[di];if(dataLeaf&&dataLeaf.dataParser){value=wijgrid._parse(dataLeaf,dataRow.values[dataLeaf.dataKey]);dataRow.values[dataLeaf.dataKey]=value}}}}}function _transform(data,emptyData){if(data&&data.length){var filterRequest=wijgrid._prepareFilterRequest(true),pageRequest=wijgrid._preparePageRequest(true),sortRequest=wijgrid._prepareSortRequest(true),totalsRequest=wijgrid._prepareTotalsRequest(true),result=new $.wijmo.wijgrid.dataHelper().getDataSlice(wijgrid,data,filterRequest,pageRequest,sortRequest,totalsRequest);return result}return{data:[],totalRows:0,totals:{},emptyData:emptyData}}function _prepareRequest(){var result={filtering:wijgrid._prepareFilterRequest(false),paging:wijgrid._preparePageRequest(false),sorting:wijgrid._prepareSortRequest(false),totals:wijgrid._prepareTotalsRequest(false)};return result}function _dataReaderWrapper(dataReader){this.read=function(dataSource){dataSource.items=null;if(dataReader&&$.isFunction(dataReader.read)){dataReader.read(dataSource)}if(!$.isArray(dataSource.items)){dataSource.items=[];if($.isArray(dataSource.data)){dataSource.items=dataSource.data}else{if(dataSource.data&&$.isArray(dataSource.data.rows)){dataSource.items=dataSource.data.rows}}}if(_dataMode()===$.wijmo.wijgrid.dataMode.dynamical){if(!dataSource.data||isNaN(dataSource.data.totalRows)){throw"totalRows value is missing"}}if(!dataSource.items||!$.isArray(dataSource.items)){dataSource.items=[]}}}function _domTableDataReader(){this.read=function(wijDataSource){wijDataSource.items=[];if(wijDataSource&&wijDataSource.data&&wijDataSource.data.length){if($.wijmo.wijgrid.getTableSectionLength(wijDataSource.data,2)===1&&$($.wijmo.wijgrid.getTableSectionRow(wijDataSource.data,2,0)).hasClass("wijmo-wijgrid-emptydatarow")){wijDataSource.emptyData=$.wijmo.wijgrid.readTableSection(wijDataSource.data,2)}else{wijDataSource.items=$.wijmo.wijgrid.readTableSection(wijDataSource.data,2,wijgrid.options.readAttributesFromData)}wijDataSource.header=$.wijmo.wijgrid.readTableSection(wijDataSource.data,1);wijDataSource.data=null}else{throw"invalid data source"}}}},dataHelper:function(){this.getDataSlice=function(gridView,dataCache,filterRequest,pageRequest,sortRequest,totalsRequest){dataCache=_applyFiltering(dataCache,filterRequest,gridView);$.proxy(_applySort,this)(dataCache,sortRequest);var totalRows=dataCache.length,start,end,pagedData,i,j,len,pageCount,totals={};totals=_getTotals(dataCache,totalsRequest,gridView);if(pageRequest){pageCount=Math.ceil(totalRows/pageRequest.pageSize)||1;if(pageRequest.pageIndex>=pageCount){pageRequest.pageIndex=pageCount-1}start=Math.min(dataCache.length-1,pageRequest.pageIndex*pageRequest.pageSize);if(start<0){start=0}end=Math.min(dataCache.length,start+pageRequest.pageSize);pagedData=[];for(i=start,len=0,j=0;i<end;i++,j++){pagedData[j]=dataCache[i]}dataCache=pagedData}return{data:dataCache,totalRows:totalRows,totals:totals}};function _getTotals(data,totalsRequest,gridView){var i,len,j,len2,dataItemValues,tallies=[],result={};for(i=0,len=totalsRequest.length;i<len;i++){tallies.push(new $.wijmo.wijgrid.tally())}for(i=0,len=data.length;i<len;i++){dataItemValues=data[i].values;for(j=0,len2=tallies.length;j<len2;j++){tallies[j].add(dataItemValues[totalsRequest[j].column.dataKey])}}for(i=0,len=tallies.length;i<len;i++){result[totalsRequest[i].column.dataKey]=tallies[i].getValueString(totalsRequest[i].column)}return result}function _applyFiltering(data,filterRequest,gridView){if(!data||!data.length||!filterRequest||!filterRequest.length){return data}$.each(filterRequest,function(i,item){if(!$.isArray(item.filterOperator)){item.filterOperator=[item.filterOperator]}if(!$.isArray(item.filterValue)){item.filterValue=[item.filterValue]}$.each(item.filterOperator,function(i,fop){if(typeof(fop)==="string"){item.filterOperator[i]=fop={name:fop,condition:"or"}}item.filterOperator[i].name=gridView.filterOperatorsCache.getByName(fop.name)});$.each(item.filterValue,function(i,value){if(!$.isArray(value)){item.filterValue[i]=gridView._parse(item.column,value)}else{$.each(value,function(j,subValue){value[j]=gridView._parse(item.column,subValue)})}})});var i,j,k,dataLen,dataRow,dataValue,dataRes=[],flag,subFlag,filterReqLen=filterRequest.length,currentReq,filterOp,filterVal;for(i=0,dataLen=data.length;i<dataLen;i++){dataRow=data[i];flag=true;for(j=0;j<filterReqLen;j++){currentReq=filterRequest[j];dataValue=dataRow.values[currentReq.column.dataKey];subFlag=false;for(k=0;k<currentReq.filterOperator.length;k++){filterOp=currentReq.filterOperator[k];filterVal=currentReq.filterValue[k];if((k>0)&&(filterOp.condition==="and")){subFlag&=filterOp.name.operator(dataValue,filterVal)}else{subFlag|=filterOp.name.operator(dataValue,filterVal)}}flag&=subFlag}if(flag){dataRes.push(dataRow)}}return dataRes}function _applySort(data,sortRequest){if(sortRequest.length){var builder=[],i,len,arg,si,dataKey,idx;builder.push("var context = this;");builder.push("this.sort = function(a, b)\n{\n");for(i=0,len=sortRequest.length;i<len;i++){arg="arg"+i;si=sortRequest[i];dataKey=(typeof(si.dataKey)==="string")?'"'+si.dataKey+'"':si.dataKey;if(si.sortDirection==="ascending"||si.sortDirection==="descending"){if(si.sortDirection==="ascending"){builder.push("var ",arg," = context._sortAsc","(a.values[",dataKey,"], b.values[",dataKey,"]);\n")}else{builder.push("var ",arg," = context._sortDesc","(a.values[",dataKey,"], b.values[",dataKey,"]);\n")}}else{builder.push("var ",arg," = context._sortDigitAsc","(a.originalRowIndex, b.originalRowIndex);\n")}builder.push("if (",arg," === 0)\n");builder.push("{\n")}idx=sortRequest.length-1;if(idx>=0){arg="arg"+idx;si=sortRequest[idx];dataKey=(typeof(si.dataKey)==="string")?'"'+si.dataKey+'"':si.dataKey;if((si.sortDirection==="ascending")||(si.sortDirection==="descending")){if(si.sortDirection==="ascending"){builder.push("var ",arg," = context._sortDigitAsc","(a.originalRowIndex, b.originalRowIndex);\n")}else{builder.push("var ",arg," = context._sortDigitDesc","(a.originalRowIndex, b.originalRowIndex);\n")}}}for(i=sortRequest.length-1;i>=0;i--){builder.push("}\n");arg="arg"+i;builder.push("return ",arg,";\n")}builder.push("}");eval(builder.join(""));data.sort(this.sort)}}this._sortAsc=function(a,b){if(a instanceof Date){a=a.getTime()}if(b instanceof Date){b=b.getTime()}if(a===b){return 0}if(a===null){return -1}if(b===null){return 1}return(a<b)?-1:1};this._sortDesc=function(a,b){if(a instanceof Date){a=a.getTime()}if(b instanceof Date){b=b.getTime()}if(a===b){return 0}if(a===null){return 1}if(b===null){return -1}return(a<b)?1:-1};this._sortDigitAsc=function(a,b){return a-b};this._sortDigitDesc=function(a,b){return b-a}}})})(jQuery);(function(a){a.extend(a.wijmo.wijgrid,{groupRange:function(g,d,f,e,j){this.value=-1;this.isExpanded=false;this.cr=new a.wijmo.wijgrid.cellRange(-1,-1);this.sum=-1;this.position="none";this.hasHeaderOrFooter=true;if(g!==undefined){this.isExpanded=g}if(d!==undefined){this.cr=d}if(f!==undefined){this.sum=f}if(e!==undefined){this.position=e}if(j!==undefined){this.hasHeaderOrFooter=j}this.isSubRange=function(k){return((this.cr.r1>=k.cr.r1)&&(this.cr.r2<=k.cr.r2))};this.toString=function(){return this.cr.r1+"-"+this.cr.r2};this._getHeaderImageClass=function(k){var l=this.owner;if(l){return k?l.expandedImageClass||a.wijmo.c1field.prototype.options.groupInfo.expandedImageClass:l.collapsedImageClass||a.wijmo.c1field.prototype.options.groupInfo.collapsedImageClass}return null};this.collapse=function(){var m,n,l,p,o,k;if((m=this.owner)&&(n=m.owner)&&(l=n.owner)){p=new a.wijmo.wijgrid.groupHelper();o=l._field("leaves");if(p.isParentExpanded(o,this.cr,m.level)){if((m.position!=="footer")&&(m.outlineMode!=="none")){k=p.getGroupedColumnsCount(o);h(p,l._rows(),o,this,k)}}}};this.expand=function(o){var m,n,l,q,p,k;if((m=this.owner)&&(n=m.owner)&&(l=n.owner)){q=new a.wijmo.wijgrid.groupHelper();p=l._field("leaves");if(q.isParentExpanded(p,this.cr,m.level)){k=q.getGroupedColumnsCount(p);c(q,l._rows(),p,this,k,o,true)}}};function h(k,n,t,u,v){var l=u.owner,o=u.cr.r1,w=u.cr.r2,r,s,q,m,p;switch(l.position){case"header":case"headerAndFooter":i(n.item(u.cr.r1),undefined,false);o++;break}for(r=o;r<=w;r++){i(n.item(r),false)}u.isExpanded=false;b(n,u);for(r=l.level+1;r<=v;r++){q=k.getChildGroupRanges(t,u.cr,r-1);for(p=0,s=q.length;p<s;p++){m=q[p];m.isExpanded=false;switch(m.owner.position){case"header":case"headerAndFooter":i(n.item(m.cr.r1),undefined,false);break}b(n,m)}}}function c(l,q,u,w,x,k,o){var m=w.owner,p=w.cr.r1,y=w.cr.r2,s,t,r,n,v;switch(m.position){case"header":i(q.item(p),true,o||k);p++;break;case"footer":i(q.item(y),true);y--;break;case"headerAndFooter":i(q.item(p),true,o||k);if(o){i(q.item(y),true)}p++;y--;break}if(o){w.isExpanded=true;b(q,w)}else{return}if(w.owner.level===x){for(s=p;s<=y;s++){i(q.item(s),true)}}else{r=l.getChildGroupRanges(u,w.cr,w.owner.level);if(r.length&&(p!==r[0].cr.r1)){for(s=p;s<r[0].cr.r1;s++){i(q.item(s),true)}}if(k){for(s=0,t=r.length;s<t;s++){n=r[s];c(l,q,u,n,x,k,true)}}else{for(s=0,t=r.length;s<t;s++){n=r[s];v=(n.owner.position==="footer"||n.owner.outlineMode==="none")?true:false;c(l,q,u,n,x,false,v)}}}}function i(l,m,k){if(l){if(l[0]){if(m!==undefined){l[0].style.display=m?"":"none";l[0]["aria-hidden"]=m?"false":"true"}if(k!==undefined){l[0]["aria-expanded"]=k?"true":false}}if(l[1]){if(m!==undefined){l[1].style.display=m?"":"none";l[1]["aria-hidden"]=m?"false":"true"}if(k!==undefined){l[1]["aria-expanded"]=k?"true":false}}}}function b(l,m){if(m.owner.position!=="footer"){var n=null,k=l.item(m.cr.r1);if(k){if(k[0]){n=a(k[0]).find("div.wijmo-wijgrid-grouptogglebtn:first-child")}}if(n&&n.length){n.toggleClass(m._getHeaderImageClass(!m.isExpanded),false);n.toggleClass(m._getHeaderImageClass(m.isExpanded),true)}}}},grouper:function(){this.group=function(c,f,h){this._grid=c;this._data=f;this._leaves=h;this._groupRowIdx=0;this._groupHelper=new a.wijmo.wijgrid.groupHelper();var d=1,g,j,l,k=[],e=false,b=0;for(g=0,j=h.length;g<j;g++){l=h[g];if(l.groupInfo){delete l.groupInfo.level;delete l.groupInfo.expandInfo}if(l.groupInfo&&(l.groupInfo.position&&(l.groupInfo.position!=="none"))&&(l.dataIndex>=0)){if(l.groupedIndex===undefined){e=true}}else{if(l.groupedIndex!==undefined){delete l.groupedIndex}}}if(e){for(g=0,j=h.length;g<j;g++){l=h[g];if(l.groupInfo&&(l.groupInfo.position&&(l.groupInfo.position!=="none"))&&(l.dataIndex>=0)){l.groupedIndex=b++;k.push(l)}}}else{k=a.map(h,function(m,i){return m.groupedIndex!==undefined?m:null});k.sort(function(m,i){return m.groupedIndex-i.groupedIndex});a.each(k,function(i,m){m.groupedIndex=i})}c._field("groupedColumns",k);for(g=0,j=k.length;g<j;g++){l=k[g];this._groupRowIdx=0;if(l.groupInfo&&(l.groupInfo.position&&(l.groupInfo.position!=="none"))&&(l.dataIndex>=0)){l.groupInfo.level=d;l.groupInfo.expandInfo=[];this._processRowGroup(l,d++)}}delete this._grid;delete this._data;delete this._leaves};this._processRowGroup=function(k,c){var p,j,b,h,d,l,e,g,m,f,n=0,o=true;a.each(this._leaves,function(r,q){if(q.parentVis){n=r;return false}});for(p=0;p<this._data.length;p++){if(!(this._data[p].rowType&a.wijmo.wijgrid.rowType.data)){continue}j=this._getGroupCellRange(p,k,c);b=true;h=(k.groupInfo.outlineMode==="startCollapsed");if(h||this._groupHelper.isParentCollapsed(this._leaves,j,c)){if((k.groupInfo.groupSingleRow===false)&&(j.r1===j.r2)){continue}b=false}if(c&&this._grid.options.groupIndent){for(d=j.r1;d<=j.r2;d++){this._addIndent(this._data[d][n],c)}}o=!(k.groupInfo.groupSingleRow===false&&(j.r1===j.r2));switch(k.groupInfo.position){case"header":l=this._addGroupRange(k.groupInfo,j,b,o);for(f=j.r1;f<=j.r2;f++){this._data[f].__attr["aria-level"]=c+1;if(!b){this._data[f].__style.display="none";this._data[f].__attr["aria-hidden"]=true}}if(!o){break}this._updateByGroupRange(l,c);e=this._groupHelper.isParentCollapsed(this._leaves,l.cr,c);g=this._buildGroupRow(l,j,true,e);this._data.splice(j.r1,0,g);g.__attr["arial-level"]=c;g.__attr["aria-expanded"]=b;if(e){g.__style.display="none";g.__attr["aria-hidden"]=true}p=j.r2+1;break;case"footer":l=this._addGroupRange(k.groupInfo,j,true,o);if(!o){break}this._updateByGroupRange(l,c);m=this._buildGroupRow(l,j,false,false);m.__attr["aria-level"]=c;this._data.splice(j.r2+1,0,m);p=j.r2+1;e=this._groupHelper.isParentCollapsed(this._leaves,l.cr,c);if(e){m.__style.display="none";m.__attr["aria-hidden"]=true}break;case"headerAndFooter":l=this._addGroupRange(k.groupInfo,j,b,o);for(f=j.r1;f<=j.r2;f++){this._data[f].__attr["aria-level"]=c+1;if(!b){this._data[f].__style.display="none";this._data[f].__attr["aria-hidden"]=true}}if(!o){break}this._updateByGroupRange(l,c);e=this._groupHelper.isParentCollapsed(this._leaves,l.cr,c);g=this._buildGroupRow(l,j,true,e);m=this._buildGroupRow(l,j,false,false);this._data.splice(j.r2+1,0,m);m.__attr["aria-level"]=c;if(e||!b){m.__style.display="none";m.__attr["aria-hidden"]=true}this._data.splice(j.r1,0,g);g.__attr["aria-level"]=c;g.__attr["aria-expanded"]=b;if(e){g.__style.display="none";g.__attr["aria-hidden"]=true}p=j.r2+2;break;default:throw a.wijmo.wijgrid.stringFormat('Unknown Position value: "{0}"',k.groupInfo.position)}this._groupRowIdx++}};this._buildGroupRow=function(j,n,d,q){var h=j.owner,p=h.owner,i=p.owner,f=[],g="",m="",s,b,r,c,o,e,l,k;f.__style={};f.__attr={};f.__attr.id=((d)?"GH":"GF")+this._groupRowIdx+"-"+h.level;f.rowType=(d)?a.wijmo.wijgrid.rowType.groupHeader:a.wijmo.wijgrid.rowType.groupFooter;if((p.dataIndex>=0)&&((s=this._data[n.r1][p.dataIndex].value)!==null)){g=i._toStr(p,s)}if(this._grid.options.showRowHeader){f.push({html:"&nbsp;"})}b={html:"",__attr:{},__style:{}};if(d&&h.outlineMode!=="none"){if(j.isExpanded){b.html='<div class="ui-icon '+j._getHeaderImageClass(true)+' wijmo-wijgrid-grouptogglebtn">&nbsp;</div>'}else{b.html='<div class="ui-icon '+j._getHeaderImageClass(false)+' wijmo-wijgrid-grouptogglebtn">&nbsp;</div>'}}f.push(b);if(p.aggregate&&(p.aggregate!=="none")){m=this._getAggregate(n,p,p,d,g)}r=(d)?h.headerText:h.footerText;if(r==="custom"){c={data:this._data,column:p,groupByColumn:h.owner,groupText:g,text:"",groupingStart:n.r1,groupingEnd:n.r2,isGroupHeader:d,aggregate:m};if(this._grid._trigger("groupText",null,c)){r=c.text}}else{if((r===undefined)||(r===null)){if(d){r="{1}: {0}"}if(m||(m===0)){r=r?r+" {2}":"{2}"}}r=a.wijmo.wijgrid.stringFormat(r,g,p&&p.headerText?p.headerText:"",m.toString())}if(!r){r="&nbsp;"}b.html+="<span>"+r+"</span>";this._addIndent(b,h.level-1);o=1;e=(this._grid.options.showRowHeader)?1:0;l=true;for(;e<this._leaves.length;e++){s=this._leaves[e];if(s.parentVis){if(l){l=false;continue}if((s.dynamic!==true)&&s.aggregate&&(s.aggregate!=="none")){break}o++}}for(;e<this._leaves.length;e++){s=this._leaves[e];if(s.parentVis){k=this._getAggregate(n,s,h.owner,d,g);if(!k&&(k!==0)){k="&nbsp;"}f.push({html:k.toString(),__attr:{groupInfo:{leafIndex:s.leavesIdx,purpose:a.wijmo.wijgrid.groupRowCellPurpose.aggregateCell}}})}}b.__attr.colSpan=o;b.__attr.groupInfo={leafIndex:p.leavesIdx,purpose:a.wijmo.wijgrid.groupRowCellPurpose.groupCell};return f};this._getAggregate=function(f,e,c,i,h){var b="",g,d,j;if(!e.aggregate||(e.aggregate==="none")){return b}if(e.aggregate==="custom"){g={data:this._data,column:e,groupByColumn:c,groupText:h,text:"",groupingStart:f.r1,groupingEnd:f.r2,isGroupHeader:i};if(this._grid._trigger("groupAggregate",null,g)){b=g.text}}else{d=new a.wijmo.wijgrid.tally();for(j=f.r1;j<=f.r2;j++){d.add(this._data[j][e.dataIndex].value)}b=d.getValueString(e)}return b};this._getGroupCellRange=function(j,f,b){var i=f.leavesIdx,d=new a.wijmo.wijgrid.cellRange(j,i),c=this._groupHelper.getParentGroupRange(this._leaves,d,b),h,g,e;if(this._data[j].rowType&a.wijmo.wijgrid.rowType.data){h=this._data[j][f.dataIndex].value;if(h instanceof Date){h=h.getTime()}for(d.r2=j,e=this._data.length-1;d.r2<e;d.r2++){if(!(this._data[d.r2+1].rowType&a.wijmo.wijgrid.rowType.data)||(c&&(d.r2+1>c.r2))){break}g=this._data[d.r2+1][f.dataIndex].value;if(g instanceof Date){g=g.getTime()}if(h!==g){break}}}return d};this._addGroupRange=function(d,h,b,j){var k=null,i=this._groupHelper.getChildGroupIndex(h,d.expandInfo),g,c,f,e;if(i>=0&&i<d.expandInfo.length){k=d.expandInfo[i]}else{g=new a.wijmo.wijgrid.cellRange(h.r1,h.r1,h.r2,h.r2);c=(d.position==="footer"||!j)?true:b&&(d.outlineMode!=="startCollapsed");k=new a.wijmo.wijgrid.groupRange(c,g,-1,d.position,j);k.owner=d;d.expandInfo.push(k)}if(k&&j){f=h.r1;e=h.r2;if(d.position==="headerAndFooter"){e+=2}if(d.position!=="headerAndFooter"){e++}k.cr.r2=e}return k};this._updateByGroupRange=function(h,b){var f,g,c,d,e,l,k;for(f=0,g=this._leaves.length;f<g;f++){c=this._leaves[f].groupInfo;if(c&&(c.level<b)){d=(c.expandInfo)?c.expandInfo.length:0;for(e=0;e<d;e++){l=c.expandInfo[e];k=(h.position==="headerAndFooter")?2:1;if(l.cr.r1>=h.cr.r1&&!((l.cr.r1===h.cr.r1)&&(l.position==="footer"))){l.cr.r1+=k}if(l.cr.r2>=h.cr.r1){l.cr.r2+=k}}}}};this._addIndent=function(c,d){var b;if(d>0&&(b=this._grid.options.groupIndent)){c.__style.paddingLeft=(b*d)+"px"}}}})})(jQuery);(function(a){a.extend(a.wijmo.wijgrid,{_getGroupInfoRegExp:/.*G([HF]){1}(\d+)-(\d+)$/,groupHelper:function(){this.getGroupInfo=function(c){if(c){var e=a.wijmo.wijgrid._getGroupInfoRegExp.exec(c.id),f,b,d;if(e){f=parseInt(e[3],10);b=parseInt(e[2],10);d=(e[1]==="H");return{level:f,index:b,isHeader:d,toString:function(){return(this.isHeader?"GH":"GF")+this.index+"-"+this.level}}}}return null};this.getColumnByGroupLevel=function(f,e){var d,b,c;for(d=0,b=f.length;d<b;d++){c=f[d];if(c.groupInfo&&(c.groupInfo.level===e)){return c}}return null};this.getGroupedColumnsCount=function(f){var c=0,e,b,d;for(e=0,b=f.length;e<b;e++){d=f[e].groupInfo;if(d&&(d.position==="header"||d.position==="headerAndFooter"||d.position==="footer")){c++}}return c};this.getChildGroupIndex=function(c,b){var g=0,d=b.length-1,e,f;while(g<=d){e=((d-g)>>1)+g;f=b[e].cr.r1-c.r1;if(f===0){return e}if(f<0){g=e+1}else{d=e-1}}return g};this.getParentGroupIndex=function(c,d){var b=this.getChildGroupIndex(c,d);if(b>0){b--}return(b<d.length)?b:-1};this.getChildGroupRanges=function(f,h,b){var l=[],d,c,e,g,j,k=this.getColumnByGroupLevel(f,b+1);if(k){d=k.groupInfo.expandInfo;j=this.getChildGroupIndex(h,d);for(e=j,g=d.length;e<g;e++){c=d[e];if(c.cr.r2<=h.r2){l.push(c)}else{break}}}return l};this.getParentGroupRange=function(g,c,f){var e,d,b;if(f===undefined){f=65535}if(f-2>=0){for(e=g.length-1;e>=0;e--){d=g[e].groupInfo;if(!d||!d.expandInfo||(d.level<0)||(d.level!==f-1)){continue}b=this.getParentGroupIndex(c,d.expandInfo);if(b>=0){return d.expandInfo[b]}}}return null};this.isParentCollapsed=function(f,b,e){var c,d;if(e===1){return false}for(c=e;c>1;c--){d=this.getParentGroupRange(f,b,c);if(d&&!d.isExpanded){return true}b=d.cr}return false};this.isParentExpanded=function(f,b,e){var c,d;if(e===1){return true}for(c=e;c>1;c--){d=this.getParentGroupRange(f,b,c);if(d&&d.isExpanded){return true}b=d.cr}return false}}})})(jQuery);(function(a){a.extend(a.wijmo.wijgrid,{cellRange:function(d,e,b,c){switch(arguments.length){case 2:this.r1=this.r2=d;this.c1=this.c2=e;break;case 4:this.r1=d;this.r2=b;this.c1=e;this.c2=c;break;default:this.r1=0;this.r2=0;this.c1=0;this.c2=0}this.isSingleCell=function(){return((this.r1===this.r2)&&(this.c1===this.c2))}},merger:function(){this.merge=function(f,c){this.leaves=c;this.data=f;var e,b,d;for(e=0,b=c.length;e<b;e++){d=c[e];if((d.dataIndex>=0)&&!d.isBand&&(d.rowMerge==="free"||d.rowMerge==="restricted")){this.mergeColumn(d)}}delete this.data;delete this.leaves};this.mergeColumn=function(g){var f=g.dataIndex,d,b,c,e,h;for(d=0,b=this.data.length;d<b;d++){if(!(this.data[d].rowType&a.wijmo.wijgrid.rowType.data)){continue}c=this.getCellRange(d,g);if(c.r1!==c.r2){e=c.r2-c.r1+1;this.data[c.r1][f].__attr.rowSpan=e;for(h=c.r1+1;h<=c.r2;h++){this.data[h][f].visible=false}}d=c.r2}};this.getCellRange=function(c,f){var e=f.dataIndex,h=new a.wijmo.wijgrid.cellRange(c,e),j=(this.data[c][e].value||"").toString(),d=this.data.length,b,i,g,k;for(h.r2=c;h.r2<d-1;h.r2++){b=this.data[h.r2+1];if(!(b.rowType&a.wijmo.wijgrid.rowType.data)||((b[e].value||"").toString()!==j)){break}}i=f.leavesIdx;if(i>0&&f.rowMerge==="restricted"){g=this.leaves[i-1];if(g.dataIndex>=0){k=this.getCellRange(c,g);h.r1=Math.max(h.r1,k.r1);h.r2=Math.min(h.r2,k.r2)}}return h}}})})(jQuery);(function(a){a.extend(a.wijmo.wijgrid,{rowType:{header:1,data:2,dataAlt:4,filter:8,groupHeader:16,groupFooter:32,footer:64,emptyDataRow:128,fooRow:65536},renderState:{none:0,rendering:1,current:2,hovered:4,selected:8},groupRowCellPurpose:{groupCell:0,aggregateCell:1},stringFormat:function(d,e){var c,b;if(!d){return""}for(c=1,b=arguments.length;c<b;c++){d=d.replace(new RegExp("\\{"+(c-1)+"\\}","gm"),arguments[c])}return d},validDataKey:function(b){return(b&&!(b<0))||(b===0)},iterateChildrenWidgets:function(b,c){if(b&&c){if(b.nodeType){b=a(b)}b.find(".ui-widget").each(function(d,e){a.each(a(e).data(),function(g,f){if(f.widgetName){c(d,f)}})})}},remove$dataByPrefix:function(b,c){var d=[];a.each(b.data(),function(e){if(e.indexOf(c)===0){d.push(e)}});a.each(d,function(e,f){b.removeData(f)})},domSelection:function(b){this.getSelection=function(){var e=0,c=0,d;if(b.selectionStart!==undefined){e=b.selectionStart;c=b.selectionEnd}else{if(document.selection){d=document.selection.createRange().duplicate();c=d.text.length;e=Math.abs(d.moveStart("character",-b.value.length));c+=e}}return{start:e,end:c,length:c-e}};this.setSelection=function(c){if(b.selectionStart!==undefined){b.setSelectionRange(c.start,c.end)}else{var d=b.createTextRange();d.collapse(true);d.moveStart("character",c.start);d.moveEnd("character",c.end);d.select()}};this.toggleSelection=function(c){if(c){a(b).enableSelection().css({MozUserSelect:"",WebkitUserSelect:""})}else{a(b).disableSelection().css({MozUserSelect:"-moz-none",WebkitUserSelect:"none"})}}},createDynamicField:function(b){return a.extend(true,{},a.wijmo.c1basefield.prototype.options,a.wijmo.c1field.prototype.options,{dynamic:true,isLeaf:true,isBand:false,parentIdx:-1},b)},bounds:function(d,c){if(d){var b=d.nodeType?a(d):d,e=b.offset();if(e){if(c){return{top:e.top,left:e.left,width:b[0].clientWidth||0,height:b[0].clientHeight||0}}return{top:e.top,left:e.left,width:b.outerWidth(),height:b.outerHeight()}}}return null},_getDOMText:function(f,c,e){if(e===undefined){e=0}if(f&&(!c||(c&&e<3))){if(f.nodeType===3){return f.nodeValue}else{if(f.nodeType===1){switch(f.type){case"button":case"text":case"textarea":case"select-one":return f.value;case"checkbox":return f.checked.toString()}var b="",d;for(d=0;f.childNodes[d];d++){b+=this._getDOMText(f.childNodes[d],c,e+1)}return b}}}return""},rowTypeFromCss:function(b){var c=/wijmo-wijgrid-(\S+)row/.exec(b.attr("class"));if(c){switch(c[1]){case"header":return a.wijmo.wijgrid.rowType.header;case"filter":return a.wijmo.wijgrid.rowType.filter;case"data":if(b.hasClass("wijmo-wijgrid-alternatingrow")){return a.wijmo.wijgrid.rowType.data|a.wijmo.wijgrid.rowType.dataAlt}return a.wijmo.wijgrid.rowType.data;case"alternating":return a.wijmo.wijgrid.rowType.data|a.wijmo.wijgrid.rowType.dataAlt;case"groupheader":return a.wijmo.wijgrid.rowType.groupHeader;case"groupfooter":return a.wijmo.wijgrid.rowType.groupFooter}}},dataPrefix:function(d,h,b,k){var g=(d.jquery||a.isArray(d)),e,j,f,c=h+b;if(arguments.length===3){if(g){return a.data(d[0],c)}return a.data(d,c)}else{if(g){for(e=0,j=d.length;e<j;e++){f=a.data(d[e],c,k)}return f}return a.data(d,c,k)}},shallowMerge:function(e,f){if(f&&e){var b,d,c;for(b in f){if(f.hasOwnProperty(b)){d=f[b];c=typeof(d);if((c==="string"||c==="boolean"||c==="number")&&(e[b]===undefined)){e[b]=d}}}}},isCustomObject:function(b){return(b&&(typeof(b)==="object")&&!(b instanceof Date))},search:function(d,f){var b,e,c=a.isFunction(f);for(b in d){if(d.hasOwnProperty(b)){e=c?f(d[b]):(d[b]===f);if(e===true){return{at:b,found:d[b]}}}}return{at:null,found:null}},getAttributes:function(j,d){if(j){var g,c,f=0,b={},h,e;for(g=0,c=j.attributes.length;g<c;g++){e=j.attributes[g].name;if(e&&(!d||!d(e))){h=j.getAttribute(e);if(e==="style"){h=(typeof(h)==="object")?h.cssText:h}if(!h&&e==="class"){h=j.getAttribute("className")}if(h&&(typeof(h)!=="function")){b[e]=h;f++}}}if(f){return b}}return null}})})(jQuery);(function(a){a.extend(a.wijmo.wijgrid,{embeddedParsers:{stringParser:{parseDOM:function(e,d,f,c,b){return this.parse(a.wijmo.wijgrid._getDOMText(e,true),d,f,c,b)},parse:function(e,d,f,c,b){switch(e){case null:return null;case c:if(b){return null}case undefined:case"&nbsp;":return"";default:return""+e}},toStr:function(e,d,f,c,b){if(e===null&&b){return c}return""+e}},numberParser:{parseDOM:function(e,d,f,c,b){return this.parse(a.wijmo.wijgrid._getDOMText(e,true),d,f,c,b)},parse:function(f,d,g,c,b){var e=typeof(f);if(e==="number"){return isNaN(f)?NaN:f}if((!f&&f!==0)||(f==="&nbsp;")||(f===c&&b)){return null}return Globalize.parseFloat(f,10,d.name)},toStr:function(e,d,f,c,b){if(e===null&&b){return c}return Globalize.format(e,f||"n",d.name)}},currencyParser:{parseDOM:function(e,d,f,c,b){return this.parse(a.wijmo.wijgrid._getDOMText(e,true),d,f,c,b)},parse:function(f,d,g,c,b){var e=typeof(f);if(e==="number"){return isNaN(f)?NaN:f}if((!f&&f!==0)||(f==="&nbsp;")||(f===c&&b)){return null}if(e==="string"){f=f.replace(d.numberFormat.currency.symbol,"")}return Globalize.parseFloat(f,10,d.name)},toStr:function(e,d,f,c,b){if(e===null&&b){return c}return Globalize.format(e,f||"c",d.name)}},dateTimeParser:{parseDOM:function(e,d,f,c,b){return this.parse(a.wijmo.wijgrid._getDOMText(e,true),d,f,c,b)},parse:function(g,d,h,c,b){var e,f;if(g instanceof Date){return g}if(!g||(g==="&nbsp;")||(g===c&&b)){return null}e=/^\/Date\((\d+)\)\/$/.exec(g);if(e){return new Date(parseInt(e[1],10))}f=Globalize.parseDate(g,h,d.name);if(f==null||isNaN(f)){f=Date.parse(g);f=isNaN(f)?NaN:new Date(f)}return f},toStr:function(e,d,f,c,b){if(e===null&&b){return c}return Globalize.format(e,f||"d",d.name)}},boolParser:{parseDOM:function(e,d,f,c,b){return this.parse(a.wijmo.wijgrid._getDOMText(e,true),d,f,c,b)},parse:function(e,d,f,c,b){var g=typeof(e);if(g==="boolean"){return e}if(g==="string"){e=a.trim(e)}if(!e||(e==="&nbsp;")||(e===c&&b)){return null}switch(e.toLowerCase()){case"true":return true;case"false":return false}return NaN},toStr:function(e,d,f,c,b){if(e===null&&b){return c}return(e)?"true":"false"}}}})})(jQuery);(function(a){a.extend(a.wijmo.wijgrid,{filterOperatorsCache:function(){var d={};this.add=function(f){if(f&&f.name&&f.operator){var g=f.name.toLowerCase();if(!d[g]){d[g]=f}}};this.clear=function(){d.length=0};this.getByName=function(f){return d[f.toLowerCase()]};this.getByDataType=function(h){var f=[],i,g;for(i in d){if(d.hasOwnProperty(i)){g=d[i];if(a.inArray(h,g.applicableTo)>=0){f.push(g)}}}return f};this.removeCustom=function(){var f;for(f in d){if(d[f].custom){delete d[f]}}};this.sort=function(g,f){switch(f.toLowerCase()){case"alphabetical":g.sort(b);break;case"alphabeticalcustomfirst":g.sort(c);break;case"alphabeticalembeddedFirst":g.sort(e);break;case"none":break;default:break}return g};function b(g,f){var i=g.name.toLowerCase(),h=f.name.toLowerCase();if(i!==h){if(i==="nofilter"){return -1}if(h==="nofilter"){return 1}}if(i===h){return 0}return(i<h)?-1:1}function e(g,f){var i=g.name.toLowerCase(),h=f.name.toLowerCase();if(i!==h){if(i==="nofilter"){return -1}if(h==="nofilter"){return 1}}if(g.custom!==f.custom){if(g.custom){return 1}if(f.custom){return -1}}if(i===h){return 0}return(i<h)?-1:1}function c(g,f){var i=g.name.toLowerCase(),h=f.name.toLowerCase();if(i!==h){if(i==="nofilter"){return -1}if(h==="nofilter"){return 1}}if(g.custom!==f.custom){if(g.custom){return -1}if(f.custom){return 1}}if(i===h){return 0}return(i<h)?-1:1}}});a.wijmo.wijgrid.embeddedFiltersImpl={_anyCmp:function(d,h,f){var e,b,g,c=false;if(!a.isArray(h)){h=[h]}if(!(b=h.length)){return false}if(d instanceof Date){d=d.getTime()}if(typeof(d)==="string"){d=d.toLowerCase()}for(e=0;(e<b)&&!c;e++){g=h[e];if(g instanceof Date){g=g.getTime()}if(typeof(g)==="string"){g=g.toLowerCase()}c=f(d,g)}return c}};a.wijmo.wijgrid.embeddedFilters={nofilter:{name:"NoFilter",arity:1,applicableTo:["string","number","datetime","currency","boolean"],operator:function(b){return true}},contains:{name:"Contains",arity:2,applicableTo:["string"],operator:function(b,c){return a.wijmo.wijgrid.embeddedFiltersImpl._anyCmp(b,c,function(d,e){return(d===e)||(d?d.indexOf(e)>=0:false)})}},notcontain:{name:"NotContain",arity:2,applicableTo:["string"],operator:function(b,c){return !a.wijmo.wijgrid.embeddedFilters.contains.operator(b,c)}},beginswith:{name:"BeginsWith",arity:2,applicableTo:["string"],operator:function(b,c){return a.wijmo.wijgrid.embeddedFiltersImpl._anyCmp(b,c,function(d,e){return(d===e)||(d?d.indexOf(e)===0:false)})}},endswith:{name:"EndsWith",arity:2,applicableTo:["string"],operator:function(b,c){return a.wijmo.wijgrid.embeddedFiltersImpl._anyCmp(b,c,function(f,g){var e=(f===g),d;if(!e&&f){d=f.lastIndexOf(g);if(d>=0){e=(f.length-d===g.length)}}return e})}},equals:{name:"Equals",arity:2,applicableTo:["string","number","datetime","currency","boolean"],operator:function(b,c){return a.wijmo.wijgrid.embeddedFiltersImpl._anyCmp(b,c,function(d,e){return(d===e)})}},notequal:{name:"NotEqual",arity:2,applicableTo:["string","number","datetime","currency","boolean"],operator:function(b,c){return a.wijmo.wijgrid.embeddedFiltersImpl._anyCmp(b,c,function(d,e){return(d!==e)})}},greater:{name:"Greater",arity:2,applicableTo:["string","number","datetime","currency","boolean"],operator:function(b,c){return a.wijmo.wijgrid.embeddedFiltersImpl._anyCmp(b,c,function(d,e){return(d>e)})}},less:{name:"Less",arity:2,applicableTo:["string","number","datetime","currency","boolean"],operator:function(b,c){return a.wijmo.wijgrid.embeddedFiltersImpl._anyCmp(b,c,function(d,e){return(d<e)})}},greaterorequal:{name:"GreaterOrEqual",arity:2,applicableTo:["string","number","datetime","currency","boolean"],operator:function(b,c){return a.wijmo.wijgrid.embeddedFiltersImpl._anyCmp(b,c,function(d,e){return(d>=e)})}},lessorequal:{name:"LessOrEqual",arity:2,applicableTo:["string","number","datetime","currency","boolean"],operator:function(b,c){return a.wijmo.wijgrid.embeddedFiltersImpl._anyCmp(b,c,function(d,e){return(d<=e)})}},isempty:{name:"IsEmpty",arity:1,applicableTo:["string"],operator:function(b){return a.wijmo.wijgrid.embeddedFiltersImpl._anyCmp(b,undefined,function(c){return !c&&c!==0&&c!==false})}},notisempty:{name:"NotIsEmpty",arity:1,applicableTo:["string"],operator:function(b){return a.wijmo.wijgrid.embeddedFiltersImpl._anyCmp(b,undefined,function(c){return !!c||c===0||c===false})}},isnull:{name:"IsNull",arity:1,applicableTo:["string","number","datetime","currency","boolean"],operator:function(b){return a.wijmo.wijgrid.embeddedFiltersImpl._anyCmp(b,undefined,function(c){return c===null})}},notisnull:{name:"NotIsNull",arity:1,applicableTo:["string","number","datetime","currency","boolean"],operator:function(b){return a.wijmo.wijgrid.embeddedFiltersImpl._anyCmp(b,undefined,function(c){return c!==null})}}}})(jQuery);(function(a){a.extend(a.wijmo.wijgrid,{filterHelper:{getSingleValue:function(b){if(a.isArray(b)){b=b[0];if(a.isArray(b)){b=b[0]}}return b},getSingleOperatorName:function(b){if(a.isArray(b)){b=b[0]}return b.name||b||""},verify:function(d,j,f,e){if(d){if(a.isArray(d)){var g,c,h=[],b=[];if(!a.isArray(j)){j=[j]}for(g=0,c=d.length;g<c;g++){if(this._verifySingleOp(d[g],j[g],f,e)){h.push({name:d[g].name||d[g],condition:d[g].condition||"or"});b.push(j?j[g]:undefined)}}if(h.length){return{filterOperator:h,filterValue:b}}}else{if(this._verifySingleOp(d,j,f,e)){return{filterOperator:d,filterValue:j}}}}return null},_verifySingleOp:function(b,f,d,c){if(b&&(b=(b.name||b))){var e;b=(b||"").toLowerCase();if(b!=="nofilter"&&(e=c.getByName(b))){if(a.inArray(d||"string",e.applicableTo)>=0){if(e.arity===1||(e.arity>1&&this.getSingleValue(f)!==undefined)){return true}}}}return false}}})})(jQuery);(function(a){a.extend(a.wijmo.wijgrid,{htmlTableAccessor:function(e,h,d,i){var g=[],c=0,f=e;function b(){var q=[],l,o,s,u,n,t,k,r,p,m;for(o=0,s=f.rows.length;o<s;o++){l=[];g[o]=l;u=f.rows[o];for(n=0,t=0,k=u.cells.length;n<k;n++,t++){r=u.cells[n];for(;q[t]>1;t++){q[t]--;l[t]={cellIdx:-1,colIdx:-1}}if(!(q[t]>1)){q[t]=r.rowSpan}l[t]={cellIdx:n,colIdx:-1};l[n].colIdx=t;p=r.colSpan;for(;p>1;p--){l[++t]={cellIdx:-1,colIdx:-1}}}m=q.length;for(;t<m;t++){q[t]--;l[t]={cellIdx:-1,colIdx:-1}}c=Math.max(c,m)}}this.element=function(){return e};this.width=function(){return c};this.getCellIdx=function(k,j){return(k<c)?g[j][k].cellIdx:-1};this.getColumnIdx=function(k,j){if(typeof(k)!=="number"){var l=k;k=l.cellIndex;j=l.parentNode.rowIndex}return(k<c)?g[j][k].colIdx:-1};this.getSectionLength=function(j){return a.wijmo.wijgrid.getTableSectionLength(f,j)};this.getSectionRow=function(k,j){return a.wijmo.wijgrid.getTableSectionRow(f,j,k)};this.forEachColumnCellNatural=function(m,p,o){var k,l,n,j;for(k=0,l=f.rows.length;k<l;k++){n=f.rows[k];if(m<n.cells.length){j=p(n.cells[m],m,o);if(j!==true){return j}}}return true};this.forEachColumnCell=function(n,q,p){var k,m,o,l,j;for(k=0,m=g.length;k<m;k++){o=f.rows[k];l=this.getCellIdx(n,k);if(l>=0){j=q(o.cells[l],k,p);if(j!==true){return j}}}return true};this.forEachRowCell=function(p,o,n){var m=f.rows[p],k,l,j;for(k=0,l=m.cells.length;k<l;k++){j=o(m.cells[k],k,n);if(j!==true){return j}}return true};this.colGroupTag=function(){var j=f.getElementsByTagName("colgroup");return(j&&j[0])||null};this.colTags=function(){var j=this.colGroupTag();return(j&&j.getElementsByTagName("col"))||[]};this.ensureTBody=function(){return(f.tBodies&&f.tBodies[0])||f.appendChild(document.createElement("tbody"))};this.ensureTHead=function(){return(f.tHead&&f.tHead[0])||f.createTHead()};this.ensureTFoot=function(){return(f.tFoot&&f.tFoot[0])||f.createTFoot()};this.ensureColGroup=function(){var j=f.getElementsByTagName("colgroup");return(j&&j[0])||f.appendChild(document.createElement("colgroup"))};this.appendCol=function(k){var j=this.ensureColGroup();return(k&&j.appendChild(k))||j.appendChild(document.createElement("col"))};if(i){this.ensureColGroup()}if(d){this.ensureTBody()}if(!h){b()}}})})(jQuery);(function(a){a.wijmo.wijgrid.cellInfo=function(c,e){var b=false,d=null;this.cellIndex=function(f){if(arguments.length===0){return c}c=f};this.column=function(){if(d&&this._isValid()){var f=d._getDataToAbsOffset();return d._field("visibleLeaves")[c+f.x]}return null};this.container=function(){var g=this.tableCell(),f;if(g){f=a(g).children("div.wijmo-wijgrid-innercell");if(f){return f}}return null};this.isEqual=function(f){return(f&&(f.rowIndex()===e)&&(f.cellIndex()===c))};this.row=function(){var f=this._row();if(f!==null){f=d._view()._getRowInfo(f);return f}return null};this.rowIndex=function(f){if(arguments.length===0){return e}e=f};this.tableCell=function(){if(d&&this._isValid()){var f=d._getDataToAbsOffset();return d._view().getCell(c+f.x,e+f.y)}return null};this.value=function(g){var f,h;if(d&&this._isValid()){h=d._view()._getRowInfo(d._rows().item(e));if(h.type&a.wijmo.wijgrid.rowType.data){f=this.column();if(arguments.length===0){return h.data[f.dataKey]}else{g=d._parse(f,g);if((g===null&&f.valueRequired)||(f.dataType&&f.dataType!=="string"&&isNaN(g))){throw"invalid value"}d._dataStore.updateValue(h.dataItemIndex,f.dataKey,g)}}}};this.toString=function(){return c+":"+e};this._absToData=function(f){c-=f.x;e-=f.y;return this};this._clip=function(g){var f=false,h;if(c<(h=g.topLeft().cellIndex())){f=true;c=h}if(c>(h=g.bottomRight().cellIndex())){f=true;c=h}if(e<(h=g.topLeft().rowIndex())){f=true;e=h}if(e>(h=g.bottomRight().rowIndex())){f=true;e=h}return f};this._clone=function(){return new a.wijmo.wijgrid.cellInfo(c,e)};this._dataToAbs=function(f){c+=f.x;e+=f.y;return this};this._row=function(){if(d&&this._isValid()){return d._rows().item(e)}return null};this._isValid=function(){return c>=0&&e>=0};this._isEdit=function(f){if(!arguments.length){return b}b=f};this._setGridView=function(f){d=f}};a.wijmo.wijgrid.cellInfo.prototype.outsideValue=new a.wijmo.wijgrid.cellInfo(-1,-1);a.wijmo.wijgrid.cellInfoRange=function(e,d){if(!e||!d){throw"invalid arguments"}var c=e._clone(),b=d._clone();this.bottomRight=function(){return b};this.isEqual=function(f){return(f&&c.isEqual(f.topLeft())&&b.isEqual(f.bottomRight()))};this.topLeft=function(){return c};this.toString=function(){return c.toString()+" - "+b.toString()};this._isIntersect=function(h){var g,f,j,i;if(h){g=h.bottomRight().rowIndex()-h.topLeft().rowIndex()+1;f=b.rowIndex()-c.rowIndex()+1;if((h.topLeft().rowIndex()+g)-c.rowIndex()<g+f){j=h.bottomRight().cellIndex()-h.topLeft().cellIndex()+1;i=b.cellIndex()-c.cellIndex()+1;return((h.topLeft().cellIndex()+j)-c.cellIndex()<j+i)}}return false};this._isValid=function(){return c._isValid()&&b._isValid()};this._clip=function(f){return c._clip(f)|b._clip(f)};this._clone=function(){return new a.wijmo.wijgrid.cellInfoRange(c._clone(),b._clone())};this._containsCellInfo=function(f){return(f&&f.cellIndex()>=c.cellIndex()&&f.cellIndex()<=b.cellIndex()&&f.rowIndex()>=c.rowIndex()&&f.rowIndex()<=b.rowIndex())};this._containsCellRange=function(f){return(f&&this._containsCellInfo(f.topLeft())&&this._containsCellInfo(f.bottomRight()))};this._extend=function(g,f){if(g===1){c.rowIndex(f.topLeft().rowIndex());b.rowIndex(f.bottomRight().rowIndex())}else{if(g===2){c.cellIndex(f.topLeft().cellIndex());b.cellIndex(f.bottomRight().cellIndex())}}return this};this._normalize=function(){var g=c.cellIndex(),i=c.rowIndex(),f=b.cellIndex(),h=b.rowIndex();c.cellIndex(Math.min(g,f));c.rowIndex(Math.min(i,h));b.cellIndex(Math.max(g,f));b.rowIndex(Math.max(i,h))}}})(jQuery);(function(a){a.extend(a.wijmo.wijgrid,{classFactory:function(d,g){var j="#fake#",f=(/xyz/.test(function(){xyz}))?/\b_base\b/:/.*/,e=d?d.prototype:function(){},c=d?new d(j):new e(),h,b,i;for(h in g){if(g.hasOwnProperty(h)){b=g[h];if(e&&(typeof(b)==="function")&&(typeof(e[h])==="function")&&f.test(b)){c[h]=(function(k,l){return function(){var n=this._base,m;this._base=e[k];m=l.apply(this,arguments);if(n!==undefined){this._base=n}else{delete this._base}return m}})(h,b)}else{c[h]=b}}}i=function(k){if((k!==j)&&this.ctor){this.ctor.apply(this,arguments)}};i.prototype=c;i.constructor=c;return i}})})(jQuery);(function(a){a.wijmo.wijgrid.baseView=a.wijmo.wijgrid.classFactory(null,{ctor:function(b){if(!b){throw"'wijgrid' must be specified"}this._rowHeaderSize=22;this._wijgrid=b;this._wijgrid.element.addClass("wijmo-wijgrid-table");this._bodyRowsAccessor=null;this._headerRowsAccessor=null;this._rowsAccessor=null},dispose:function(){this.toggleDOMSelection(true);this._wijgrid.element.removeClass("wijmo-wijgrid-table")},ensureDisabledState:function(){var c=this._wijgrid.widgetBaseClass+"-disabled ui-state-disabled",b=this._wijgrid.options.disabled;a.each(this.subTables(),function(e,f){if(f){var d=a(f.element());if(b){d.addClass(c).attr("aria-disabled",true)}else{d.removeClass(c).attr("aria-disabled",false)}}})},ensureWidth:function(c,d,b){this._setColumnWidth(c,d)},ensureHeight:function(b){},getVisibleAreaBounds:function(){throw"not implemented"},getFixedAreaVisibleBounds:function(){throw"not implemented"},render:function(){this._preRender();this._renderContent();this._postRender()},toggleDOMSelection:function(b){a.each(this.subTables(),function(c,d){(new a.wijmo.wijgrid.domSelection(d.element())).toggleSelection(b)});(new a.wijmo.wijgrid.domSelection(this._wijgrid.outerDiv)).toggleSelection(b)},updateSplits:function(b){throw"not implemented"},bodyRows:function(){if(!this._bodyRowsAccessor){this._bodyRowsAccessor=new a.wijmo.wijgrid.rowAccessor(this,2,0,0)}return this._bodyRowsAccessor},filterRow:function(){if(this._wijgrid.options.showFilter){var b=new a.wijmo.wijgrid.rowAccessor(this,1,0,0);return b.item(b.length()-1)}return null},headerRows:function(){var b;if(!this._headerRowsAccessor){b=this._wijgrid.options.showFilter?1:0;this._headerRowsAccessor=new a.wijmo.wijgrid.rowAccessor(this,1,0,b)}return this._headerRowsAccessor},rows:function(){if(!this._rowsAccessor){this._rowsAccessor=new a.wijmo.wijgrid.rowAccessor(this,0,0,0)}return this._rowsAccessor},focusableElement:function(){throw"not implemented"},forEachColumnCell:function(b,d,c){throw"not implemented"},forEachRowCell:function(d,c,b){throw"not implemented"},getAbsoluteCellInfo:function(b){throw"not implemented"},getAbsoluteRowIndex:function(b){throw"not implemented"},getCell:function(c,b){throw"not implemented"},getColumnIndex:function(b){throw"not implemented"},getHeaderCell:function(b){throw"not implemented"},getJoinedCols:function(b){throw"not implemented"},getJoinedRows:function(c,b){throw"not implemented"},getJoinedTables:function(b,c){throw"not implemented"},subTables:function(){throw"not implemented"},_getMappedScrollMode:function(){var d=this._wijgrid.options.scrollMode,b="auto",c="auto";switch(d){case"horizontal":b="hidden";c="visible";break;case"vertical":b="visible";c="hidden";break;case"both":b="visible";c="visible";break}return{vScrollBarVisibility:b,hScrollBarVisibility:c}},_postRender:function(){this.toggleDOMSelection(this._wijgrid.options.selectionMode==="none");this.ensureDisabledState()},_preRender:function(){throw"not implemented"},_renderContent:function(){this._renderCOLS();this._renderHeader();if(this._wijgrid.options.showFilter){this._renderFilter()}this._renderBody();if(this._wijgrid.options.showFooter){this._renderFooter()}},_renderCOLS:function(){var c=this._wijgrid._field("visibleLeaves"),d,f,e,b;for(e=0,b=c.length;e<b;e++){d=c[e];f=this._createCol(d,e);this._appendCol(f,d,e)}},_renderHeader:function(){var c=a.wijmo.wijgrid.rowType,d=this._wijgrid._field("columnHeadersTable"),e,b,f;if(d&&(b=d.length)){for(e=0;e<b;e++){f=this._insertEmptyRow(c.header,e,-1,-1,-1);this._renderRow(f,null,d[e])}}},_renderFilter:function(){var b=this._insertEmptyRow(a.wijmo.wijgrid.rowType.filter,-1,-1,-1,-1);this._renderRow(b,this._wijgrid._field("visibleLeaves"),null)},_renderBody:function(){var e=a.wijmo.wijgrid.rowType,j=this._wijgrid._field("visibleLeaves"),k=this._wijgrid.sketchTable,d=-1,l=0,g,h,c,f,b;if(this._wijgrid._dataStore.dataMode()===a.wijmo.wijgrid.dataMode.dynamical){l=this._wijgrid.options.pageIndex*this._wijgrid.options.pageSize}for(g=0,h=k.length;g<h;g++){f=k[g];b=(f.rowType&e.data)!==0;c=this._insertEmptyRow(f.rowType,g,b?++d:-1,b?f.originalRowIndex:-1,b?l+f.originalRowIndex:-1);this._renderRow(c,j,f)}},_renderFooter:function(){var b=this._insertEmptyRow(a.wijmo.wijgrid.rowType.footer,-1,-1,-1,-1);this._renderRow(b,this._wijgrid._field("visibleLeaves"),null)},_insertEmptyRow:function(h,b,c,e,g){var d=this._wijgrid._onViewInsertEmptyRow.apply(this._wijgrid,arguments),f=this._insertRow(h,b,d);return this._createRowInfo(f,h,a.wijmo.wijgrid.renderState.rendering,b,c,e,g)},_createEmptyCell:function(e,b,d){var c=a.wijmo.wijgrid.rowType,f=this._wijgrid._onViewCreateEmptyCell.apply(this._wijgrid,arguments);return this._createCell(e.type,f)},_insertRow:function(d,b,c){throw"not implemented"},_createCell:function(c,d){var b=a.wijmo.wijgrid.rowType;if(!d){d=(c===b.header)?"<th />":"<td />"}if(c!==b.filter){return a(d).wrapInner('<div class="wijmo-wijgrid-innercell"></div>')}return a(d)},_appendCell:function(d,b,c){throw"not implemented"},_createCol:function(c,b){throw"not implemented"},_appendCol:function(d,c,b){throw"not implemented"},_renderRow:function(g,d,f){var c=a.wijmo.wijgrid.rowType,b,e;switch(g.type){case c.filter:this._renderFilterRow(g,d);break;case c.footer:this._renderFooterRow(g,d);break;case c.header:this._renderHeaderRow(g,f);break;case c.data:case c.data|c.dataAlt:this._renderDataRow(g,d,f);b=f.__attr;e=f.__style;break;case c.emptyDataRow:case c.groupHeader:case c.groupFooter:this._renderSpannedRow(g,d,f);b=f.__attr;e=f.__style;break;default:throw"unknown rowType"}this._rowRendered(g,b,e)},_renderCell:function(b,g,i,f,d,e,c){var h=this._createEmptyCell(b,d.dataIndex,d),j=(b.type===a.wijmo.wijgrid.rowType.filter)?h:h.children("div");this._appendCell(b,g,h);if(f){j.html(i)}else{this._wijgrid.cellFormatter.format(j,d,i,b)}this._cellRendered(b,h,g,d,e,c)},_renderDataRow:function(b,l,d){var e,f,g,k,m,j,c,h=false;for(e=0,f=l.length;e<f;e++){g=l[e];k=g.dataIndex;m=null;if(k>=0&&(!d[k]||(d[k].visible===false))){continue}if(g.dataParser){m=(k>=0)?this._wijgrid._toStr(g,d[k].value):null}else{if(k>=0){m=d[k].html;h=true}}j=(k>=0)?d[k].__attr:null;c=(k>=0)?d[k].__style:null;this._renderCell(b,e,m,h,g,j,c)}},_renderFilterRow:function(f,c){var e,b,d;for(e=0,b=c.length;e<b;e++){d=c[e];this._renderCell(f,e,a.wijmo.wijgrid.filterHelper.getSingleValue(d.filterValue),false,d)}},_renderFooterRow:function(e,c){var d,b;for(d=0,b=c.length;d<b;d++){this._renderCell(e,d,"",false,c[d])}},_renderHeaderRow:function(g,e){var c,b,f=0,d;for(c=0,b=e.length;c<b;c++){d=e[c];if(d.column&&d.column.parentVis){d.column.thX=f++;d.column.thY=g.sectionRowIndex;this._renderCell(g,c,d.column.headerText,false,d.column,{colSpan:d.colSpan,rowSpan:d.rowSpan})}}},_renderSpannedRow:function(f,c,g){var e,d,b=Math.min(c.length,g.length);for(e=0;e<b;e++){this._renderCell(f,e,g[e].html,true,c[e],g[e].__attr,g[e].__style)}},_cellRendered:function(g,f,d,c,b,e){this._wijgrid.cellStyleFormatter.format(f,d,c,g,a.wijmo.wijgrid.renderState.rendering,b,e);this._changeCellRenderState(f,a.wijmo.wijgrid.renderState.rendering,false);this._wijgrid._onViewCellRendered(g,f,d,c)},_rowRendered:function(d,b,c){this._wijgrid.rowStyleFormatter.format(d,b,c);d.state&=~a.wijmo.wijgrid.renderState.rendering;this._setRowInfo(d.$rows,d);this._wijgrid._onViewRowRendered(d)},_isBodyRow:function(d){var b=a.wijmo.wijgrid.rowType,c=b.type;return((c&b.data)||(c===b.groupHeader)||(c===b.groupFooter)||(c===b.emptyDataRow))},_changeRowRenderState:function(c,b,d){if(d){c.state|=b}else{c.state&=~b}this._setRowInfo(c.$rows,c)},_changeCellRenderState:function(g,c,f){var e=a.wijmo.wijgrid.dataPrefix,b=this._wijgrid._data$prefix,d=e(g,b,"renderState");if(f){c=d|c;e(g,b,"renderState",c)}else{c=d&~c;e(g,b,"renderState",c)}return c},_adjustWidthArray:function(d,l,j,f,n){var m=this._sumWidthArray(d),e=this._sumWidthArray(l),k=[],h,i=0,c,b,g=true;if(m<=j){a.extend(true,k,d);if(m===j||f){return k}else{h=j-m}}else{a.extend(true,k,l);if(e>=j){return k}else{h=j-e}}a.each(k,function(o,p){if(!p.real){i++}});if(i!==0){if(n!==undefined&&(n>-1&&n<k.length)&&!k[n].real){k[n].width+=h;return k}c=Math.floor(h/i);b=h-c*i;a.each(k,function(o,p){if(!p.real){p.width+=c;if(g){p.width+=b;g=false}}})}return k},_getColumnWidth:function(g,k){var h,d,b,l,n,e,o,q,m,p,c,f;if(k){h=this._wijgrid._field("visibleLeaves")[g];if(h._realWidth!==undefined){d={width:h._realWidth,real:true}}else{if(h.isRowHeader){d={width:this._rowHeaderSize,real:true}}else{b=0;l=this.getJoinedTables(true,g);n=l[2];for(e=0;e<2;e++){o=l[e];if(o!==null){q=o.element().rows;if(f=q.length){for(c=f-1,p=null;c>=0;c--){if(q[c].cells.length===o.width()){p=q[c];break}}if(p){m=p.cells[n];b=Math.max(b,a(m).outerWidth())}}}}d={width:b,real:false}}}k.push(d)}},_setColumnWidth:function(b,c){var d=this.getHeaderCell(b),e=this.getJoinedCols(b);if(c){a(d).setOutWidth(c);a.each(e,function(f,g){a(g).setOutWidth(c)})}},_setTableWidth:function(d,b,g,c){var f,e;a.each(d,function(h,i){i.css("table-layout","fixed").setOutWidth(b)});f=d[0].outerWidth();e=f-b;if(e!==0){this._setColumnWidth(c,g-e)}},_sumWidthArray:function(e,d,c){var b=0;a.each(e,function(f,g){if(d!==undefined&&c!==undefined&&(f<d||f>c)){return true}b+=g.width});return b},_setRowInfo:function(g,f){var c="$rows" in f,b="data" in f,e,d;if(c){e=f.$rows;delete f.$rows}if(b){d=f.data;delete f.data}a.wijmo.wijgrid.dataPrefix(g,this._wijgrid._data$prefix,"rowInfo",f);if(c){f.$rows=e}if(b){f.data=d}},_getRowInfo:function(c){var e=this._wijgrid,b=c[1]?a(c):a(c[0]),f=a.wijmo.wijgrid.dataPrefix(b,e._data$prefix,"rowInfo"),d;f.$rows=b;if((f.dataItemIndex>=0)&&(f.type&a.wijmo.wijgrid.rowType.data)){f.data=e._getDataItem(f.dataItemIndex)}return f},_createRowInfo:function(j,h,d,f,e,b,i){var g,c={type:h,state:d,sectionRowIndex:f,dataRowIndex:e,dataItemIndex:b,virtualDataItemIndex:i,$rows:a(j)};if((b>=0)&&(h&a.wijmo.wijgrid.rowType.data)){c.data=this._wijgrid._getDataItem(b)}return c}})})(jQuery);(function(a){a.wijmo.wijgrid.flatView=a.wijmo.wijgrid.classFactory(a.wijmo.wijgrid.baseView,{ctor:function(b){this._base(b);this._dataTable=null;this._contentArea=null},ensureWidth:function(e,f,d){var c=a(this._dataTable.element()),b=c.width()+f-d;this._base(e,f,d);this._setTableWidth([c],b,f,e)},getVisibleAreaBounds:function(){var b=a.wijmo.wijgrid.bounds(this._dataTable.element()),c;if(this._wijgrid.options.scrollMode==="none"){return b}else{c=a.wijmo.wijgrid.bounds(this._wijgrid.outerDiv.find(".wijmo-wijgrid-split-area-se:first")[0]);return{top:b.top,left:b.left,width:Math.min(c.width,b.width),height:Math.min(c.height,b.height)}}},updateSplits:function(d){var m=this,h=this._wijgrid,c=h.options,f=h.element,b=[],j=[],e=[],i=h._field("visibleLeaves"),k=h.outerDiv,l,g;f.css({"table-layout":"",width:""});a.each(i,function(p,o){var q,n=o.width;if(n||(n===0)){q=((typeof(n)==="string")&&(n.length>1)&&(n[n.length-1]==="%"));if(q){n=k.width()*parseFloat(n)/100}else{n=parseFloat(n)}if(o.ensurePxWidth||(o.ensurePxWidth===undefined&&c.ensureColumnsPxWidth)){o._realWidth=n}m._setColumnWidth(p,n)}});a.each(i,function(o,n){m._getColumnWidth(o,b)});f.css("width","1px");a.each(i,function(o,n){m._getColumnWidth(o,j)});l=k.innerWidth();e=this._adjustWidthArray(b,j,l,c.ensureColumnsPxWidth,c.autoExpandColumnIndex);a.each(e,function(o,p){var n=i[o];if(n._realWidth!==undefined){delete n._realWidth;return}m._setColumnWidth(o,p.width)});g=e.length-1;if(g!==-1){this._setTableWidth([f],this._sumWidthArray(e,0,g),e[g].width,g)}},focusableElement:function(){return a(this._dataTable.element())},forEachColumnCell:function(b,d,c){return this._dataTable.forEachColumnCell(b,d,c)},forEachRowCell:function(d,c,b){return this._dataTable.forEachRowCell(d,c,b)},getAbsoluteCellInfo:function(b){return new a.wijmo.wijgrid.cellInfo(this.getColumnIndex(b),b.parentNode.rowIndex)},getAbsoluteRowIndex:function(b){return b.rowIndex},getCell:function(e,d){var c=this._dataTable.getCellIdx(e,d),b;if(c>=0){b=this.getJoinedRows(d,0);if(b[0]){return b[0].cells[c]}}return null},getColumnIndex:function(b){return this._dataTable.getColumnIdx(b)},getHeaderCell:function(d){var b=this._wijgrid._field("visibleLeaves")[d],c;if(b&&(c=this._wijgrid._headerRows())){return new a.wijmo.wijgrid.rowAccessor().getCell(c.item(b.thY),b.thX)}return null},getJoinedCols:function(b){var c=a(this._dataTable.element()).find("> colgroup");if(c.length){if(b<c[0].childNodes.length){return[c[0].childNodes[b],null]}}return[null,null]},getJoinedRows:function(c,b){return[this._dataTable.getSectionRow(c,b),null]},getJoinedTables:function(b,c){return[this._dataTable,null,c]},subTables:function(){return[this._dataTable]},_preRender:function(){this._dataTable=new a.wijmo.wijgrid.htmlTableAccessor(this._wijgrid.element[0],true,true,true)},_postRender:function(){this._wijgrid.element.find("> tbody").addClass("ui-widget-content wijmo-wijgrid-data");this._dataTable=new a.wijmo.wijgrid.htmlTableAccessor(this._wijgrid.element[0]);this._wijgrid.element.attr({role:"grid",cellpadding:"0",border:"0",cellspacing:"0"}).css("border-collapse","separate");this._base()},_insertRow:function(f,c,d){var b=a.wijmo.wijgrid.rowType,e;switch(f){case b.header:case b.filter:e=this._dataTable.ensureTHead();break;case b.footer:e=this._dataTable.ensureTFoot();break;default:e=this._dataTable.ensureTBody()}if(d){return[e.appendChild(d)]}else{if(c>e.rows.length){c=-1}return[e.insertRow(c)]}},_rowRendered:function(e,b,c){var d=e.$rows[0];if(!d.cells.length&&this._isBodyRow(e)){d.parentNode.removeChild(d)}else{this._base(e,b,c)}},_appendCell:function(d,b,c){d.$rows.append(c)},_createCol:function(c,b){return document.createElement("col")},_appendCol:function(d,c,b){this._dataTable.appendCol(d)}})})(jQuery);(function(a){a.wijmo.wijgrid.fixedView=a.wijmo.wijgrid.classFactory(a.wijmo.wijgrid.baseView,{ctor:function(b){this._base(b);this._verScrollBarSize=18;this._mouseWheelHandler=a.proxy(this._onMouseWheel,this);this._rowsCount=null;this._viewTables={};this._splitAreas={};this._scroller=null;this.element=b.element;this._staticDataRowIndex=b._getStaticIndex(true);this._staticRowIndex=b._getRealStaticRowIndex();this._staticColumnIndex=b._getRealStaticColumnIndex();this._staticAllColumnIndex=(this._staticColumnIndex===-1)?-1:b._field("visibleLeaves")[this._staticColumnIndex].leavesIdx},dispose:function(){this._base();this._wijgrid.outerDiv.unbind("mousewheel",this._mouseWheelHandler)},ensureWidth:function(l,r,c){var j=this._wijgrid,e=j.options,f=this._staticColumnIndex,p=l<=f,k=a(this._viewTables.nw.element()),g=a(this._viewTables.ne.element()),q=a(this._viewTables.sw.element()),m=a(this._viewTables.se.element()),b=p?[k,q]:[g,m],i=(p?k.width():g.width())+r-c,h=j._field("frozener"),d=this.getScrollValue();if(this._scroller.data("wijsuperpanel")){this._scroller.wijsuperpanel("destroy")}this._base(l,r);this._setTableWidth(b,i,r,l);try{if(f>=0){e.splitDistanceX=k[0].offsetWidth}else{e.splitDistanceX=0}}catch(n){}this._updateSplitAreaBounds(0);m.css("height","");this._adjustRowHeight();m.height(Math.max(m.height(),q.height()));try{if(this._staticRowIndex>=0){e.splitDistanceY=Math.max(k[0].offsetHeight,g[0].offsetHeight)}else{e.splitDistanceY=0}}catch(n){}this._updateSplitAreaBounds(1);this.refreshPanel(d);h.refresh()},ensureHeight:function(i){var f,g=this._wijgrid,c=g.options,h=a(this._viewTables.nw.element()),d=a(this._viewTables.ne.element()),l=a(this._viewTables.sw.element()),j=a(this._viewTables.se.element()),e=g._field("frozener"),b=this.getScrollValue();if(this._scroller.data("wijsuperpanel")){this._scroller.wijsuperpanel("destroy")}if(arguments.length>0){f=this.getJoinedRows(i,2);this._setRowHeight(f,this._getRowHeight(f))}j.css("height","");j.height(Math.max(j.height(),l.height()));try{if(this._staticRowIndex>=0){c.splitDistanceY=Math.max(h[0].offsetHeight,d[0].offsetHeight)}else{c.splitDistanceY=0}}catch(k){}this._updateSplitAreaBounds(1);this.refreshPanel(b);e.refresh()},getScrollValue:function(){var b=this._getSuperPanel();return(b)?{type:"fixed",hScrollValue:b.options.hScroller.scrollValue,vScrollValue:b.options.vScroller.scrollValue}:{type:"fixed",hScrollValue:null,vScrollValue:null}},getVisibleAreaBounds:function(){var b=a.wijmo.wijgrid.bounds(this._wijgrid.outerDiv.find(".wijmo-wijsuperpanel-contentwrapper:first"));if(!b){b=a.wijmo.wijgrid.bounds(this._wijgrid.outerDiv)}return b},getFixedAreaVisibleBounds:function(){var e=this.getVisibleAreaBounds(),d=a.wijmo.wijgrid.bounds(this._splitAreas.ne),b=a.wijmo.wijgrid.bounds(this._splitAreas.nw),c=null,f=null;if(d.height||b.height){c={left:e.left,top:e.top,width:e.width,height:Math.min(d.height||b.height,e.height)}}if(b.width){f={left:e.left,top:e.top,width:Math.min(b.width,e.width),height:e.height}}return[c,f]},refreshPanel:function(g){var c=this,e=this._wijgrid,d=e.options,h=this._getGridWidth(d.scrollMode),b=this._getMappedScrollMode(),f=this._testNeedVBar(e.outerDiv,e.element,a(this._viewTables.ne.element()),d.scrollMode,e._autoHeight);this._scroller.width(h);this._splitAreas.ne.width(h-d.splitDistanceX-(f?this._verScrollBarSize:0));if(!this._scroller.data("wijsuperpanel")){this._scroller.wijsuperpanel({disabled:e.options.disabled,scroll:a.proxy(this._onScroll,this),bubbleScrollingEvent:true,vScroller:{scrollBarVisibility:b.vScrollBarVisibility,scrollValue:g.type==="fixed"?g.vScrollValue:null},hScroller:{scrollBarVisibility:b.hScrollBarVisibility,scrollValue:g.type==="fixed"?g.hScrollValue:null},hScrollerActivating:function(k,i){var j;if(e._autoHeight){j=e.element.height()+d.splitDistanceY-i.contentLength;if(j>0){c._scroller.height(c._scroller.height()+j);c._scroller.wijsuperpanel("paintPanel");return false}}c._splitAreas.sw.height(i.contentLength-d.splitDistanceY)}})}else{this._scroller.wijsuperpanel("paintPanel")}this._scroller.find(".wijmo-wijsuperpanel-hbarcontainer, .wijmo-wijsuperpanel-vbarcontainer").css("zIndex",5)},scrollTo:function(q){if(!q.tableCell()){return}var c=this._wijgrid,t=c.options,m=this._getSuperPanel(),d=q.tableCell(),e=d.nodeType?a(d):d,g,v,i,k,w,p,n,u,b,x,r,h=null,l=null,f,s,y,j;if(m&&e.is(":visible")){g=m.getContentElement();v=g.parent();i=parseInt((g.css("left")+"").replace("px",""),10)*-1;k=parseInt((g.css("top")+"").replace("px",""),10)*-1;w=v.outerWidth()-t.splitDistanceX;p=v.outerHeight()-t.splitDistanceY;n=e.position();u=n.left;b=n.top;x=e.outerWidth();r=e.outerHeight();f=c._getStaticIndex(true);s=c._getStaticIndex(false);y=q.rowIndex();j=q.cellIndex();if(y<=f){if(j<=s){h=0;l=0}else{u+=i;if(u+x>i+w){i=h=u+x-w}if(u<i){h=u}l=0}}else{if(j<=s){b+=k;if(b+r>k+p){k=l=b+r-p}if(b<k){l=b}h=0}else{u-=t.splitDistanceX;if(b+r>k+p){k=l=b+r-p}if(u+x>i+w){i=h=u+x-w}if(b<k){l=b}if(u<i){h=u}}}if(h!==null){m.hScrollTo(h)}if(l!==null){m.vScrollTo(l)}}},updateSplits:function(m){var e=this._wijgrid,s=e.options,b,d,h,q=this,l=[],j=[],k=[],r=this._staticColumnIndex,p,n=s.scrollMode,f=e._field("visibleLeaves"),c=a(this._viewTables.se.element()),i=a(this._viewTables.ne.element()),t=a(this._viewTables.sw.element()),v=a(this._viewTables.nw.element()),g=e.outerDiv;if(this._scroller.data("wijsuperpanel")){this._scroller.wijsuperpanel("destroy")}g.unbind("mousewheel",this._mouseWheelHandler);b=c.find("tbody .wijmo-wijgrid-row:not(.wijmo-wijgrid-groupheaderrow):first");this.fooRow=d=b.clone().removeAttr("datarowindex").addClass("wijmo-wijgrid-foorow").appendTo(b.parent()).show().height(0).css({"font-size":"0"});this._setRowInfo(this.fooRow,this._createRowInfo(this.fooRow,a.wijmo.wijgrid.rowType.fooRow,-1,-1,-1,-1,-1));this.fooRowCells=d.find(">td").height(0).css({"border-top":"0","border-bottom":"0"}).find(">div.wijmo-wijgrid-innercell").css({"padding-top":"0px","padding-bottom":"0px"}).empty();d.css("visibility","hidden");if(d.length===0){e.element.css("width","100%")}a.each([c,i,t,v],function(o,w){w.css({"table-layout":"",width:""})});a.each(f,function(y,x){var z,o=x.width;if(o||(o===0)){z=((typeof(o)==="string")&&(o.length>1)&&(o[o.length-1]==="%"));if(z){o=g.width()*parseFloat(o)/100}else{o=parseFloat(o)}if(x.ensurePxWidth||(x.ensurePxWidth===undefined&&s.ensureColumnsPxWidth)){x._realWidth=o}q._setColumnWidth(y,o)}});a.each(f,function(w,o){q._getColumnWidth(w,k)});a.each([v,i,t,c],function(o,w){w.css({width:"1px"})});a.each(f,function(w,o){q._getColumnWidth(w,j)});h=g.innerWidth();l=this._adjustWidthArray(k,j,h,s.ensureColumnsPxWidth,s.autoExpandColumnIndex);a.each(l,function(w,x){var o=f[w];if(o._realWidth!==undefined){delete o._realWidth;return}q._setColumnWidth(w,x.width)});if(r>=0){p=r;this._setTableWidth([v,t],this._sumWidthArray(l,0,p),l[p].width,p)}try{if(r>=0){s.splitDistanceX=v[0].offsetWidth}else{s.splitDistanceX=0}}catch(u){}this._updateSplitAreaBounds(0);if(!s.ensureColumnsPxWidth){i.parent().width(h-s.splitDistanceX)}p=l.length-1;if(p!==-1){this._setTableWidth([i,c],this._sumWidthArray(l,r+1,p),l[p].width,p)}c.css("height","");this._adjustRowHeight();c.height(Math.max(c.height(),t.height()));try{if(this._staticRowIndex>=0){s.splitDistanceY=Math.max(v[0].offsetHeight,i[0].offsetHeight)}else{s.splitDistanceY=0}}catch(u){}this._updateSplitAreaBounds(1);if(!s.ensureColumnsPxWidth){if(this._testNeedVBar(e.outerDiv,c,i,n,e._autoHeight)){h-=this._verScrollBarSize;l=this._adjustWidthArray(k,j,h,s.ensureColumnsPxWidth,s.autoExpandColumnIndex);a.each(l,function(o,w){if(!w.real){q._setColumnWidth(o,w.width)}});if(r>=0){p=r;this._setTableWidth([v,t],this._sumWidthArray(l,0,p),l[p].width,p)}try{if(r>=0){s.splitDistanceX=v[0].offsetWidth}else{s.splitDistanceX=0}}catch(u){}this._updateSplitAreaBounds(0);i.parent().width(h-s.splitDistanceX);p=l.length-1;if(p!==-1){this._setTableWidth([i,c],this._sumWidthArray(l,r+1,p),l[p].width,p)}c.css("height","");this._adjustRowHeight();c.height(Math.max(c.height(),t.height()));try{if(this._staticRowIndex>=0){s.splitDistanceY=Math.max(v[0].offsetHeight,i[0].offsetHeight)}else{s.splitDistanceY=0}}catch(u){}this._updateSplitAreaBounds(1)}}this.refreshPanel(m);g.bind("mousewheel",this._mouseWheelHandler)},bodyRows:function(){var b=this._base();if(b&&this.fooRow){b._offsetBottom(1)}return b},focusableElement:function(){return this._wijgrid.outerDiv},forEachColumnCell:function(d,g,f){var e=this.getJoinedTables(true,d),c,b;if(e[0]!==null){c=e[2];b=e[0].forEachColumnCell(c,g,f);if(b!==true){return b}if(e[1]!==null){b=e[1].forEachColumnCell(c,g,f);if(b!==true){return b}}}return true},forEachRowCell:function(i,h,g){var f=this.getJoinedTables(false,i),e=f[0],d=f[1],b,c;if(e!==null){b=f[2];if(b<e.element().rows.length){c=e.forEachRowCell(b,h,g);if(c!==true){return c}}if((d!==null)&&(b<d.element().rows.length)){c=d.forEachRowCell(b,h,g);if(c!==true){return c}}}return true},getAbsoluteCellInfo:function(b){return new a.wijmo.wijgrid.cellInfo(this.getColumnIndex(b),this.getAbsoluteRowIndex(b.parentNode))},getAbsoluteRowIndex:function(c){var b=c.rowIndex,d=c.parentNode;while(d.tagName.toLowerCase()!=="table"){d=d.parentNode}return(d===this._viewTables.nw.element()||d===this._viewTables.ne.element())?b:b+this._staticRowIndex+1},getCell:function(i,g){var b=this.getJoinedTables(false,g),f,e,h,d,c;if(b[0]!==null){f=this.getJoinedTables(true,i);if(f[0]!==null){e=b[2];h=f[2];d=null;if(b[1]!==null){d=(i===h)?b[0]:b[1]}else{d=b[0]}c=d.getCellIdx(h,e);if(c>=0){return d.element().rows[e].cells[c]}}}return null},getColumnIndex:function(f){var b=null,d=null,c=false,e;for(b=f.parentNode;b.tagName.toLowerCase()!=="table";b=b.parentNode){}if(b!==null){if(b===this._viewTables.nw.element()){d=this._viewTables.nw}else{if(b===this._viewTables.ne.element()){d=this._viewTables.ne;c=true}else{if(b===this._viewTables.sw.element()){d=this._viewTables.sw}else{if(b===this._viewTables.se.element()){d=this._viewTables.se;c=true}}}}if(d!==null){e=d.getColumnIdx(f);if(c){e+=this._staticColumnIndex+1}return e}}return -1},getHeaderCell:function(d){var b=this._wijgrid._field("visibleLeaves")[d],c;if(b&&(c=this._wijgrid._headerRows())){return new a.wijmo.wijgrid.rowAccessor().getCell(c.item(b.thY),b.thX)}return null},getJoinedCols:function(d){var b=[],e=this.getJoinedTables(true,d),c=e[2];e.splice(e.length-1,1);a.each(e,function(f,g){b.push(g?a(g.element()).find("col")[c]:null)});return b},getJoinedRows:function(i,d){var o=null,n=null,m=null,k=null,j=this._staticRowIndex,b=this._staticColumnIndex,c=this._wijgrid._field("visibleLeaves").length-1,l=this._rowsCount-1,f=(j===l),h=(j<0),e=!f&&!h,g=0;if(f||e){if(b>=0&&b<c){m=this._viewTables.nw;k=this._viewTables.ne}else{m=(b<0)?this._viewTables.ne:this._viewTables.nw}g=m.getSectionLength(d);if(i<g){o=m.getSectionRow(i,d);if(k!==null){n=k.getSectionRow(i,d)}}}if(h||(e&&(o===null))){if(!h){i-=g}if(b>=0&&b<c){m=this._viewTables.sw;k=this._viewTables.se}else{m=(b<0)?this._viewTables.se:this._viewTables.sw}o=m.getSectionRow(i,d);if(k!==null){n=k.getSectionRow(i,d)}}return(o===null&&n===null)?null:[o,n]},getJoinedTables:function(c,e){var h=null,g=null,b=e,f=this._wijgrid,i=this._staticRowIndex,d=this._staticColumnIndex;if(c){if(e<=d){h=this._viewTables.nw;g=this._viewTables.sw}else{h=this._viewTables.ne;g=this._viewTables.se;b=b-(d+1)}if(i<0){h=null}if(i===this._rowsCount-1){g=null}}else{if(e<=i){h=this._viewTables.nw;g=this._viewTables.ne}else{h=this._viewTables.sw;g=this._viewTables.se;b=b-(i+1)}if(d<0){h=null}if(d===f._field("leaves").length-1){g=null}}if(h===null){h=g;g=null}return[h,g,b]},subTables:function(){return[this._viewTables.nw,this._viewTables.ne,this._viewTables.sw,this._viewTables.se]},_getGridWidth:function(e){var d=this._wijgrid,c=d.element.outerWidth(true)+d.options.splitDistanceX,b=d.outerDiv.innerWidth();if(this._testNeedVBar(d.outerDiv,d.element,a(this._viewTables.ne.element()),e,d._autoHeight)){c+=this._verScrollBarSize}if(c>b){c=b}return c},_getSuperPanel:function(){return this._scroller?this._scroller.data("wijsuperpanel"):null},_preRender:function(){var c=document.createDocumentFragment(),b=a.wijmo.wijgrid.htmlTableAccessor;this._wijgrid.outerDiv.wrapInner('<div class="wijmo-wijgrid-fixedview"><div class="wijmo-wijgrid-scroller"><div class="wijmo-wijgrid-split-area-se wijmo-wijgrid-content-area"></div></div></div>');this._scroller=this._wijgrid.outerDiv.find(".wijmo-wijgrid-scroller");this._scroller.after(this._splitAreas.nw=a('<div class="wijmo-wijgrid-split-area wijmo-wijgrid-split-area-nw" style="overflow:hidden;position:absolute;z-index:4;top:0px;left:0px;"></div>'));this._scroller.after(this._splitAreas.ne=a('<div class="wijmo-wijgrid-split-area wijmo-wijgrid-split-area-ne" style="overflow:hidden;position:absolute;z-index:4;top:0px;left:0px;"></div>'));this._scroller.after(this._splitAreas.sw=a('<div class="wijmo-wijgrid-split-area wijmo-wijgrid-split-area-sw" style="overflow:hidden;position:absolute;z-index:4;top:0px;left:0px;"></div>'));this._splitAreas.se=this._scroller.find(".wijmo-wijgrid-split-area-se:first");this._viewTables={nw:new b(c.appendChild(document.createElement("table")),true,true,true),ne:new b(c.appendChild(document.createElement("table")),true,true,true),sw:new b(c.appendChild(document.createElement("table")),true,true,true),se:new b(c.appendChild(this._wijgrid.element[0]),true,true,true)}},_postRender:function(){var d,b,f,e,c=a.wijmo.wijgrid.htmlTableAccessor;this._viewTables={nw:new c(d=this._viewTables.nw.element()),ne:new c(b=this._viewTables.ne.element()),sw:new c(f=this._viewTables.sw.element()),se:new c(e=this._viewTables.se.element())};this._splitAreas.nw.empty().append(d);this._splitAreas.ne.empty().append(b);this._splitAreas.sw.empty().append(f);this._splitAreas.se.empty().append(e);a.each(this._viewTables,function(g,h){a(h.element()).addClass("wijmo-wijgrid-table").attr({role:"grid",border:"0",cellpadding:"0",cellspacing:"0"}).css("border-collapse","separate").find("> tbody").addClass("ui-widget-content wijmo-wijgrid-data")});this._rowsCount=Math.max(d.rows.length,b.rows.length)+Math.max(f.rows.length,e.rows.length);this._base()},_createCol:function(c,b){return[document.createElement("col"),document.createElement("col")]},_appendCol:function(d,c,b){if(b<=this._staticColumnIndex){this._viewTables.nw.appendCol(d[0]);this._viewTables.sw.appendCol(d[1])}else{this._viewTables.ne.appendCol(d[0]);this._viewTables.se.appendCol(d[1])}},_insertRow:function(g,c,e){var b=a.wijmo.wijgrid.rowType,f,d,h=this._viewTables;switch(g){case b.header:case b.filter:f=h.nw.ensureTHead();d=h.ne.ensureTHead();break;case b.footer:f=h.sw.ensureTFoot();d=h.se.ensureTFoot();break;default:if(c<=this._staticDataRowIndex){f=h.nw.ensureTBody();d=h.ne.ensureTBody()}else{f=h.sw.ensureTBody();d=h.se.ensureTBody()}}if(e){return[f.appendChild(e),d.appendChild(e.cloneNode(false))]}else{return[f.insertRow(c>f.rows.length?-1:c),d.insertRow(c>d.rows.length?-1:c)]}},_rowRendered:function(f,b,c){var d=f.$rows[0],e=f.$rows[1];if(!d.cells.length&&this._isBodyRow(f)){d.parentNode.removeChild(d);d=null}if(!e.cells.length&&this._isBodyRow(f)){e.parentNode.removeChild(e);e=null}if(d||e){this._base(f,b,c)}},_appendCell:function(e,b,d){var c=(e.type!==a.wijmo.wijgrid.rowType.header)?this._staticColumnIndex:this._staticAllColumnIndex;if(b<=c){e.$rows[0].appendChild(d[0])}else{e.$rows[1].appendChild(d[0])}},_getRowHeight:function(c){if(c[0]&&c[1]){var d=[a(c[0]),a(c[1])],e,b;a.each(d,function(f,g){g.css("height","")});e=d[0].height();b=d[1].height();if(e>b){return e}else{if(e<b){return b}}}return null},_setRowHeight:function(b,e){if(b[0]&&b[1]){var d=[a(b[0]),a(b[1])],c;if(e===null){return}e+=1;a.each(d,function(f,g){g.height(e);c=e-g.height();if(c){g.height(e+c)}})}},_adjustRowHeight:function(){var c=this._wijgrid,v=this._staticColumnIndex,u=c._field("visibleLeaves").length-1,h,g,k,w,f,n,r,o,e,d,q,m,t,s,p,b,l=[];if(v>-1&&v<u){h=this._staticRowIndex;g=this._rowsCount-1;k=this._viewTables;if(h>-1&&h<=g){w=k.ne.element();f=w.parentNode;n=k.nw.element();r=n.parentNode;p=n.rows;b=w.rows;m=p.length;for(t=0;t<m;t++){l.push(this._getRowHeight([p[t],b[t]]))}}if(h>=-1&&h<g){o=k.se.element();e=o.parentNode;d=k.sw.element();q=d.parentNode;p=d.rows;b=o.rows;m=p.length;for(t=0;t<m;t++){l.push(this._getRowHeight([p[t],b[t]]))}}if(h>-1&&h<=g){r.removeChild(n);f.removeChild(w)}if(h>=-1&&h<g){q.removeChild(d);e.removeChild(o)}if(h>-1&&h<=g){p=n.rows;b=w.rows;m=p.length;for(t=0,s=0;t<m;t++){this._setRowHeight([p[t],b[t]],l[s++])}}if(h>=-1&&h<g){p=d.rows;b=o.rows;m=p.length;for(t=0;t<m;t++){this._setRowHeight([p[t],b[t]],l[s++])}}if(h>-1&&h<=g){r.appendChild(n);f.appendChild(w)}if(h>=-1&&h<g){q.appendChild(d);e.appendChild(o)}}},_onScroll:function(d,f){var c,b,e={};if(f.dir==="h"){c=this._splitAreas.ne;b="scrollLeft"}else{c=this._splitAreas.sw;b="scrollTop"}if(f.animationOptions){e[b]=f.position;c.animate(e,f.animationOptions)}else{c[0][b]=f.position}},_onScrolled:function(){this._splitAreas.ne[0].scrollLeft=parseInt((this._wijgrid.outerDiv.find(".wijmo-wijsuperpanel-templateouterwrapper:first").css("left")+"").replace("px",""),10)*-1;this._splitAreas.sw[0].scrollTop=parseInt((this._wijgrid.outerDiv.find(".wijmo-wijsuperpanel-templateouterwrapper:first").css("top")+"").replace("px",""),10)*-1},_onMouseWheel:function(g,h){var f,c=(h>0)?"top":"bottom",b=false,d;if(this._wijgrid._canInteract()){f=this.getFixedAreaVisibleBounds();a.each(f,function(e,j){if(j&&a.ui.isOver(g.pageY,g.pageX,j.top,j.left,j.height,j.width)){b=true;return false}});if(b&&this._scroller.data("wijsuperpanel")){d=this._scroller.wijsuperpanel("option","vScroller").scrollValue;this._scroller.wijsuperpanel("doScrolling",c);if(d!==this._scroller.wijsuperpanel("option","vScroller").scrollValue){g.stopPropagation();g.preventDefault()}}}},_testNeedVBar:function(k,c,l,d,m){var i,e=this._wijgrid,f=l.width()+e.options.splitDistanceX,b=c.height()+e.options.splitDistanceY,o=k.width(),j=k.height(),h,n=0,g=0;if(e.$superPanelHeader!==null){n=e.$superPanelHeader.outerHeight(true)}if(e.$bottomPagerDiv!==null){g=e.$bottomPagerDiv.outerHeight(true)}h=j-n-g;if(d==="both"||d==="vertical"){i=true}else{i=(d==="auto")&&((b>h)||(!m&&f>o&&b>h-this._verScrollBarSize))}return i},_updateSplitAreaBounds:function(h){var b=this._wijgrid,g=b.options,f,d,c=0,e=0;if(h===0||h===2){this._splitAreas.nw.width(g.splitDistanceX);this._splitAreas.sw.width(g.splitDistanceX);this._splitAreas.se.css("marginLeft",g.splitDistanceX);this._splitAreas.ne.css("marginLeft",g.splitDistanceX)}if(h===1||h===2){this._scroller.css("height","");this._splitAreas.se.css("marginTop",0);f=b.outerDiv.height();if(!b._autoHeight){this._scroller.height(f)}else{this._scroller.height(f+g.splitDistanceY)}this._splitAreas.nw.height(g.splitDistanceY);this._splitAreas.ne.height(g.splitDistanceY);if(b.$superPanelHeader!==null){c=b.$superPanelHeader.outerHeight(true)}if(b.$bottomPagerDiv!==null){e=b.$bottomPagerDiv.outerHeight(true)}d=f-c-e;if(b.$superPanelHeader!==null){this._splitAreas.nw.css("top",c+"px");this._splitAreas.ne.css("top",c+"px")}if(!b._autoHeight){this._splitAreas.sw.height(d-g.splitDistanceY)}else{this._splitAreas.sw.height(d)}this._splitAreas.sw.css("top",g.splitDistanceY+c);this._splitAreas.se.css("marginTop",g.splitDistanceY)}}})})(jQuery);(function(a){a.wijmo.wijgrid.selection=function(b){var k=0,i,g=new a.wijmo.wijgrid.cellInfoOrderedCollection(b),c=new a.wijmo.wijgrid.cellInfoOrderedCollection(b),d=new a.wijmo.wijgrid.cellInfoOrderedCollection(b),j=new a.wijmo.wijgrid.cellInfoOrderedCollection(b),m=null,e=null,l={singlecell:[0,0,0],singlecolumn:[1,1,1],singlerow:[2,2,2],singlerange:[0,1,2],multicolumn:[1,1,1],multirow:[2,2,2],multirange:[0,1,2]};this.selectedCells=function(){return d};this.addColumns=function(o,n){if(!n&&n!==0){n=o}this.addRange(o,0,n,16777215)};this.addRange=function(o,r,p,q){if(!o&&(arguments.length===1)){throw"invalid argument"}var n=(arguments.length===4)?new a.wijmo.wijgrid.cellInfoRange(new a.wijmo.wijgrid.cellInfo(o,r),new a.wijmo.wijgrid.cellInfo(p,q)):o._clone();n._normalize();if(!n._isValid()){throw"invalid argument"}this.beginUpdate();this._startNewTransaction(b._field("currentCell"));this._selectRange(n,false,true,0,null);this.endUpdate()};this.addRows=function(o,n){if(!n&&n!==0){n=o}this.addRange(0,o,16777215,n)};this.removeRange=function(o,r,p,q){if(!o&&(arguments.length===1)){throw"invalid argument"}var n=(arguments.length===4)?new a.wijmo.wijgrid.cellInfoRange(new a.wijmo.wijgrid.cellInfo(o,r),new a.wijmo.wijgrid.cellInfo(p,q)):o._clone();n._normalize();if(!n._isValid()){throw"invalid argument"}this.beginUpdate();this._startNewTransaction(b._field("currentCell"));this._clearRange(n,0);this.endUpdate()};this.removeColumns=function(o,n){if(!n&&n!==0){n=o}this.removeRange(o,0,n,16777215)};this.removeRows=function(o,n){if(!n&&n!==0){n=o}this.removeRange(0,o,16777215,n)};this.addRows=function(o,n){if(!n&&n!==0){n=o}this.addRange(0,o,65535,n)};this.clear=function(){this.beginUpdate();c._clear();c._addFrom(d);this.endUpdate()};this.selectAll=function(){this.beginUpdate();this._selectRange(b._getDataCellsRange(),false,false,0,null);this.endUpdate()};this.beginUpdate=function(){k++};this.endUpdate=function(){if(k>0){k--;if(k===0){f();if(g.length()||c.length()){if(m!==null){m.UnderlyingDataChanged()}if(e!==null){e.UnderlyingDataChanged()}b._trigger("selectionChanged",null,{addedCells:g,removedCells:c})}g=new a.wijmo.wijgrid.cellInfoOrderedCollection(b);c._clear()}}};this._multipleRangesAllowed=function(){var n=b.options.selectionMode;return(n&&((n=n.toLowerCase())==="multicolumn"||n==="multirow"||n==="multirange"))};this._anchorCell=function(){return i};this._startNewTransaction=function(n){if(n){i=n._clone();j=new a.wijmo.wijgrid.cellInfoOrderedCollection(b)}};this._clearRange=function(t,r){var y=b.options.selectionMode.toLowerCase(),n,o,q,v,z,x,s,u,p,w=b._getDataCellsRange();if(t._isValid()&&(y!=="none")&&(d.length()>0)){n=t._clone();n._normalize();n._clip(w);if(!t._isValid()){return}n._extend(l[y][r],w);this.beginUpdate();for(s=0,u=d.length();s<u;s++){p=d.item(s);if(n._containsCellInfo(p)){c._add(p)}}this.endUpdate()}};this._selectRange=function(o,u,s,r,q){var t=b.options.selectionMode.toLowerCase(),n,p=b._getDataCellsRange();if((t!=="none")&&o._isValid()){n=o._clone();n._normalize();n._clip(p);if(!n._isValid()){return}this.beginUpdate();if(!this._multipleRangesAllowed()){this.clear()}else{if(u||s){if(s){c._clear();c._addFrom(j)}}else{this.clear()}}switch(t){case"singlecell":case"singlecolumn":case"singlerow":n=(q===null)?new a.wijmo.wijgrid.cellInfoRange(n.topLeft(),n.topLeft()):new a.wijmo.wijgrid.cellInfoRange(q,q);break}n._extend(l[t][r],p);h(n,true);this.endUpdate()}};function f(){var t=b._getDataToAbsOffset(),r=t.x,v=t.y,z=b._view(),u,x,s,A,y,w,q=a.wijmo.wijgrid.renderState,o,n,p=-1;for(u=0,x=c.length();u<x;u++){s=c.item(u);if(g.indexOf(s)<0){A=z.getCell(s.cellIndex()+r,s.rowIndex()+v);if(A){if(p!==s.rowIndex()){o=z._getRowInfo(s._row());p=s.rowIndex()}y=a(A);n=z._changeCellRenderState(y,q.selected,false);b.cellStyleFormatter.format(y,s.cellIndex(),s.column(),o,n)}d._remove(s);j._remove(s)}else{c._removeAt(u);u--;x--}}p=-1;for(u=0,x=g.length();u<x;u++){s=g.item(u);w=d.indexOf(s);if(w<0){A=z.getCell(s.cellIndex()+r,s.rowIndex()+v);if(A){if(p!==s.rowIndex()){o=z._getRowInfo(s._row());p=s.rowIndex()}y=a(A);n=z._changeCellRenderState(y,q.selected,true);b.cellStyleFormatter.format(y,s.cellIndex(),s.column(),o,n)}d._insertUnsafe(s,~w);j._add(s)}else{g._removeAt(u);u--;x--}}}function h(s,x){var p=s.topLeft().cellIndex(),v=s.topLeft().rowIndex(),o=s.bottomRight().cellIndex(),u=s.bottomRight().rowIndex(),r,z,q,w,t=b._view(),n,y;if(x){r=g.length();y=b._rows();for(z=v;z<=u;z++){n=t._getRowInfo(y.item(z));if(n.type&a.wijmo.wijgrid.rowType.data){for(q=p;q<=o;q++){w=new a.wijmo.wijgrid.cellInfo(q,z);if(r===0){g._appendUnsafe(w)}else{g._add(w)}}}}}else{r=c.length();for(z=v;z<=u;z++){for(q=p;q<=o;q++){w=new a.wijmo.wijgrid.cellInfo(q,z);if(r===0){c._appendUnsafe(w)}else{c._add(w)}}}}}};a.wijmo.wijgrid.cellInfoOrderedCollection=function(c){if(!c){throw"argument is null"}var b=[];this.item=function(d){return b[d]};this.length=function(){return b.length};this.indexOf=function(e,j){if(arguments.length===1){j=e.rowIndex();e=e.cellIndex()}var f=0,d=b.length-1,h,i,g;while(f<=d){h=f+((d-f)>>1);i=b[h];g=i.rowIndex()-j;if(g===0){g=i.cellIndex()-e}if(g<0){f=h+1}else{if(g>0){d=h-1}else{return h}}}return ~f};this.toString=function(){var f="",e,d;for(e=0,d=b.length;e<d;e++){f+=b[e].toString()+"\n"}return f};this._add=function(e){var d=this.indexOf(e);if(d<0){b.splice(~d,0,e);e._setGridView(c);return true}return false};this._addFrom=function(e){if(e){var g=e.length(),d=b.length,f;if(d===0){b.length=g;for(f=0;f<g;f++){b[f]=e.item(f);b[f]._setGridView(c)}}else{for(f=0;f<g;f++){this._add(e.item(f))}}}};this._appendUnsafe=function(d){b[b.length]=d;d._setGridView(c)};this._insertUnsafe=function(e,d){b.splice(d,0,e)};this._clear=function(){b.length=0};this._remove=function(e){var d=this.indexOf(e);if(d>=0){b.splice(d,1);return true}return false};this._removeAt=function(d){b.splice(d,1)};this._getColumnsIndicies=function(){var h=[],d=b.length,e,g,f;if(d){e=[];for(g=0;g<d;g++){e[b[g].cellIndex()]=1}d=e.length;f=0;for(g=0;g<d;g++){if(e[g]){h[f++]=g}}}return h};this._getSelectedRowsIndicies=function(){var h=[],d=b.length,g,f,e;if(d){g=[];for(f=0;f<d;f++){g[b[f].rowIndex()]=1}d=g.length;e=0;for(f=0;f<d;f++){if(g[f]){h[e++]=f}}}return h};this._rectangulate=function(){var d=b.length,h=4294967295,k=4294967295,f=0,j=0,g,e;if(d){for(g=0;g<d;g++){e=b[g];h=Math.min(h,e.cellIndex());k=Math.min(k,e.rowIndex());f=Math.max(f,e.cellIndex());j=Math.max(j,e.rowIndex())}return new a.wijmo.wijgrid.cellInfoRange(new a.wijmo.wijgrid.cellInfo(h,k),new a.wijmo.wijgrid.cellInfo(f,j))}return null}}})(jQuery);(function(a){a.extend(a.wijmo.wijgrid,{selectionui:function(h){var t=10,n="{0}."+h.widgetName+".selectionui",q=new a.wijmo.wijgrid.cellInfoOrderedCollection(h),f,k,s,o,c=false,b=false,e=h._view(),m=h._field("visibleLeaves").length,p=e.focusableElement();p.bind(r("mousedown"),j);this.dispose=function(){p.unbind(r("mousedown"),j);l()};function j(y){if(!h._canInteract()||h.options.selectionMode.toLowerCase()==="none"){return}var z=e.getVisibleAreaBounds(),x={x:y.pageX,y:y.pageY},w=((y.target&&y.target.tagName!==undefined)?y.target.tagName.toLowerCase():undefined),v=a(y.target);if((!w||v.is("td.wijgridtd, th.wijgridtd, div.wijmo-wijgrid-innercell"))&&(x.x>z.left&&x.x<z.left+z.width)&&(x.y>z.top&&x.y<z.top+z.height)){u();f=x;k=g(f)}}function i(w){if(!k||!k._isValid()){return}var I={x:w.pageX,y:w.pageY},O,K,G,A,E,J,D,v,L,M,N,C,B,x,y,H=h._view(),F=h._rows(),z=a.wijmo.wijgrid.renderState;if(!c){c=(Math.abs(f.x-I.x)>t)||(Math.abs(f.y-I.y)>t)}if(c){O=g(I);if(!O._isValid()){return}s=O;K=new a.wijmo.wijgrid.cellInfoRange(k,s);K._normalize();K._clip(h._getDataCellsRange());if(K._isValid()&&!K.isEqual(o)){G=h._getDataToAbsOffset();o=K;A=new a.wijmo.wijgrid.cellInfoOrderedCollection(h);E=K.bottomRight().rowIndex();J=K.bottomRight().cellIndex();for(D=K.topLeft().rowIndex();D<=E;D++){B=H._getRowInfo(F.item(D));if(B.type&a.wijmo.wijgrid.rowType.data){for(v=K.topLeft().cellIndex();v<=J;v++){A._appendUnsafe(new a.wijmo.wijgrid.cellInfo(v,D))}}}x=-1;for(L=0,M=q.length();L<M;L++){N=q.item(L);if(A.indexOf(N)<0){if(h.selection().selectedCells().indexOf(N)<0){v=e.getCell(N.cellIndex()+G.x,N.rowIndex()+G.y);if(v){if(x!==N.rowIndex()){B=H._getRowInfo(N._row());x=N.rowIndex()}C=a(v);y=H._changeCellRenderState(C,z.selected,false);h.cellStyleFormatter.format(C,N.cellIndex(),N.column(),B,y)}}q._removeAt(L);L--;M--}}x=-1;for(L=0,M=A.length();L<M;L++){N=A.item(L);if(q.indexOf(N)<0&&h.selection().selectedCells().indexOf(N)<0){if(q._add(N)){v=e.getCell(N.cellIndex()+G.x,N.rowIndex()+G.y);if(v){if(x!==N.rowIndex()){B=H._getRowInfo(N._row());x=N.rowIndex()}C=a(v);y=H._changeCellRenderState(C,z.selected,true);h.cellStyleFormatter.format(C,N.cellIndex(),N.column(),B,y)}}}}}}}function d(D){l();if(c){c=false;if(o&&o._isValid()){h._changeCurrentCell(s);if(!D.shiftKey||(!h.selection()._multipleRangesAllowed()&&h.options.selectionMode.toLowerCase()!=="singleRange")){h.selection()._startNewTransaction(k)}h.selection().beginUpdate();h.selection()._selectRange(o,D.shiftKey,D.ctrlKey,0,s);h.selection().endUpdate();var F=h._view(),A=h._getDataToAbsOffset(),B,C,z,G,E,x=-1,w,v,y=a.wijmo.wijgrid.renderState;for(B=0,C=q.length();B<C;B++){z=q.item(B);if(h.selection().selectedCells().indexOf(z)<0){G=F.getCell(z.cellIndex()+A.x,z.rowIndex()+A.y);if(G!==null){if(x!==z.rowIndex()){w=F._getRowInfo(z._row());x=z.rowIndex()}E=a(G);v=F._changeCellRenderState(E,y.selected,false);h.cellStyleFormatter.format(E,z.cellIndex(),z.column(),w,v)}}}q._clear();k=s=o=null;return false}}}function u(){if(!b){try{e.toggleDOMSelection(false);a(document).bind(r("mousemove"),i).bind(r("mouseup"),d)}finally{b=true}}}function l(){if(b){try{e.toggleDOMSelection(true);a(document).unbind(r("mousemove"),i).unbind(r("mouseup"),d)}finally{b=false}}}function r(v){return a.wijmo.wijgrid.stringFormat(n,v)}function g(v){var z=0,D=m-1,C=0,w=-1,x,E=new a.wijmo.wijgrid.rowAccessor(e,2,0,0),y,B,A,F;while(z<=D){C=((D-z)>>1)+z;x=a.wijmo.wijgrid.bounds(e.getHeaderCell(C));if(!x){B=E.item(0);x=a.wijmo.wijgrid.bounds(E.getCell(B,C))}if(!x){break}if(v.x<x.left){D=C-1}else{if(v.x>x.left+x.width){z=C+1}else{w=C;break}}}if(w===-1){return a.wijmo.wijgrid.cellInfo.prototype.outsideValue}E=new a.wijmo.wijgrid.rowAccessor(e,0,0,0);y=-1;z=0;D=E.length()-1;C=0;while(z<=D){C=((D-z)>>1)+z;B=E.item(C);x=a.wijmo.wijgrid.bounds(E.getCell(B,0));if(v.y<x.top){D=C-1}else{if(v.y>x.top+x.height){z=C+1}else{y=C;break}}}if(y===-1){return a.wijmo.wijgrid.cellInfo.prototype.outsideValue}A=h._getDataToAbsOffset();F=new a.wijmo.wijgrid.cellInfo(w-A.x,y-A.y);F._clip(h._getDataCellsRange());return F}}})})(jQuery);(function(a){a.wijmo.wijgrid.rowAccessor=function(b,g,f,c){var e=f,d=c;if(!e){e=0}if(!d){d=0}this.item=function(i){var h=this.length();return(i<h)?b.getJoinedRows(i+e,g):null};this.length=function(){var j=b.getJoinedTables(true,0),h=0,i;if(i=j[0]){h=i.getSectionLength(g)}if(i=j[1]){h+=i.getSectionLength(g)}h-=e+d;if(h<0){h=0}return h};this.iterateCells=function(p,r,h){if(p&&r){var m=0,l,n,o,k,q,s;for(l=0,n=p.length;l<n;l++){o=p[l];if(o){for(k=0,q=o.cells.length;k<q;k++){s=r(o.cells[k],m++,h);if(s!==true){return}}}}}};this.getCell=function(h,k){var i,j;if(h&&(i=h[0])){j=i.cells.length;if(k<j){return i.cells[k]}k-=j;if(i=h[1]){j=i.cells.length;if(k<j){return i.cells[k]}}}return null};this.cellsCount=function(h){var j=0,i;if(h&&(i=h[0])){j=i.cells.length;if(i=h[1]){j+=i.cells.length}}return j};this._offsetBottom=function(h){if(arguments.length){d=h}return d};this._offsetTop=function(h){if(arguments.length){e=h}return e}}})(jQuery);(function(a){a.extend(a.wijmo.wijgrid,{cellEditorHelper:function(){this.currentCellEditStart=function(f,h){var n=false,k=f.currentCell(),m=f._view(),l,i,j,g;if(k._isValid()&&!k._isEdit()&&(k.column().dataIndex>=0)){l=k._row();if(l&&l.length){g=m._getRowInfo(l).type;if(g&a.wijmo.wijgrid.rowType.data){i={cell:k,event:h,handled:false};if(n=f._trigger("beforeCellEdit",null,i)){if(!i.handled){n=e(f,i)}}if(n){k._isEdit(true);if(f.options.showRowHeader){j=a(l[0].cells[0]).children("div.wijmo-wijgrid-innercell");if(j.length){j.empty();j.append(a("<div>&nbsp;</div>").addClass("ui-icon ui-icon-pencil"))}}}}}}return n};this.currentCellEditEnd=function(f,i){var m=f.currentCell(),q=false,o=f._view(),n,h,g,k,p,l;if(!m._isValid()||!m._isEdit()){return}n=m._row();if(n&&n.length){h=o._getRowInfo(n).type;if(!(h&a.wijmo.wijgrid.rowType.data)){return q}g=(i&&i.which===a.ui.keyCode.ESCAPE);if(!i||(!g)){k={cell:m,value:undefined};if(q=f._trigger("beforeCellUpdate",null,k)){if(k.value===undefined){k.value=b(f,m)}p=k.value;try{k.value=f._parse(m.column(),k.value);p=k.value}catch(j){k.value=p}l=m.value();if(k.cell.column().dataType==="datetime"){if(p instanceof Date){p=p.getTime()}if(l instanceof Date){l=l.getTime()}}if(p!==l){try{m.value(k.value)}catch(j){q=false;f._trigger("invalidCellValue",null,{cell:m,value:k.value})}if(q){f._trigger("afterCellUpdate",null,{cell:m})}}}}else{q=true}if(q){k={cell:m,event:i,handled:false};f._trigger("afterCellEdit",null,k);if(!k.handled){q=d(f,k)}if(q){m._isEdit(false)}if(f.options.showRowHeader){a(n[0].cells[0]).children("div.wijmo-wijgrid-innercell").html("&nbsp;")}window.setTimeout(function(){if(!f.destroyed){f.element.focus();a(f._view().focusableElement()).focus();m.tableCell().focus()}},50)}}return q};function e(f,i){var k=i.cell.column(),o=false,l,n,j,g,m;if(k.dataIndex>=0){l=i.cell.value();o=true;try{n=i.cell.container();if(k.dataType==="boolean"){j=n.children("input");j.focus();if(i.event&&i.event.type==="keypress"){j.one("keyup",function(p){if(p.which===a.ui.keyCode.SPACE){p.preventDefault();j[0].checked=!l}})}}else{j=a("<input />").attr("type","text").addClass("wijgridinput wijmo-wijinput ui-state-focus").bind("keydown",f,c);j.bind((a.support.selectstart?"selectstart":"mousedown"),function(p){p.stopPropagation()});if(i.event&&i.event.type==="keypress"&&i.event.which){j.val(String.fromCharCode(i.event.which))}else{switch(i.cell.column().dataType){case"currency":case"number":if(l!==null){j.val(l);break}default:j.val(f._toStr(i.cell.column(),l));break}}n.empty().append(j);g=j.val().length;new a.wijmo.wijgrid.domSelection(j[0]).setSelection({start:g,end:g});j.focus();if(a.browser.msie){setTimeout(function(){j.focus()},0)}if(a.browser.mozilla&&document.createEvent&&j[0].dispatchEvent){m=document.createEvent("KeyboardEvent");m.initKeyEvent("keypress",false,true,null,false,false,false,false,0,a.ui.keyCode.SPACE);j[0].dispatchEvent(m);m=document.createEvent("KeyboardEvent");m.initKeyEvent("keypress",false,true,null,false,false,false,false,a.ui.keyCode.BACKSPACE,0);j[0].dispatchEvent(m)}}}catch(h){alert(h.message);o=false}}return o}function d(f,j){var m=j.cell.column(),p=false,n,o,h,l,g,k;if(m.dataIndex>=0){p=true;k=f._view();try{n=j.cell.container();o=f._toStr(m,j.cell.value());g=k._getRowInfo(f._rows().item(j.cell.rowIndex()));h=f._getDataItem(g.dataItemIndex);if(m.dataType==="boolean"){l=n.children("input");if(o==="true"){l.attr("checked","checked")}else{l.removeAttr("checked")}}else{f.cellFormatter.format(n,m,o,g.type,h)}}catch(i){alert("defaultAfterCellEdit: "+i.message);p=false}}return p}function c(f){if(f.which===a.ui.keyCode.ENTER){var g=f.data;if(g){g._endEditInternal(f);return false}}}function b(h,g){var i=g.container().find(":input:first"),f=null;if(i.length){f=(i.attr("type")==="checkbox")?i[0].checked:i.val()}return f}}})})(jQuery);(function(a){a.extend(a.wijmo.wijgrid,{resizer:function(h){var d=[],q=10,s=1,n="{0}."+h.widgetName+".resizer",b=false,r=null,o,e=null,k=null,g=null;this.addElement=function(w){if(w&&w.element){w.element.bind(m("mousemove"),t).bind(m("mousedown"),p).bind(m("mouseout"),i);d.push(w)}};this.dispose=function(){a.each(d,function(w,x){x.element.unbind(m("mousemove"),t).unbind(m("mousedown"),p).unbind(m("mouseout"),i)});f()};this.inProgress=function(){return b};function t(x){if(!b){var w=u({x:x.pageX,y:x.pageY});if(w&&w._canSize()&&h._canInteract()){w.element.css("cursor","e-resize");r=w;x.stopPropagation()}else{i(x)}}}function i(w){if(!b){if(r){r.element.css("cursor","");r=null}}}function p(x){r=u({x:x.pageX,y:x.pageY});if(r&&r._canSize()&&h._canInteract()){try{r.element.css("cursor","");o=document.body.style.cursor;document.body.style.cursor="e-resize";e=k=a.wijmo.wijgrid.bounds(r.element);g=a('<div class="wijmo-wijgrid-resizehandle ui-state-highlight">&nbsp;</div>');var w=h._view().getVisibleAreaBounds();g.css({left:x.pageX,top:e.top,height:w.height+w.top-e.top});a(document.body).append(g)}finally{l();b=true;x.stopPropagation()}}}function j(x){var w=s*Math.round((x.pageX-k.left)/s);k={left:k.left+w,top:x.pageY};g.css("left",k.left)}function c(w){try{document.body.style.cursor=o;g.remove();if(e!==k){h._fieldResized(r,e.width,k.left-e.left)}}finally{r=null;g=null;f();b=false}}function v(w){w.preventDefault()}function l(){if(!b){a(document).bind(m("mousemove"),j).bind(m("mouseup"),c);a(document.body).disableSelection();if(a.browser.msie){a(document.body).bind("selectstart",v)}}}function f(){if(b){a(document).unbind(m("mousemove"),j).unbind(m("mouseup"),c);a(document.body).enableSelection();if(a.browser.msie){a(document.body).unbind("selectstart",v)}}}function u(x){var A,w,z,B,y;for(A=0,w=d.length;A<w;A++){z=d[A];B=a.wijmo.wijgrid.bounds(z.element);y=a.ui.isOver(x.y,x.x,B.top,B.left+B.width-q,B.height,q);if(y){return z}}return null}function m(w){return a.wijmo.wijgrid.stringFormat(n,w)}}})})(jQuery);(function(a){a.extend(a.wijmo.wijgrid,{frozener:function(l){var r,k,p,x,v="{0}."+l.widgetName+".frozener",d=false,w,h=null,b=null,m=null,y=null,j=a('<div class="wijmo-wijgrid-frozener-v ui-widget-header"></div>'),g=a('<div class="wijmo-wijgrid-frozener-h ui-widget-header"></div>'),E=null,f=null,o=l.outerDiv.find(".wijmo-wijgrid-fixedview"),C=10;this.refresh=function(){this.dispose();this.addVElement(l._getStaticIndex(false));this.addHElement(l._getStaticIndex(true));this.attachDivEvent()};this.attachDivEvent=function(){o.bind("mousemove",z).bind("mouseout",B).bind("mousedown",q)};this.addVElement=function(J){var I=a.wijmo.wijgrid.bounds(o.find(".wijmo-wijgrid-split-area-nw")),L=a.wijmo.wijgrid.bounds(o),K=l._view().getVisibleAreaBounds(),H=I.left+I.width;if(H<=K.left+K.width){j.css({left:H-L.left-1,top:I.top-L.top,width:"0px",height:K.height+K.top-I.top}).appendTo(o);r=l._getRealStaticColumnIndex(true);p=J}};this.addHElement=function(L){var H=a.wijmo.wijgrid.bounds(o.find(".wijmo-wijgrid-split-area-nw")),K=a.wijmo.wijgrid.bounds(o),J=l._view().getVisibleAreaBounds(),I=H.top+H.height;if(I<=J.top+J.height){g.css({left:H.left-K.left,top:I-K.top-1,width:J.width+J.left-H.left,height:"0px"}).appendTo(o);k=l._getRealStaticRowIndex(true);x=L}};this.dispose=function(){j.remove();g.remove();o.unbind("mousemove",z).unbind("mouseout",B).unbind("mousedown",q);i()};this.inProgress=function(){return d};function z(K){var I,H,J=l._view().getVisibleAreaBounds();if(!d){if(l._canInteract()&&a.ui.isOver(K.pageY,K.pageX,J.top,J.left,J.height,J.width)){I=a.wijmo.wijgrid.bounds(j);H=I.left+I.width/2;if(Math.abs(K.pageX-H)<C){o.css("cursor","pointer");return}I=a.wijmo.wijgrid.bounds(g);H=I.top+I.height/2;if(Math.abs(K.pageY-H)<C){o.css("cursor","pointer");return}B(K)}}}function B(H){if(!d){o.css("cursor","")}}function q(L){var I,H,K,J=l._view().getVisibleAreaBounds();if(l._canInteract()&&a.ui.isOver(L.pageY,L.pageX,J.top,J.left,J.height,J.width)){I=a.wijmo.wijgrid.bounds(j);H=I.left+I.width/2;if(Math.abs(L.pageX-H)<C){if(p===-1){h=m=-1}else{h=m=l._getRealStaticColumnIndex()-r}E=a('<div class="wijmo-wijgrid-resizehandle ui-widget-header"></div>');L.data={bVertical:true};a(document.body).append(E)}else{I=a.wijmo.wijgrid.bounds(g);H=I.top+I.height/2;if(Math.abs(L.pageY-H)<C){if(x===-1){b=y=-1}else{b=y=l._getRealStaticRowIndex()-k}f=a('<div class="wijmo-wijgrid-resizehandle ui-widget-header"></div>');L.data={bVertical:false};a(document.body).append(f)}}if(L.data){o.css("cursor","");w=document.body.style.cursor;document.body.style.cursor="pointer";s(L.data);d=true}}}function n(H){var I=l._view()._getSuperPanel();if(H.data.bVertical&&I.options.hScroller.scrollValue){I.hScrollTo(0)}else{if(!H.data.bVertical&&I.options.vScroller.scrollValue){I.vScrollTo(0)}}u(H)}function e(H){try{document.body.style.cursor=w;if(H.data.bVertical){E.remove();if(h!==m){l.option("staticColumnIndex",m)}}else{f.remove();if(b!==y){l.option("staticRowIndex",y)}}}finally{if(H.data.bVertical){E=null}else{f=null}i();d=false}}function G(H){H.preventDefault()}function s(H){if(!d){if(H.bVertical){a(document).bind(t("mousemove"),{bVertical:true},n).bind(t("mouseup"),{bVertical:true},e)}else{a(document).bind(t("mousemove"),{bVertical:false},n).bind(t("mouseup"),{bVertical:false},e)}a(document.body).disableSelection();if(a.browser.msie){a(document.body).bind("selectstart",G)}}}function i(){if(d){a(document).unbind(t("mousemove"),n).unbind(t("mouseup"),e);a(document.body).enableSelection();if(a.browser.msie){a(document.body).unbind("selectstart",G)}}}function u(M){var L,P,J,H,N,Q,K,O,I=l._view().getVisibleAreaBounds();if(M.data.bVertical){P=a.wijmo.wijgrid.bounds(j);J=P.left+P.width/2;if(Math.abs(M.pageX-J)<C){m=h;E.hide();return}L=F({x:M.pageX,y:M.pageY});if(L){P=a.wijmo.wijgrid.bounds(L.element);J=P.left+P.width/2;N=L.options.visLeavesIdx-r;Q=D(N);H=M.pageX<J?(Q!==h):(N===h);K=H?P.left:P.left+P.width;if(!a.ui.isOverAxis(K,I.left-1,I.width+2)){return}m=H?Q:N;E.show().css({left:K,top:P.top,width:3,height:I.height+I.top-P.top})}}else{P=a.wijmo.wijgrid.bounds(g);J=P.top+P.height/2;if(Math.abs(M.pageY-J)<C){y=b;f.hide();return}L=A({x:M.pageX,y:M.pageY});if(L){P=a.wijmo.wijgrid.bounds(L);J=P.top+P.height/2;N=l._view().getAbsoluteRowIndex(L)-k;Q=c(N);H=M.pageY<J?(Q!==b):(N===b);O=H?P.top:P.top+P.height;if(!a.ui.isOverAxis(O,I.top-1,I.height+2)){return}y=H?Q:N;f.show().css({left:P.left,top:O,width:I.width+I.left-P.left,height:3})}}}function D(H){return H>-1?H-1:-1}function c(H){return H>-1?H-1:-1}function F(J){var M=l.columns(),L=0,H=M.length,I,O,N,K;for(;L<H;L++){I=M[L];O=I.options;if(O.visible&&O.parentVis&&O.isLeaf){N=a.wijmo.wijgrid.bounds(I.element);K=a.ui.isOverAxis(J.x,N.left,N.width);if(K){return I}}}return null}function A(I){var M=l._rows(),K=M.length(),H=0,N,L,J;for(;H<K;H++){N=M.item(H)[0];L=a.wijmo.wijgrid.bounds(a(N));J=a.ui.isOverAxis(I.y,L.top,L.height);if(J){return N}}return null}function t(H){return a.wijmo.wijgrid.stringFormat(v,H)}}})})(jQuery);(function(a){a.extend(a.wijmo.wijgrid,{cellFormatterHelper:function(){this.format=function(k,i,h,j){if(j.type&a.wijmo.wijgrid.rowType.footer){if(i.aggregate&&(i.aggregate!=="none")){h=a.wijmo.wijgrid.stringFormat(i.footerText||"{0}",i._totalsValue||"")}else{h=i.footerText||i._footerTextDOM||""}}var f=true,e=null,g={$container:k,column:i,formattedValue:h,row:j,afterDefaultCallback:null};if(a.isFunction(i.cellFormatter)){f=!i.cellFormatter(g)}if(f){switch(i.dataType){case"boolean":e=c;break;default:e=b}if(e){e(g);if(a.isFunction(g.afterDefaultCallback)){g.afterDefaultCallback(g)}}}};function b(e){switch(e.row.type){case a.wijmo.wijgrid.rowType.filter:d(e);break;default:e.$container.html(e.formattedValue?e.formattedValue:"&nbsp;")}}function c(h){var i,k,f="disabled='disabled'",g,j,e=a.wijmo.wijgrid.rowType;switch(h.row.type){case e.data:case e.data|e.dataAlt:i=h.column.owner;k=i.options.allowEditing&&(h.column.readOnly!==true);if(k){f=""}if(i._parse(h.column,h.row.data[h.column.dataKey])===true){h.$container.html("<input class='wijgridinput' type='checkbox' checked='checked' "+f+" />")}else{h.$container.html("<input class='wijgridinput' type='checkbox' "+f+" />")}if(k){h.$container.children("input").bind("mousedown",function(l){g=h.$container.parent()[0];j=i.currentCell();if(j.tableCell()!==g){i._onClick({target:g})}if(!j._isEdit()){i.beginEdit()}}).bind("keydown",function(l){if(l.which===a.ui.keyCode.ENTER){i._endEditInternal(l);return false}})}break;default:b(h)}}function d(e){e.$container.addClass("ui-widget ui-state-default");if((e.column.dataIndex>=0)&&!e.column.isBand&&e.column.showFilter){e.$container.html('<div class="wijmo-wijgrid-filter ui-corner-all"><input type="text" class="wijmo-wijgrid-filter-input" style="width:1px" /><a class="wijmo-wijgrid-filter-trigger ui-corner-right ui-state-default" href="#"><span class="ui-icon ui-icon-triangle-1-s"></span></a></div>')}else{e.$container.html("&nbsp;")}}}})})(jQuery);(function(a){a.extend(a.wijmo.wijgrid,{dragAndDropHelper:function(j){var h="scope_"+new Date().getTime(),f=null,p=null,l=null,d=false,n,i='<div class="ui-widget wijmo-wijgrid ui-widget-content ui-corner-all"><table class="wijmo-wijgrid-root wijmo-wijgrid-table"><tr class="wijmo-wijgrid-headerrow"></tr></table></div>';this.attachGroupArea=function(q){var r;q.droppable({scope:h,tolerance:"pointer",greedy:true,accept:function(s){if(j.options.allowColMoving){r=e(s);if(r){if((r instanceof a.wijmo.c1groupedfield)&&(r.options.groupedIndex===j._field("groupedColumns").length-1)){return false}return !r.options.isBand&&(r.options.groupedIndex===undefined||(r instanceof a.wijmo.c1groupedfield))}}return false},drop:function(t,s){if(!m(t,s.draggable)&&(r=e(s.draggable))){d=true}},over:function(u,t){var s=j._field("groupedWidgets").length;n=(s>0);l=(s>0)?j._field("groupedWidgets")[s-1]:q;q.data("thisDroppableWijField",l)},out:function(t,s){if(l===q.data("thisDroppableWijField")){l=null}}})};this.attach=function(s){var q,r;if(!s||!(q=s.element)){return}q.draggable({helper:function(t){if(s instanceof a.wijmo.c1groupedfield){return q.clone().addClass("wijmo-wijgrid-dnd-helper")}else{return q.clone().wrap(i).width(q.width()).height(q.height()).closest(".wijmo-wijgrid").addClass("wijmo-wijgrid-dnd-helper")}},appendTo:"body",scope:h,drag:function(v,u){c();if(l&&!m(v,q)){var t=l.element;if(!t){t=l}o(t,b(s,l,v,u))}},start:function(y,x){if(j._canInteract()&&j.options.allowColMoving&&!j._field("resizer").inProgress()){var w=s.options,u=s.options.travIdx,v=(s instanceof a.wijmo.c1groupedfield),t=v?"groupArea":"columns";if(v){w=a.wijmo.wijgrid.search(j.columns(),function(z){return z.options.travIdx===u});w=(!w.found)?a.wijmo.wijgrid.getColumnByTravIdx(j.options.columns,u).found:w.found.options}if(s._canDrag()&&j._trigger("columnDragging",null,{drag:w,dragSource:t})){j._trigger("columnDragged",null,{drag:w,dragSource:t});return true}}return false},stop:function(u,t){c();try{if(d){if(!l.element){j._handleDragnDrop(s.options.travIdx,-1,"left",s instanceof a.wijmo.c1groupedfield,true)}else{j._handleDragnDrop(s.options.travIdx,l.options.travIdx,b(s,l,u,t),s instanceof a.wijmo.c1groupedfield,l instanceof a.wijmo.c1groupedfield)}}}finally{l=null;d=false}}}).droppable({hoverClass:"ui-state-hover",scope:h,tolerance:"pointer",greedy:true,accept:function(t){if(j.options.allowColMoving){if(q[0]!==t[0]){r=e(t);if(r){return r._canDropTo(s)}}}return false},drop:function(u,t){if(r=e(t.draggable)){d=true}},over:function(u,t){n=false;l=s;q.data("thisDroppableWijField",l)},out:function(u,t){if(l===s.element.data("thisDroppableWijField")){l=null}}})};this.detach=function(r){var q;if(r&&(q=r.element)){if(q.data("draggable")){q.draggable("destroy")}if(q.data("droppable")){q.droppable("destroy")}}};this.dispose=function(){if(p){p.remove();p=null}if(f){f.remove();f=null}};function e(q){var r=q.data(a.wijmo.c1basefield.prototype._data$prefix+"widgetName");if(!r){return q.data(a.wijmo.c1groupedfield.prototype._data$prefix)}else{return q.data(r)}}function o(r,q){g().show().position({my:"center",at:q+" top",of:r});k().show().position({my:"center",at:q+" bottom",of:r})}function c(){g().hide();k().hide()}function g(){if(!p){p=a("<div />").addClass("wijmo-wijgrid-dnd-arrow-top").append(a("<span />").addClass("ui-icon ui-icon-arrowthick-1-s")).hide().appendTo(document.body)}return p}function k(){if(!f){f=a("<div />").addClass("wijmo-wijgrid-dnd-arrow-bottom").append(a("<span />").addClass("ui-icon ui-icon-arrowthick-1-n")).hide().appendTo(document.body)}return f}function m(s,q){var r=a.wijmo.wijgrid.bounds(q,false);return((s.pageX>r.left&&s.pageX<r.left+r.width)&&(s.pageY>r.top&&s.pageY<r.top+r.height))}function b(u,s,v,w){if(!s.element){return"left"}if(n){return"right"}var q=a.wijmo.wijgrid.bounds(s.element,false),x=q.width/6,t=q.left+(q.width/2),y="right",r;if(v.pageX<t){y="left"}if(s instanceof a.wijmo.c1groupedfield){if(u instanceof a.wijmo.c1groupedfield){r=s.options.groupedIndex-u.options.groupedIndex;if(Math.abs(r)===1){y=(r<0)?"left":"right"}}return y}r=s.options.linearIdx-u.options.linearIdx;if(s.options.isBand&&(u.options.parentIdx!==s.options.travIdx)&&(Math.abs(v.pageX-t)<x)){return"center"}if(u.options.parentIdx===s.options.parentIdx&&Math.abs(r)===1){y=(r<0)?"left":"right"}return y}}})})(jQuery);(function(a){a.extend(a.wijmo.wijgrid,{cellStyleFormatterHelper:function(d){if(!d){throw"invalid arguments"}this.format=function(r,q,l,g,h,p,k){var j=a.wijmo.wijgrid.renderState,i=a.wijmo.wijgrid.rowType,n=g.type,o,m=null;if(q===0&&d.options.showRowHeader){l=null}if(n===i.groupHeader||n===i.groupFooter){l=null;if(p&&(m=p.groupInfo)){l=d._field("leaves")[m.leafIndex];delete p.groupInfo}}o={$cell:r,state:h,row:g,column:l,_cellIndex:q,_purpose:m?m.purpose:undefined};if(h===j.rendering){f(o,p,k)}else{e(o,h&j.current);b(o,h&j.selected)}if(a.isFunction(d.options.cellStyleFormatter)){d.options.cellStyleFormatter(o)}};function f(i,m,l){var g=a.wijmo.wijgrid.rowType,j,n,h=i.column,k=i.row.type;switch(k){case g.header:i.$cell.addClass("wijgridth");break;default:i.$cell.addClass("wijgridtd")}if(m){for(j in m){if(m.hasOwnProperty(j)){n=m[j];if((j==="colSpan"||j==="rowSpan")&&!(n>1)){continue}if(j==="class"){i.$cell.addClass(n)}else{i.$cell.attr(j,n)}}}}if(l){for(j in l){if(l.hasOwnProperty(j)){if(j==="paddingLeft"){i.$cell.children(".wijmo-wijgrid-innercell").css(j,l[j]);continue}i.$cell.css(j,l[j])}}}if(i._cellIndex===0&&d.options.showRowHeader){i.$cell.attr({role:"rowheader",scope:"row"}).addClass("ui-state-default ui-widget-content wijmo-wijgrid-rowheader")}else{switch(k){case (g.header):i.$cell.attr({role:"columnheader",scope:"col"});break;case (g.footer):i.$cell.attr({role:"columnfooter",scope:"col"});break;default:i.$cell.attr("role","gridcell")}}if(k&g.data){if(i._cellIndex>=0&&h&&h.dataParser){i.$cell.attr("headers",escape(h.headerText));if(h.readOnly){i.$cell.attr("aria-readonly",true)}if(h.dataIndex>=0){i.$cell.addClass("wijdata-type-"+(h.dataType||"string"))}}}if(k===g.groupHeader||k===g.groupFooter){if(h&&i._purpose===a.wijmo.wijgrid.groupRowCellPurpose.aggregateCell){i.$cell.addClass("wijdata-type-"+(h.dataType||"string"))}}}function e(h,i){var g=a.wijmo.wijgrid.rowType;if(i){h.$cell.addClass("ui-state-active");if(h.row.type===g.header){h.$cell.addClass("wijmo-wijgrid-current-headercell")}else{h.$cell.addClass("wijmo-wijgrid-current-cell")}}else{h.$cell.removeClass("ui-state-active");if(h.row.type===g.header){h.$cell.removeClass("wijmo-wijgrid-current-headercell")}else{h.$cell.removeClass("wijmo-wijgrid-current-cell")}}}function c(g,h){if(h){}else{}}function b(g,h){if(h){g.$cell.addClass("ui-state-highlight").attr("aria-selected","true")}else{g.$cell.removeClass("ui-state-highlight").removeAttr("aria-selected")}}}})})(jQuery);(function(a){a.extend(a.wijmo.wijgrid,{rowStyleFormatterHelper:function(d){if(!d){throw"invalid arguments"}this.format=function(l,g,i){var h=a.wijmo.wijgrid.renderState,k=l.state,j=l;if(k===h.rendering){f(j,g,i)}else{e(j,k&h.current);c(j,k&h.hovered);b(j,k&h.selected)}if(a.isFunction(d.options.rowStyleFormatter)){d.options.rowStyleFormatter(j)}};function f(k,h,i){var m="wijmo-wijgrid-row ui-widget-content",j="wijmo-wijgrid-row ui-widget-content",g=a.wijmo.wijgrid.rowType,l;k.$rows.attr("role","row");if(h){for(l in h){if(h.hasOwnProperty(l)){if(l==="class"){k.$rows.addClass(h[l])}else{k.$rows.attr(l,h[l])}}}}if(i){for(l in i){if(i.hasOwnProperty(l)){k.$rows.css(l,i[l])}}}switch(k.type&~g.dataAlt){case (g.header):m="wijmo-wijgrid-headerrow";break;case (g.data):m=j+" wijmo-wijgrid-datarow";if(k.type&g.dataAlt){m+=" wijmo-wijgrid-alternatingrow"}break;case (g.emptyDataRow):m=j+" wijmo-wijgrid-emptydatarow";break;case (g.filter):m="wijmo-wijgrid-filterrow";break;case (g.groupHeader):m=j+" wijmo-wijgrid-groupheaderrow";break;case (g.groupFooter):m=j+" wijmo-wijgrid-groupfooterrow";break;case (g.footer):m="wijmo-wijgrid-footerrow ui-state-highlight";break;default:throw a.wijmo.wijgrid.stringFormat("unknown rowType: {0}",k.row.type)}k.$rows.addClass(m)}function e(h,g){if(d.options.showRowHeader){if(g){a(h.$rows[0].cells[0]).addClass("ui-state-active wijmo-wijgrid-current-rowheadercell")}else{a(h.$rows[0].cells[0]).removeClass("ui-state-active wijmo-wijgrid-current-rowheadercell")}}}function c(h,g){if(g){h.$rows.addClass("ui-state-hover")}else{h.$rows.removeClass("ui-state-hover")}}function b(h,g){if(g){}else{}}}})})(jQuery);(function(a){a.extend(a.wijmo.wijgrid,{tally:function(){var g=0,b=0,j=0,h=0,i=0,d=0,f,e;this.add=function(k){if(k===null||k===""){return}h++;if(typeof(k)==="string"){if((f===undefined)||(k<f)){f=k}if((e===undefined)||(k>e)){e=k}}if(typeof(k)==="number"){if(j===0){d=k;i=k}j++;g+=k;b+=k*k;if(k<d){d=k}if(k>i){i=k}}};this.getValueString=function(k){if(j){var l=c(k.aggregate),m=k.owner;return m._toStr(k,l)}if(h){switch(k.aggregate){case"max":return e;case"min":return f;case"count":return h.toString()}}return""};function c(l){switch(l){case"average":return(j===0)?0:g/j;case"count":return h;case"max":return i;case"min":return d;case"sum":return g;case"std":if(j<=1){return 0}return Math.sqrt(c("var"));case"stdPop":if(j<=1){return 0}return Math.sqrt(c("varPop"));case"var":if(j<=1){return 0}return c("varPop")*j/(j-1);case"vapPop":if(j<=1){return 0}var k=g/j;return b/j-k*k}return 0}}})})(jQuery);(function(a){a.extend(a.wijmo.wijgrid,{columnsGenerator:function(e){this.generate=function(h,f,g){switch(h){case"append":c(f,g);break;case"merge":b(f,g);break;default:throw a.wijmo.wijgrid.stringFormat('Unsupported value: "{0}"',h)}};function c(h,k){var l=h.getFieldNames(),j,f,g;for(j=0,f=l.length;j<f;j++){g=d(l[j]);k.push(g)}}function b(f,h){var p=[],l=f.getFieldNames(),g={},j,m,k,o,n;for(j=0,m=l.length;j<m;j++){g[o=l[j]]=o}a.wijmo.wijgrid.traverse(h,function(i){if(i.isLeaf&&!i.isBand){k=i.dataKey;if(a.wijmo.wijgrid.validDataKey(k)){if(g[k]!==undefined){delete g[k]}}else{if(k!==null){p.push(i)}}}});if(p.length){j=0;for(k in g){if(g.hasOwnProperty(k)){n=p[j++];if(n){n.dataKey=g[k];delete g[k]}}}}for(k in g){if(g.hasOwnProperty(k)){n=d(g[k]);h.push(n)}}}function d(f){return a.wijmo.wijgrid.createDynamicField({dataKey:f})}}})})(jQuery);