/*
 *
 * Wijmo Library 2.3.7
 * http://wijmo.com/
 *
 * Copyright(c) GrapeCity, Inc.  All rights reserved.
 * 
 * Licensed under the Wijmo Commercial License. Also available under the GNU GPL Version 3 license.
 * licensing@wijmo.com
 * http://wijmo.com/widgets/license/
 *
 *
 **/
var __extends=this.__extends||function(b,c){function a(){this.constructor=b}a.prototype=c.prototype;b.prototype=new a},wijmo;(function(a){"use strict";var b=jQuery,d=function(d){__extends(c,d);function c(){d.apply(this,arguments)}c.prototype._createTextProvider=function(){this._textProvider=new e(this,this.options.type);this._textProvider._nullvalue=this.element.val()===""&&this.options.value===null};c.prototype._beginUpdate=function(){var a=this.options;this.element.addClass("wijmo-wijinput-numeric");this.element.data({defaultValue:a.value,preValue:a.value}).attr({"aria-valuemin":a.minValue,"aria-valuemax":a.maxValue,"aria-valuenow":a.value||0})};c.prototype._setOption=function(b,a){d.prototype._setOption.call(this,b,a);switch(b){case"minValue":this.element.attr("aria-valuemin",a);this._updateText();break;case"maxValue":this.element.attr("aria-valuemax",a);this._updateText();break;case"value":this.setValue(a);this._updateText();break;case"showGroup":case"decimalPlaces":case"culture":this._textProvider.updateStringFormat();this._updateText()}};c.prototype._setData=function(a){this.setValue(a)};c.prototype._resetData=function(){var a=this.element.data("defaultValue");if(a===undefined||a===null){a=this.element.data("elementValue");if(a===undefined||a===null&&a==="")a=0}this.setValue(a)};c.prototype._validateData=function(){!this._textProvider.checkAndRepairBounds(true,false)&&this._updateText()};c.prototype._raiseDataChanged=function(){var a=this.options.value,b=this.element.data("preValue");this.element.data("preValue",a);if(b!==a){this.element.attr("aria-valuenow",a);this._trigger("valueChanged",null,{value:a})}};c.prototype.getValue=function(){var a=this._textProvider.getValue();if(a===undefined||a===null)a=this.getText();return a};c.prototype.setValue=function(a,b){if(typeof b==="undefined")b=false;try{b=!!b;if(typeof a==="boolean")a=a?"1":"0";else if(typeof a==="string")a=this._textProvider.tryParseValue(a);if(this._textProvider.setValue(a))this._updateText();else if(b){var c="",d;c=this.getText();this.setText(a);a=a.trim();d=this.getText().trim();d!==a&&this.setText(c)}else this.setText(a);return true}catch(e){return false}};c.prototype.isValueNull=function(){try{return this._textProvider.isValueNull()}catch(a){return true}};c.prototype.getPostValue=function(){if(!this._isInitialized())return this.element.val();if(this.options.showNullText&&this.isValueNull())return"0";var a=this.options.value?this.options.value:0;if(this.options.type==="percent")a=(a/100).toFixed(10);return a.toString()};c.prototype._updateText=function(a){if(typeof a==="undefined")a=false;if(!this._isInitialized())return;this.options.value=this._textProvider.getValue();d.prototype._updateText.call(this,a);!this._textProvider.checkAndRepairBounds(false,false)&&this._trigger("valueBoundsExceeded")};c.prototype._doSpin=function(f,e){if(!this._allowEdit())return false;if(e&&this.element.data("breakSpinner"))return false;var d=this.element.wijtextselection(),c=new a.wijInputResult;if(this.element.data("focusNotCalledFirstTime")!==-9&&+new Date-this.element.data("focusNotCalledFirstTime")<600){this.element.data("focusNotCalledFirstTime",-9);this.element.data("prevCursorPos",0)}if(this.element.data("prevCursorPos")===-1)this.element.data("prevCursorPos",d.start);else d.start=this.element.data("prevCursorPos");c.testPosition=d.start;this._textProvider[f?"incEnumPart":"decEnumPart"](d.start,c,this.options.increment);this._updateText();this.element.data("prevCursorPos",c.testPosition);this.selectText(c.testPosition,c.testPosition);e&&!this.element.data("breakSpinner")&&window.setTimeout(b.proxy(function(){this._doSpin(f,true)},this),this._calcSpinInterval());return true};c.prototype._deleteSelText=function(b){if(typeof b==="undefined")b=false;var a=this.element.wijtextselection(),e=a.start===0&&a.end===this.element.val().length,c;if(a.start===a.end)if(!b){c=this._textProvider._stringFormat._currentText;if(c.charAt(a.end)===this._textProvider.getGroupSeparator()||c.charAt(a.end)===this._textProvider.getDecimalSeparator()){a.start++;a.end++;this.element.wijtextselection(a);return}}d.prototype._deleteSelText.call(this,b);if(e){this._textProvider._nullvalue=true;this._updateText(true)}};return c}(a.wijinputcore);d.prototype.options=b.extend(true,{},a.wijinputcore.prototype.options,{type:"numeric",value:null,minValue:-1e9,maxValue:1e9,showGroup:false,decimalPlaces:2,increment:1,valueChanged:null,valueBoundsExceeded:null});b.widget("wijmo.wijinputnumber",d.prototype);var e=function(e){__extends(d,e);function d(a,b){e.call(this);this._type="numeric";this._stringFormat=null;this._nullvalue=false;this.inputWidget=a;this._type=b;this._stringFormat=new c(this._type,this.inputWidget.options.decimalPlaces,this.inputWidget.options.showGroup,this._getCulture());this._stringFormat._setValueFromJSFloat(this.getValue())}d.prototype._getCulture=function(){return this.inputWidget._getCulture()};d.prototype.getDecimalSeparator=function(){return this._getCulture().numberFormat["."]};d.prototype.getGroupSeparator=function(){return this._getCulture().numberFormat[","]};d.prototype.tryParseValue=function(a){return this._stringFormat.tryParseValue(a)};d.prototype.toString=function(){return this.inputWidget.options.showNullText&&!this.inputWidget.isFocused()&&this.isValueNull()?this.inputWidget.options.nullText:this._stringFormat.getFormattedValue()};d.prototype.isValueNull=function(){var a=this.inputWidget.options,b=a.minValue;return null===a.value||undefined===a.value||b===a.value||this._nullvalue};d.prototype.set=function(a,b){this.clear();this.insertAt(a,0,b);return true};d.prototype.clear=function(){this._stringFormat.clear()};d.prototype.checkAndRepairBounds=function(a,d){var c=true,b,e;if(typeof a==="undefined")a=false;b=this.inputWidget.options.minValue;e=this.inputWidget.options.maxValue;if(typeof d!=="undefined"&&d)return this._stringFormat.checkMinValue(b,false,true);if(!this._stringFormat.checkMinValue(b,a,false))c=false;if(!this._stringFormat.checkMaxValue(e,a))c=false;this.inputWidget.options.decimalPlaces>=0&&this._stringFormat.checkDigitsLimits(this.inputWidget.options.decimalPlaces);return c};d.prototype.countSubstring=function(c,b){var d=0,a=c.indexOf(b);while(a!==-1){d++;a=c.indexOf(b,a+1)}return d};d.prototype.getAdjustedPositionFromLeft=function(a){for(var e=this._stringFormat._currentText,c,d=0;d<e.length;d++){c=e.charAt(d);if(!b.wij.charValidator.isDigit(c)&&c!==this.getGroupSeparator()&&c!==this.getDecimalSeparator()||c==="0"){if(this._stringFormat.isZero()){if(a<d)a++}else if(a<=d)a++}else break}return a};d.prototype.getDecimalSeparatorPos=function(){var a=this._stringFormat._currentText;return a.indexOf(this.getDecimalSeparator())};d.prototype.removeLeadingZero=function(a){var b=0;if(a.charAt(b)===" "||a.charAt(b)===this._getCulture().numberFormat.currency.symbol)b++;while(a.charAt(b)==="0")a=a.substr(0,b)+a.substr(b+1);return a};d.prototype.insertAt=function(c,e,d){var p=this._getCulture().numberFormat,k,h,g,f,i,j,m,l,n,o;if(!d)d=new a.wijInputResult;else this._nullvalue=false;if(c.length===1){if(c==="+"){this._stringFormat.setPositiveSign();this.checkAndRepairBounds(true,false);return true}if(c==="-"||c===")"||c==="("){this._stringFormat.invertSign();this.checkAndRepairBounds(true,false);d.testPosition=e;if(this._stringFormat.isNegative())d.testPosition=e;else d.testPosition=e-2;return true}if(!b.wij.charValidator.isDigit(c)){if(c===this.getDecimalSeparator()){k=this.getDecimalSeparatorPos();if(k>=0){d.testPosition=k;return true}}if(c!==this.getGroupSeparator()&&c!==this.getDecimalSeparator()&&c!==")"&&c!=="+"&&c!=="-"&&c!=="("&&c!==this.getDecimalSeparator())if(this._type==="percent"&&c===p.percent.symbol){d.testPosition=e;return true}else if(this._type==="currency"&&c===p.currency.symbol){d.testPosition=e;return true}else return false}}e=this.getAdjustedPositionFromLeft(e);h=e;g=this._stringFormat._currentText;if(h>g.length)h=g.length-1;f=this.removeLeadingZero(g.substring(0,h));i=g.substring(h,g.length);if(this._stringFormat.isZero())i=i.replace(/0/,"");d.testPosition=f.length+c.length-1;this._stringFormat.deFormatValue(f+c+i);j=this._stringFormat._currentText;try{if(this.inputWidget.options.showGroup){m=this.countSubstring(f,this._stringFormat._groupSeparator);l=this.countSubstring(j.substring(0,f.length+c.length),this._stringFormat._groupSeparator);d.testPosition+=l-m}else if(c.length===1){n=f.charAt(f.length-1);o=j.charAt(d.testPosition-1);if(o!==n)d.testPosition--}}catch(q){}return true};d.prototype.removeAt=function(e,f,c,k){if(typeof c==="undefined")c=new a.wijInputResult;if(typeof k==="undefined")k=false;var l=this._getCulture().numberFormat,d,h,b,g,j,i;c.testPosition=e;try{d=this._stringFormat._currentText;if(e===f&&d.substring(e,f+1)===this.getDecimalSeparator())return false;h=d.slice(0,e);b=h;g=d.slice(e,f+1).indexOf(this.getDecimalSeparator())>=0;if(g)b+=this.getDecimalSeparator();b+=d.slice(f+1);b=b||"0";this._stringFormat.deFormatValue(b);b=this._stringFormat._currentText;this._nullvalue=false;if(this.inputWidget.options.showGroup)if(g)c.testPosition=b.indexOf(this.getDecimalSeparator());else try{j=this.countSubstring(h,this._stringFormat._groupSeparator);i=this.countSubstring(b.substring(0,Math.max(0,e-1)),this._stringFormat._groupSeparator);c.testPosition-=j-i;if(d.indexOf(l.currency.symbol)===c.testPosition||d.indexOf(l.percent.symbol)===c.testPosition)c.testPosition++}catch(m){}return true}catch(n){}return true};d.prototype.incEnumPart=function(d,b,c){if(!b)b=new a.wijInputResult;this._stringFormat.increment(c);this._nullvalue=false;return this.checkAndRepairBounds(true,false)};d.prototype.decEnumPart=function(d,b,c){if(!b)b=new a.wijInputResult;this._stringFormat.decrement(c);this._nullvalue=false;return this.checkAndRepairBounds(true,false)};d.prototype.getValue=function(){return this._stringFormat.getJSFloatValue()};d.prototype.setValue=function(a){try{this._stringFormat._setValueFromJSFloat(a);this.checkAndRepairBounds(true,false);return true}catch(b){return false}};d.prototype.updateStringFormat=function(){var a="0";if(typeof this._stringFormat!=="undefined")a=this._stringFormat._currentValueInString;this._stringFormat=new c(this._type,this.inputWidget.options.decimalPlaces,this.inputWidget.options.showGroup,this._getCulture());this._stringFormat._currentValueInString=a};return d}(a.wijTextProvider),c=function(){function a(d,a,b,c){this.type=d;this.digitsPlaces=a;this.showGroup=b;this.culture=c;this._currentValueInString="0";this._currentText="0";this._groupSeparator=" "}a.prototype.decimalSeparator=function(){return this.culture.numberFormat["."]};a.prototype.isNegtive=function(a){return a.indexOf("-")!==-1||a.indexOf("(")!==-1};a.prototype.stripValue=function(a){var b=this.culture.numberFormat,h=this.isNegtive(a),d,e,c,g,f;a=a.replace("(","");a=a.replace(")","");a=a.replace("-","");a=a.replace(b.percent.symbol,"");a=a.replace(b.currency.symbol,"");d=b[","];e=b["."];switch(this.type){case"percent":d=b.percent[","];e=b.percent["."];break;case"currency":d=b.currency[","];e=b.currency["."]}this._groupSeparator=d;c=new RegExp("["+d+"]","g");a=a.replace(c,"");c=new RegExp("["+e+"]","g");a=a.replace(c,".");c=new RegExp("[ ]","g");a=a.replace(c,"");try{g=new RegExp("([\\d\\.])+");f=g.exec(a);if(f)a=f[0];if(h)a="-"+a;return a}catch(i){}return null};a.prototype.tryParseValue=function(b){b=this.stripValue(b);if(b===null)return 0;var a;try{a=parseFloat(b);if(isNaN(a))a=0}catch(c){a=0}return a};a.prototype.deFormatValue=function(a){a=this.stripValue(a);if(a===null)return;this._currentValueInString=a;this._currentText=this.formatValue(a)};a.prototype.formatValue=function(c){c=""+c+"";var a=this.culture.numberFormat,j=this.digitsPlaces,h=" ",e=".",f=2,i=this.isNegtive(c),d=new Array(3),g,b;d.push(3);g="n";switch(this.type){case"numeric":g=i?a.pattern[0]:"n";h=a[","];e=a["."];f=a.decimals;d=a.groupSizes;break;case"percent":g=a.percent.pattern[i?0:1];h=a.percent[","];e=a.percent["."];f=a.percent.decimals;d=a.percent.groupSizes;break;case"currency":g=a.currency.pattern[i?0:1];h=a.currency[","];e=a.currency["."];f=a.currency.decimals;d=a.currency.groupSizes}if(j!==-2)f=j;if(!this.showGroup)d=[0];c=c.replace(new RegExp("^[0]+"),"");b=this.formatDigit(c,h,e,f,d);b=b.replace(new RegExp("^[0]+"),"");if(b.indexOf(e)===0)b="0"+b;if(b==="")b="0";this._currentValueInString=c;this._currentText=this.applyFormatPattern(g,b,a.percent.symbol,a.currency.symbol);return this._currentText};a.prototype.getFormattedValue=function(){return this.formatValue(this._currentValueInString)};a.prototype.getJSFloatValue=function(){try{return this._currentValueInString===""?0:parseFloat(this._currentValueInString)}catch(a){return Number.NaN}};a.prototype.clear=function(){this._currentValueInString="0";this._currentText="0"};a.prototype._setValueFromJSFloat=function(a){try{this._currentValueInString=""+a+"";this.formatValue(a);return true}catch(b){return false}};a.prototype.isZero=function(c){if(typeof c==="undefined")c=this._currentValueInString;try{var a=c.replace("-",""),b;a=a.replace("(","");a=a.replace(")","");if(!a.length)a="0";b=parseFloat(a);if(!isNaN(b)&&!b)return true}catch(d){}return false};a.prototype.setPositiveSign=function(){this._currentValueInString=this._currentValueInString.replace("-","");this._currentValueInString=this._currentValueInString.replace("(","");this._currentValueInString=this._currentValueInString.replace(")","")};a.prototype.isNegative=function(){return this._currentValueInString.indexOf("-")!==-1||this._currentValueInString.indexOf("(")!==-1};a.prototype.invertSign=function(){var a=this.isNegative();if(a)this.setPositiveSign();else this._currentValueInString=!this._currentValueInString.length?"0":"-"+this._currentValueInString;if(this.isZero())this._currentValueInString=a?"0":"-0";this.formatValue(this._currentValueInString)};a.prototype.parseNumber=function(a){if(typeof a==="undefined")a=this._currentValueInString;var b=a.split(".",2);return{decimal:parseInt(b[0],10)||0,fraction:(b.length>1?parseInt(b[1],10):0)||0}};a.prototype._change=function(b){var a=this.parseNumber();this._currentValueInString=""+(a.decimal+b)+"."+a.fraction};a.prototype.increment=function(a){if(typeof a==="undefined")a=1;this._change(a)};a.prototype.decrement=function(a){if(typeof a==="undefined")a=1;this._change(-a)};a.prototype.checkDigitsLimits=function(f){try{var a=this._currentValueInString.split("."),d,b,c,e;if(!a.length||a.length===1&&a[0]==="")return;d="";if(a.length>1)d=a[1];b="";for(c=0;c<f;c++){e="0";if(d.length>c)e=d.charAt(c);b=b+e}if(b.length>0)this._currentValueInString=a[0]+"."+b;else this._currentValueInString=a[0]}catch(g){}};a.prototype.checkMinValue=function(g,i,h){if(typeof h==="undefined")h=false;var e=true,a,b,c,d,f;try{a=this._currentValueInString.split(".");b=parseFloat(a[0]===""||a[0]==="-"?"0":a[0]);c=0;if(a.length>1&&parseFloat(a[1])>0)c=parseFloat("1."+a[1]);if(b<0||a[0]==="-")c=c*-1;g=""+g+"";a=g.split(".");d=parseFloat(a[0]);f=0;if(a.length>1&&parseFloat(a[1])>0)f=parseFloat("1."+a[1]);if(b>d)return true;if(b<d||h&&b===d&&c<=f)e=false;else if(b===d&&b<0&&c>f)e=false;else if(b===d&&b>=0&&c<f)e=false;if(!e&&i)this._currentValueInString=""+g+""}catch(j){}return e};a.prototype.checkMaxValue=function(g,h){var d=true,a,b,c,e,f;try{a=this._currentValueInString.split(".");b=parseFloat(a[0]===""||a[0]==="-"?"0":a[0]);c=0;if(a.length>1&&parseFloat(a[1])>0)c=parseFloat("1."+a[1]);if(b<0||a[0]==="-")c=c*-1;g=""+g+"";a=g.split(".");e=parseFloat(a[0]);f=0;if(a.length>1&&parseFloat(a[1])>0)f=parseFloat("1."+a[1]);if(b<e)return true;if(b>e)d=false;if(b===e&&b>=0&&c>f)d=false;if(b===e&&b<0&&c<f)d=false;if(!d&&h)this._currentValueInString=""+g+""}catch(i){}return d};a.prototype.applyFormatPattern=function(f,e,d,c){var a=f,b=new RegExp("[n]","g");a=a.replace(b,e);b=new RegExp("[%]","g");a=a.replace(b,d);b=new RegExp("[$]","g");a=a.replace(b,c);return a};a.prototype.formatDigit=function(l,k,h,j,i){var a=""+l+"",c,b,e,g,f,d;a=a.replace("-","");a=a.replace("(","");a=a.replace(")","");c=a.indexOf(h);if(c===-1)c=a.indexOf(".");if(c===-1)c=a.indexOf(",");if(c===-1)c=a.length;b="";e=0;g=0;for(d=a.length-1;d>=0;d--){f=a.charAt(d);if(d<c){b=f+b;g++;if(g===i[e]*1&&i[e]*1&&d){b=k+b;g=0;if(i.length-1>e)e++}}}if(j>0){b=b+h;for(d=0;d<j;d++){f="0";if(d+c+1<a.length)f=a.charAt(d+c+1);b=b+f}}if(j===-1)if(c<a.length-1){b=b+h;b=b+a.substr(c+1)}return b};return a}()})(wijmo||(wijmo={}));