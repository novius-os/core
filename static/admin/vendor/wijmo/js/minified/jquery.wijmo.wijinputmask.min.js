/*
 *
 * Wijmo Library 2.3.7
 * http://wijmo.com/
 *
 * Copyright(c) GrapeCity, Inc.  All rights reserved.
 * 
 * Licensed under the Wijmo Commercial License. Also available under the GNU GPL Version 3 license.
 * licensing@wijmo.com
 * http://wijmo.com/widgets/license/
 *
 *
 **/
var __extends=this.__extends||function(b,c){function a(){this.constructor=b}a.prototype=c.prototype;b.prototype=new a},wijmo;(function(c){"use strict";var b=jQuery,a;(function(a){a._map=[];a.editOptional=1;a.editRequired=2;a.separator=4;a.literal=8})(a||(a={}));var d=function(b){__extends(a,b);function a(){b.apply(this,arguments)}a.prototype._createTextProvider=function(){this._textProvider=new e(this,this.options.mask,false)};a.prototype._checkMaskAndPassword=function(){var a=!this.options.mask||this.options.mask.length<0;if(a&&this._isPassword())throw'Option "passwordChar" requires a mask';};a.prototype._updateIsPassword=function(){var a=this.options.passwordChar.length>0&&this.element.attr("type")!=="password";this.element.data("isPassword",a);this._checkMaskAndPassword()};a.prototype._beginUpdate=function(){this.element.addClass("wijmo-wijinput-mask");this._updateIsPassword();this.element.data("defaultText",this.options.text)};a.prototype._setOption=function(c,a){b.prototype._setOption.call(this,c,a);switch(c){case"text":this.setText(a);break;case"mask":case"culture":if(typeof a==="undefined"||a.length<=0)return;this._checkMaskAndPassword();var d=this.getText();if(c==="mask"){this._textProvider.mask=a;this._textProvider.initialMask=a}this._textProvider.initialize();this._textProvider.set(d);this._updateText();break;case"promptChar":if(this._textProvider){this._textProvider.updatePromptChar();this._updateText()}break;case"hidePromptOnLeave":case"resetOnPrompt":this._updateText();break;case"passwordChar":this._updateIsPassword();this._updateText()}};a.prototype._resetData=function(){var a=this.element.data("defaultText");if(a===undefined||a===null)a=this.element.data("elementValue");if(a===undefined||a===null)a="";this.setText(a)};a.prototype._isPassword=function(){return!!this.element.data("isPassword")};a.prototype._getTextWithPrompts=function(){return!this._isInitialized()?this.element.val():this._textProvider.toString(true,true,false)};a.prototype._getTextWithLiterals=function(){return!this._isInitialized()?this.element.val():this._textProvider.toString(true,false,true)};a.prototype._getTextWithPromptAndLiterals=function(){return!this._isInitialized()?this.element.val():this._textProvider.toString(true,true,true)};a.prototype._getTextWithPromptAndLiteralsAndPassword=function(){return!this._isInitialized()?this.element.val():this._textProvider.toString(false,true,true)};a.prototype._onChange=function(){if(!this.element)return;var a=this.element.val(),b=this.getText();this.getText()!==a&&this._getTextWithPrompts()!==a&&this._getTextWithPromptAndLiterals()!==a&&this._getTextWithPromptAndLiteralsAndPassword()!==a&&this.setText(a)};a.prototype._afterFocused=function(){(this._isNullText()||!!this.options.hidePromptOnLeave)&&this._doFocus()};return a}(c.wijinputcore);d.prototype.options=b.extend(true,{},b.Widget.prototype.options,c.wijinputcore.prototype.options,{text:null,mask:"",promptChar:"_",hidePromptOnLeave:false,resetOnPrompt:true,allowPromptAsInput:false,passwordChar:"",resetOnSpace:true,skipLiterals:true});b.widget("wijmo.wijinputmask",d.prototype);var e=function(e){__extends(d,e);function d(a,c,b){e.call(this);this.inputWidget=a;this.mask=c;this.asciiOnly=b;this.testString="";this.assignedCharCount=0;this.requiredCharCount=0;this.noMask=false;this.descriptors=[];this.initialize()}d.prototype.initialize=function(){this.noMask=!this.mask||this.mask.length<=0;if(this.noMask)return;this.testString="";this.assignedCharCount=0;this.requiredCharCount=0;this.descriptors=new Array(0);for(var i="none",m=false,o=0,l,b,c=a.literal,d="",g,n,e,j,h=this.inputWidget._getCulture(),k=0;k<this.mask.length;k++){b=false;g=this.mask.charAt(k);if(m){m=false;b=true}if(!b){e=g;if(e<="C"){switch(e){case"#":case"9":case"?":case"C":g=this.getPromtChar();c=a.editOptional;b=true;break;case"$":d=h.numberFormat.currency.symbol;c=a.separator;b=true;break;case"%":case"-":case";":case"=":case"@":case"B":c=a.literal;b=true;break;case"&":case"0":case"A":g=this.getPromtChar();c=a.editRequired;b=true;break;case",":d=h.numberFormat[","];c=a.separator;b=true;break;case".":d=h.numberFormat["."];c=a.separator;b=true;break;case"/":d=h.calendars.standard["/"];c=a.separator;b=true;break;case":":d=h.calendars.standard[":"];c=a.separator;b=true;break;case"<":i="lower";continue;case">":i="upper";continue}if(!b){c=a.literal;b=true}}if(!b){if(e<="\\"){switch(e){case"L":g=this.getPromtChar();c=a.editRequired;b=true;break;case"\\":m=true;c=a.literal;continue}if(!b){c=a.literal;b=true}}if(!b){if(e==="a"){g=this.getPromtChar();c=a.editOptional;b=true}if(!b){if(e!=="|"){c=a.literal;b=true}if(!b){i="none";continue}}}}}if(b){j=new f(k,c);if(this.isEditDesc(j))j.caseConversion=i;if(c!==a.separator)d=g;for(l=0;l<d.length;l++){n=d.charAt(l);this.testString=this.testString+n;this.descriptors[this.descriptors.length]=j;o++}}}this.testString.Capacity=this.testString.length};d.prototype.getAllowPromptAsInput=function(){return!!this.inputWidget?this.inputWidget.options.allowPromptAsInput:false};d.prototype.getPasswordChar=function(){return!!this.inputWidget?this.inputWidget.options.passwordChar:"*"};d.prototype.isPassword=function(){return!!this.inputWidget?this.inputWidget._isPassword():false};d.prototype.getResetOnPrompt=function(){return!!this.inputWidget?this.inputWidget.options.resetOnPrompt:true};d.prototype.getResetOnSpace=function(){return!!this.inputWidget?this.inputWidget.options.resetOnSpace:true};d.prototype.getSkipLiterals=function(){return!!this.inputWidget?this.inputWidget.options.skipLiterals:true};d.prototype.getHidePromptOnLeave=function(){return!!this.inputWidget?this.inputWidget.options.hidePromptOnLeave:false};d.prototype._trueOR=function(a,b){return(a>>>1|b>>>1)*2+(a&1|b&1)};d.prototype.setValue=function(){return false};d.prototype.getValue=function(){return null};d.prototype.getPromtChar=function(){return!!this.inputWidget?this.inputWidget.options.promptChar:"_"};d.prototype.updatePromptChar=function(){if(this.noMask)return;for(var c,d=0;d<this.descriptors.length;d++){c=this.descriptors[d];if(c.charType===a.editOptional||c.charType===a.editRequired)if(!c.isAssigned)this.testString=b.wij.charValidator.setChar(this.testString,this.getPromtChar(),d)}};d.prototype.resetChar=function(c){var d=this.descriptors[c];if(this.isEditPos(c)&&d.isAssigned){d.isAssigned=false;this.testString=b.wij.charValidator.setChar(this.testString,this.getPromtChar(),c);this.assignedCharCount--;if(d.charType===a.editRequired)this.requiredCharCount--}};d.prototype.getAdjustedPos=function(a){if(this.noMask){if(a>=this.testString.length)a=this.testString.length-1}else if(a>=this.descriptors.length)a=a-1;return Math.max(0,a)};d.prototype.incEnumPart=function(){return!this.noMask};d.prototype.decEnumPart=function(){return!this.noMask};d.prototype.findNonEditPositionInRange=function(c,d,b){return this.findPositionInRange(c,d,b,this._trueOR(a.literal,a.separator))};d.prototype.findPositionInRange=function(a,b,e,f){a=Math.max(0,a);b=Math.min(b,this.testString.length-1);if(a<=b)while(a<=b){var c=e?a++:b--,d=this.descriptors[c];if((d.charType&4294967295&f&4294967295)===d.charType)return c}return-1};d.prototype.findAssignedEditPositionInRange=function(c,d,b){return this.assignedCharCount===0?-1:this.findEditPositionInRange(c,d,b,a.editRequired)};d.prototype.findEditPositionInRange=function(c,d,f,g){do{var b,e;b=this.findPositionInRange(c,d,f,this._trueOR(a.editRequired,a.editOptional));if(b===-1)break;e=this.descriptors[b];switch(g){case a.editOptional:if(!e.isAssigned)return b;break;case a.editRequired:if(e.isAssigned)return b;break;default:return b}if(f)c++;else d--}while(c<=d);return-1};d.prototype.findAssignedEditPositionFrom=function(d,c){if(!this.assignedCharCount)return-1;var a,b;if(c){a=d;b=this.testString.length-1}else{a=0;b=d}return this.findAssignedEditPositionInRange(a,b,c)};d.prototype.findEditPositionFrom=function(d,c){var a,b;if(c){a=d;b=this.testString.length-1}else{a=0;b=d}return this.findEditPositionInRange(a,b,c,0)};d.prototype.setChar=function(c,e,d){e=e<0?0:e;if(!d)d=this.descriptors[e];if(this.testEscapeChar(c,e,d))this.resetChar(e);else{if(b.wij.charValidator.isLetter(c))if(b.wij.charValidator.isUpper(c)){if(d.caseConversion==="lower")c=c.toLowerCase()}else if(d.caseConversion==="upper")c=c.toUpperCase();this.testString=b.wij.charValidator.setChar(this.testString,c,e);if(!d.isAssigned){d.isAssigned=true;this.assignedCharCount++;if(d.charType===a.editRequired)this.requiredCharCount++}}};d.prototype.internalInsertAt=function(i,f,a,l){if(i.length===0){a.testPosition=f;a.hint=a.noEffect;return true}if(!this._testString(i,f,a))return false;var b=this.findEditPositionFrom(f,true),h=this.findAssignedEditPositionInRange(b,a.testPosition,true)!==-1,m=this.findAssignedEditPositionFrom(this.testString.length-1,false),d,e,g,k,j;if(h&&a.testPosition===this.testString.length-1){a.hint=a.unavailableEditPosition;a.testPosition=this.testString.length;return false}d=this.findEditPositionFrom(a.testPosition+1,true);if(h){e=new c.wijInputResult;e.hint=e.unknown;g=true;while(g){g=false;if(d===-1){a.hint=a.unavailableEditPosition;a.testPosition=this.testString.length;return false}k=this.descriptors[b];if(k.isAssigned&&!this.testChar(this.testString.charAt(b),d,e)){a.hint=e.hint;a.testPosition=d;return false}if(b!==m){b=this.findEditPositionFrom(b+1,true);d=this.findEditPositionFrom(d+1,true);g=true;continue}}if(e.hint>a.hint)a.hint=e.hint}if(!l){if(h)while(b>=f){j=this.descriptors[b];if(j.isAssigned)this.setChar(this.testString.charAt(b),d);else this.resetChar(d);d=this.findEditPositionFrom(d-1,false);b=this.findEditPositionFrom(b-1,false)}this.setString(i,f)}return true};d.prototype.insertAt=function(d,a,b){if(typeof b==="undefined")b=new c.wijInputResult;if(d===undefined)throw"InsertAt: input";if(this.noMask){this.testString=this.testString.substring(0,a)+d+this.testString.substring(a,this.testString.length);b.testPosition=a+d.length-1;return true}if(a>=0&&a<this.testString.length)return this.internalInsertAt(d,a,b,false);b.testPosition=a;b.hint=b.positionOutOfRange;return false};d.prototype.clear=function(a){if(this.noMask){this.testString="";a.hint=a.success;return}if(!this.assignedCharCount)a.hint=a.noEffect;else{a.hint=a.success;for(var b=0;b<this.testString.length;b++)this.resetChar(b)}};d.prototype.isLiteral=function(b){return!b?false:b.charType!==a.literal?b.charType===a.separator:true};d.prototype.testEscapeChar=function(b,a,c){a=a<0?0:a;if(!c)c=this.descriptors[a];return this.isLiteral(c)?this.getSkipLiterals()?b===this.testString.charAt(a):false:(!this.getResetOnPrompt()||b!==this.getPromtChar())&&(!this.getResetOnSpace()||b!==" ")?false:true};d.prototype.testChar=function(c,e,a){if(!b.wij.charValidator.isPrintableChar(c)){a.hint=a.invalidInput;return false}var d=this.descriptors[e];if(!d)return false;if(this.isLiteral(d)){if(this.getSkipLiterals()&&c===this.testString.charAt(e)){a.hint=a.characterEscaped;return true}a.hint=a.nonEditPosition;return false}if(c===this.getPromtChar()){if(this.getResetOnPrompt()){if(this.isEditDesc(d)&&d.isAssigned)a.hint=a.sideEffect;else a.hint=a.characterEscaped;return true}if(!this.getAllowPromptAsInput()){a.hint=a.promptCharNotAllowed;return false}}if(c===" "&&this.getResetOnSpace()){if(this.isEditDesc(d)&&d.isAssigned)a.hint=a.sideEffect;else a.hint=a.characterEscaped;return true}switch(this.mask.charAt(d.maskPosition)){case"L":if(!b.wij.charValidator.isLetter(c)){a.hint=a.letterExpected;return false}if(!b.wij.charValidator.isAsciiLetter(c)&&this.asciiOnly){a.hint=a.asciiCharacterExpected;return false}break;case"a":if(!b.wij.charValidator.isAlphanumeric(c)&&c!==" "){a.hint=a.alphanumericCharacterExpected;return false}if(!b.wij.charValidator.isAciiAlphanumeric(c)&&this.asciiOnly){a.hint=a.asciiCharacterExpected;return false}break;case"?":if(!b.wij.charValidator.isLetter(c)&&c!==" "){a.hint=a.letterExpected;return false}if(b.wij.charValidator.isAsciiLetter(c)||!this.asciiOnly)break;a.hint=a.asciiCharacterExpected;return false;case"A":if(!b.wij.charValidator.isAlphanumeric(c)){a.hint=a.alphanumericCharacterExpected;return false}if(b.wij.charValidator.isAciiAlphanumeric(c)||!this.asciiOnly)break;a.hint=a.asciiCharacterExpected;return false;case"C":if(!b.wij.charValidator.isAscii(c)&&this.asciiOnly&&c!==" "){a.hint=a.asciiCharacterExpected;return false}break;case"9":if(!b.wij.charValidator.isDigit(c)&&c!==" "){a.hint=a.digitExpected;return false}break;case"#":if(!b.wij.charValidator.isDigit(c)&&c!=="-"&&c!=="+"&&c!==" "){a.hint=a.digitExpected;return false}break;case"&":if(!b.wij.charValidator.isAscii(c)&&this.asciiOnly){a.hint=a.asciiCharacterExpected;return false}break;case"0":if(!b.wij.charValidator.isDigit(c)){a.hint=a.digitExpected;return false}}if(c===this.testString.charAt(e)&&d.isAssigned)a.hint=a.noEffect;else a.hint=a.success;return true};d.prototype._testString=function(e,g,a){a.hint=a.unknown;a.testPosition=g;if(e.length){var b=new c.wijInputResult,d,f;b.testPosition=a.testPosition;b.hint=a.hint;for(d=0;d<e.length;d++){f=e.charAt(d);if(a.testPosition>this.testString.length){a.hint=a.unavailableEditPosition;return false}if(!this.testEscapeChar(f,a.testPosition)){a.testPosition=this.findEditPositionFrom(a.testPosition,true);if(a.testPosition===-1){a.testPosition=this.testString.length;a.hint=a.unavailableEditPosition;return false}}if(!this.testChar(f,a.testPosition,b)){a.hint=b.hint;return false}if(b.hint>a.hint)a.hint=b.hint;a.testPosition+=1;if(a.testPosition===this.testString.length)break}a.testPosition-=1}return true};d.prototype.set=function(b,a){if(typeof a==="undefined")a=new c.wijInputResult;if(b===undefined)throw"SetFromPos: input parameter is null or undefined.";a.hint=a.unknown;a.testPosition=0;if(!b.length){this.clear(a);return true}if(this.noMask){this.testString=b;return true}if(!this.testSetString(b,a.testPosition,a))return false;var d=this.findAssignedEditPositionFrom(a.testPosition+1,true);d!==-1&&this.resetString(d,this.testString.length-1);return true};d.prototype.resetString=function(a,b){if(this.noMask){this.testString="";return}a=this.findAssignedEditPositionFrom(a,true);if(a!==-1){b=this.findAssignedEditPositionFrom(b,false);while(a<=b){a=this.findAssignedEditPositionFrom(a,true);this.resetChar(a);a++}}};d.prototype.setString=function(d,a){for(var b,c=0;c<d.length;c++){b=d.charAt(c);if(!this.testEscapeChar(b,a))a=this.findEditPositionFrom(a,true);if(a<0||a>=this.testString.length)return;this.setChar(b,a);a++}};d.prototype.testSetString=function(a,b,c){if(a.length>this.testString.length)a=a.substring(0,this.testString.length);if(this._testString(a,b,c)){this.setString(a,b);return true}return false};d.prototype.toString=function(f,i,h,d,e){var k=this.inputWidget.options.text||"",o,n,l,p,c,q,j,g,m;k=b.trim(k);if(this.inputWidget.options.showNullText&&!this.inputWidget.isFocused()&&(k===""||k===this.inputWidget.options.nullText))return this.inputWidget.options.nullText;f=f===undefined?!this.isPassword():f;i=i===undefined?this.getHidePromptOnLeave()?this.inputWidget.isFocused():true:i;h=h===undefined?true:h;if(this.noMask){if(!f){o="";for(n=0;n<this.testString.length;n++)o+=this.getPasswordChar();return o}return this.testString}d=d===undefined?0:d;e=e===undefined?this.testString.length:e;if(e<=0)return"";if(d<0)d=0;if(d>=this.testString.length)return"";l=this.testString.length-d;if(e>l)e=l;if((!this.isPassword()||f)&&i&&h){p=this.testString.substring(d,e-d);return p}c="";q=d+e-1;for(j=d;j<=q;j++){g=this.testString.charAt(j);m=this.descriptors[j];switch(m.charType){case a.editOptional:case a.editRequired:if(!m.isAssigned)break;if(!this.isPassword()||f){c=c+g;continue}c=c+this.getPasswordChar();continue;case a.editRequired|a.editOptional:c=c+g;continue;case a.separator:case a.literal:if(!h)continue;c=c+g;continue;default:c=c+g;continue}if(i){c=c+g;continue}c=c+" ";continue}return c};d.prototype.isEditDesc=function(b){return this.noMask?true:b.charType!==a.editRequired?b.charType===a.editOptional:true};d.prototype.isEditPos=function(a){if(this.noMask)return true;if(a<0||a>=this.testString.length)return false;var b=this.descriptors[a];return this.isEditDesc(b)};d.prototype.internalRemoveAt=function(e,f,d,j){if(typeof j==="undefined")j=false;if(this.noMask){try{this.testString=this.testString.substring(0,e)+this.testString.substring(f+1,this.testString.length);d.testPosition=e}catch(r){}return true}var o=new c.wijInputResult,l,k,b,n,a,p,h,q,g,m,i=this.findAssignedEditPositionFrom(this.testString.length-1,false);b=this.findEditPositionInRange(e,f,true,0);d.hint=d.noEffect;if(b===-1||b>i){d.testPosition=e;return true}d.testPosition=e;n=f<i;if(this.findAssignedEditPositionInRange(e,f,true)!==-1)d.hint=d.success;if(n){a=this.findEditPositionFrom(f+1,true);p=a;e=b;h=true;while(h){h=false;l=this.testString.charAt(a);q=this.descriptors[a];if((l!==this.getPromtChar()||q.isAssigned)&&!this.testChar(l,b,o)){d.hint=o.hint;d.testPosition=b;return false}if(a!==i){a=this.findEditPositionFrom(a+1,true);b=this.findEditPositionFrom(b+1,true);h=true;continue}}if(d.sideEffect>d.hint)d.hint=d.sideEffect;if(j)return true;a=p;b=e;g=true;while(g){g=false;k=this.testString.charAt(a);m=this.descriptors[a];if(k===this.getPromtChar()&&!m.isAssigned)this.resetChar(b);else{this.setChar(k,b);this.resetChar(a)}if(a!==i){a=this.findEditPositionFrom(a+1,true);b=this.findEditPositionFrom(b+1,true);g=true;continue}}e=b+1}e<=f&&this.resetString(e,f);return true};d.prototype.removeAt=function(d,b,a){if(typeof b==="undefined")b=d;if(typeof a==="undefined")a=new c.wijInputResult;if(b>=this.testString.length){a.testPosition=b;a.hint=a.positionOutOfRange;return false}if(d>=0&&d<=b)return this.internalRemoveAt(d,b,a,false);a.testPosition=d;a.hint=a.positionOutOfRange;return false};return d}(c.wijTextProvider),f=function(){function a(b,a){this.maskPos=b;this.charType=a;this.caseConversion="none";this.isAssigned=false;this.maskPosition=0;this.maskPosition=b;this.charType=a}return a}()})(wijmo||(wijmo={}));