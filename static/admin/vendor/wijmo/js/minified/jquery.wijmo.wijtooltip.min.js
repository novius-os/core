/*
 *
 * Wijmo Library 2.3.7
 * http://wijmo.com/
 *
 * Copyright(c) GrapeCity, Inc.  All rights reserved.
 * 
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * licensing@wijmo.com
 * http://wijmo.com/widgets/license/
 *
 **/
(function(a){"use strict";var g="@wijtp@",b="wijmo-wijtooltip",e=b+"-arrow-",c=parseFloat,i=window,d=document,j=Math,h=j.max,f={};a.widget("wijmo.wijtooltip",{options:{content:"",title:"",closeBehavior:"auto",mouseTrailing:false,triggers:"hover",position:{my:"left bottom",at:"right top",offset:null},showCallout:true,animation:{animated:"fade",duration:500,easing:null},showAnimation:{},hideAnimation:{},showDelay:150,hideDelay:150,calloutAnimation:{duration:1e3,disabled:false,easing:null},calloutFilled:false,modal:false,group:null,ajaxCallback:null,showing:null,shown:null,hiding:null,hidden:null,cssClass:""},_setOption:function(c,f){var b=this,e="_set_"+c,d=b.options[c];a.Widget.prototype._setOption.apply(b,arguments);if(a.isPlainObject(f))b.options[c]=a.extend({},d,f);b[e]&&b[e](d)},_set_cssClass:function(){var c=this,d=c.options,b=d.cssClass,a=c._tooltip;if(!a)return;!a.hasClass(b)&&a.addClass(b)},_set_content:function(){var a=this;if(a._isAjaxCallback){a._callbacked=true;a.show();a._callbacked=false}else a._setText()},_create:function(){var c=this,e=c.options,h=c.element,j=h&&h.attr("id"),d="",f="",i=e.group||g,b=a.wijmo.wijtooltip._getTooltip(i);if(window.wijmoApplyWijTouchUtilEvents)a=window.wijmoApplyWijTouchUtilEvents(a);if(b)b.count++;else{b=c._createTooltip();b.count=0;a.wijmo.wijtooltip._tooltips[i]=b}f=e.cssClass?e.cssClass:"";!b.hasClass(f)&&b.addClass(f);e.position.of=c.element;c._bindLiveEvents();c._tooltip=b;if(j!==""){d=b.attr("aria-describedby");d=d===undefined?"":d+" ";b.attr("aria-describedby",d+j)}},destroy:function(){var b=this,c=b.element,d=b.options.group||g;c.unbind(".tooltip");c.attr("title",b._content);a.wijmo.wijtooltip._removeTooltip(d);a.Widget.prototype.destroy.apply(b)},widget:function(){return this._tooltip},show:function(){var c=this,b=c._tooltip,d=c.options;if(!b||d.disabled)return;if(b._showAnimationTimer){clearTimeout(b._showAnimationTimer);b._showAnimationTimer=null}if(b._showAtAnimationTimer){clearTimeout(b._showAtAnimationTimer);b._showAtAnimationTimer=null}if(b._hideAnimationTimer){clearTimeout(b._hideAnimationTimer);b._hideAnimationTimer=null}b.stop(true,true);if(d.ajaxCallback&&a.isFunction(d.ajaxCallback)&&!c._callbacked){c._isAjaxCallback=true;d.ajaxCallback.call(c.element);return}c._setText();b._showAnimationTimer=setTimeout(function(){f=b.offset();if(d.mouseTrailing){c._setCalloutCss();return}c._setPosition();c._showTooltip()},c.options.showDelay)},showAt:function(a){var e=this,b=e._tooltip,n=b&&b._callout,m={},k=0,l=0,o={},i,j,c,d,h,g;if(!b||!n)return;b.stop(true,true);if(b._showAtAnimationTimer){clearTimeout(b._showAtAnimationTimer);b._showAtAnimationTimer=null}if(b._hideAnimationTimer){clearTimeout(b._hideAnimationTimer);b._hideAnimationTimer=null}b._showAtAnimationTimer=setTimeout(function(){var p=b.is(":visible");e._setText();f=b.offset();b.offset({left:0,top:0}).show();m=n.position();k=m.left;l=m.top;j=e._getBorder(n);c=j.left||j.right;d=j.top||j.bottom;h=b.width();g=b.height();i=e._getCalloutShape();o=({rt:{left:a.x-h-c,top:a.y-l},rc:{left:a.x-h-c,top:a.y-g/2},rb:{left:a.x-h-c,top:a.y-l-d},lt:{left:a.x+c,top:a.y-l},lc:{left:a.x+c,top:a.y-g/2},lb:{left:a.x+c,top:a.y-l-d},tl:{left:a.x-k,top:a.y+d},tc:{left:a.x-h/2,top:a.y+d},tr:{left:a.x-k-c,top:a.y+d},bl:{left:a.x-k,top:a.y-g-d},bc:{left:a.x-h/2,top:a.y-g-d},br:{left:a.x-k-c,top:a.y-g-d},cc:{left:a.x-h/2,top:a.y-g/2}})[i];i=e._flipTooltip(o,i,j);e._setUnfilledCallout(i);b.offset(o);!p&&b.hide();e._calloutShape=i;e._showTooltip()},e.options.showDelay)},hide:function(){var c=this,b=c._tooltip;if(!b)return;if(b._showAnimationTimer){clearTimeout(b._showAnimationTimer);b._showAnimationTimer=null}if(b._showAtAnimationTimer){clearTimeout(b._showAtAnimationTimer);b._showAtAnimationTimer=null}if(b._hideAnimationTimer){clearTimeout(b._hideAnimationTimer);b._hideAnimationTimer=null}b._hideAnimationTimer=setTimeout(a.proxy(c._hideTooltip,c),c.options.hideDelay)},_createTooltip:function(){var g=this,k=g.options,e="ui-corner-all",h="ui-widget-content",l="ui-state-default",m="ui-widget-header",c=a("<div class = '"+b+" ui-widget "+h+" "+e+"'></div>"),i=a("<div class='"+b+"-container'></div>"),f=a("<div class='"+h+" "+b+"-pointer '><div class='"+b+"-pointer-inner'></div></div>"),j=a("<div class = '"+b+"-title "+m+" "+e+"'></title>"),d=a("<a href='#' class = '"+b+"-close "+l+" "+e+"'></a>");d.append(a("<span class = 'ui-icon ui-icon-close'></span>")).bind("click",a.proxy(g._onClickCloseBtn,g));k.closeBehavior!=="sticky"&&d.hide();!k.showCallout&&f.hide();c.append(j).append(d).append(i).append(f).css("position","absolute").attr("role","tooltip").appendTo("body").hide();c._container=i;c._callout=f;c._closeBtn=d;c._title=j;return c},_bindLiveEvents:function(){var b=this,d=b.options,c=b.element;if(b._content===undefined){b._content=c.attr("title");c.attr("title","")}c.unbind(".tooltip");d.mouseTrailing&&c.bind("mousemove.tooltip",function(a){if(d.disabled)return;var e=d.position.offset||"",c=e.split(" ");if(c.length===2)b.showAt({x:a.pageX+parseInt(c[0],10),y:a.pageY+parseInt(c[1],10)});else b.showAt({x:a.pageX,y:a.pageY})});switch(d.triggers){case"hover":c.bind("mouseover.tooltip",a.proxy(b.show,b)).bind("mouseout.tooltip",a.proxy(b._hideIfNeeded,b));break;case"click":c.bind("click.tooltip",a.proxy(b.show,b));break;case"focus":c.bind("focus.tooltip",a.proxy(b.show,b)).bind("blur.tooltip",a.proxy(b._hideIfNeeded,b));break;case"rightClick":c.bind("contextmenu.tooltip",function(a){b.show();a.preventDefault()})}},_hideIfNeeded:function(){var c=this,a=c.options,b=a.closeBehavior;if(b==="sticky"||a.modal||b==="none"||a.disabled)return;c.hide()},_flipTooltip:function(d,i,e){var h=this,c=h._tooltip,j={width:c.width(),height:c.height()},b=h._flipCallout(d,j,i),a=b&&b.flip,g,f;if(!c||!b||!a.h&&!a.v)return b.calloutShape;g=c.width();f=c.height();if(a.h==="l")d.left-=g+e.right*2+1;else if(a.h==="r")d.left+=g+e.left*2+1;else if(a.v==="t")d.top-=f+e.bottom*2+1;else if(a.v==="b")d.top+=f+e.top*2+1;return b.calloutShape},_flipCallout:function(g,k,b){var h=this,l=h.options,j=h._tooltip,c={h:false,v:false},f=a(i),d=(l.position.collision||"flip").split(" ");if(d.length===1)d[1]=d[0];if(!j||d[0]!=="flip"&&d[1]!=="flip")return{flip:c};if(d[0]==="flip")if(g.left<0||g.left+k.width>f.width()+f.scrollLeft())c.h=true;if(d[0]==="flip")if(g.top<0||g.top+k.height>f.height()+f.scrollTop())c.v=true;if(l.showCallout){if(c.h)if(b.indexOf("l")>-1){b=b.replace(/l/,"r");c.h="l"}else if(b.indexOf("r")>-1){b=b.replace(/r/,"l");c.h="r"}if(c.v)if(b.indexOf("t")>-1){b=b.replace(/t/,"b");c.v="t"}else if(b.indexOf("b")>-1){b=b.replace(/b/,"t");c.v="b"}if(c.h||c.v){h._removeCalloutCss();j.addClass(e+b)}}return{flip:c,calloutShape:b}},_set_position:function(b){var a=this,d=a.options,c=d.position;if(d.showCallout){(b.my!==c.my||b.at!==c.at)&&a._setPosition();a._setCalloutOffset(true)}a._setText()},_set_showCallOut:function(d){var c=this,b=c._tooltip,a=b&&b._callout;if(!b||!a)return;if(d){c._setCalloutCss();a.show()}else a.hide()},_set_closeBehavior:function(){var c=this,b=c._tooltip,a=b&&b._closeBtn;a&&a[c.options.closeBehavior==="sticky"?"show":"hide"]()},_set_triggers:function(){this._bindLiveEvents()},_set_mouseTrailing:function(){this._bindLiveEvents()},_getCalloutShape:function(){var g=this,e=g.options.position,f=function(b){return a.map(b,function(a){return a.substr(0,1)})},c=f(e.my.split(" ")),d=f(e.at.split(" ")),b=[];if(c.length===2)b=c;if(c[0]===d[0])(c[1]==="t"&&d[1]==="b"||c[1]==="b"&&d[1]==="t")&&b.reverse();else d[0]==="c"&&b.reverse();b[0]==="c"&&b.reverse();return b.join("")},_setCalloutCss:function(){var a=this,f=a.options,d=a._tooltip,c="",b="";if(!f.showCallout)return;a._removeCalloutCss();b=a._getCalloutShape();c=e+b;d&&d.addClass(c);return b},_removeCalloutCss:function(){var b=this._tooltip;b&&a.each(["tl","tc","tr","bl","bc","br","rt","rc","rb","lt","lc","lb","cc"],function(d,c){var a=e+c;if(b.hasClass(a)){b.removeClass(a);return false}})},_getBorder:function(d){var b={};a.each(["top","right","left","bottom"],function(e,a){b[a]=c(d.css("border-"+a+"-width"))});return b},_setPosition:function(){var e=this,m=e.options,d=m.position,a=e._tooltip,p=a.is(":hidden"),f=e._setCalloutCss(),n=f?f.split(""):null,b=[0,0],h="",g=a._callout,i,l,r,q,j,s={width:a.width(),height:a.height()},o,k;p&&a.show();a.css({left:0,top:0});if(m.showCallout){i=e._getBorder(g);r=c(g.css("left"));l=c(g.css("top"));q=c(g.css("right"));j=c(g.css("bottom"));switch(n[0]){case"l":b[0]=i.right;break;case"r":b[0]=-i.left;break;case"b":b[1]=j;break;case"t":b[1]=-l}switch(n[1]){case"t":b[1]=-l;break;case"b":b[1]=j;break;case"r":b[0]=q;break;case"l":b[0]=-r}h=b.join(" ")}a.position({my:d.my,at:d.at,of:d.of,offset:h,collision:"none none"});o=e._flipCallout(a.offset(),s,f);k=o.flip;if(k.h||k.v){a.css({left:0,top:0});a.position({my:d.my,at:d.at,of:d.of,offset:h,collision:d.collision})}m.showCallout&&e._setUnfilledCallout(f);e._calloutShape=f;p&&a.hide()},_setCalloutOffset:function(h){var g=this,k=g.options,j=g._tooltip,d=j&&j._callout,l=g._calloutShape,e=false,f=k.position.offset,c="",b=[],i=k.calloutAnimation;if(!d)return;if(!f||f.length===0)return;d.stop(true,true);a.each(["tr","tc","tl","bl","bc","br"],function(b,a){if(l===a){e=true;return false}});if(f){b=f.split(" ");if(b.length===2)c=e?b[0]:b[1];else if(b.length===1)c=b[0]}if(b&&b.length===2&&b[0]==="none"&&b[1]==="none")d.css("left","").css("top","");else if(c==="none")d.css(e?"left":"top","");else if(c!=="")if(h&&!h.disabled)d.animate(e?{left:c}:{top:c},i.duration,i.easing);else d.css(e?"left":"top",c)},_setUnfilledCallout:function(g){var e=this,c=e._tooltip,d=c&&c._callout,a=d&&d.children(),f=g.split(""),b=c&&c.css("background-color");if(!a)return;a.css({"border-left-color":"","border-top-color":"","border-bottom-color":"","border-right-color":""});if(!e.options.calloutFilled)switch(f[0]){case"l":a.css("border-right-color",b);break;case"t":a.css("border-bottom-color",b);break;case"r":a.css("border-left-color",b);break;case"b":a.css("border-top-color",b)}},_showTooltip:function(){var c=this,h=c.options,b=c._tooltip,d,e,g;if(!b)return;if(c._trigger("showing",null,c)===false)return;c._showModalLayer();b.css("z-index",99999);if(a.fn.wijshow){e={show:true,context:b};d=a.extend({},h.animation,h.showAnimation);if(b.is(":visible")){g=b.offset();b.offset(f);a.extend(e,{pos:g});d.animated="tooltipSlide"}b.wijshow(d,a.wijmo.wijtooltip.animations,e,null,function(){c._trigger("shown")})}else{b.show();c._trigger("shown")}c._setCalloutOffset(false)},_hideTooltip:function(){var b=this,e=b.options,c=b._tooltip,f=a.extend({},e.animation,e.hideAnimation),d;if(!c)return;if(b._trigger("hiding",null,b)===false)return;b._hideModalLayer();if(a.fn.wijhide){d={show:false,context:c};c.wijhide(f,a.wijmo.wijtooltip.animations,d,null,function(){b._trigger("hidden");c.css("z-index","")})}else{c.hide();b._trigger("hidden");c.css("z-index","")}},_getContent:function(b){var c={data:""},d;if(a.isFunction(b)){d=b.call(this.element,c);return c.data!==""?c.data:d}else if(window[b]&&a.isFunction(window[b])){d=window[b].call(this.element,c);return c.data!==""?c.data:d}return b},_setText:function(){var b=this,f=b.options,c=b._tooltip,a="",d="",e=c&&c._title;if(!c)return;a=b._getContent(f.content);a=a===""?b._content:a;c._container.html(a);d=b._getContent(f.title);if(d!=="")e.html(d).show();else e.hide()},_showModalLayer:function(){var b=this,c=null;if(b.options.modal){c=a("<div>").addClass("ui-widget-overlay").css("z-index",99e3).width(b._getDocSize("Width")).height(b._getDocSize("Height")).appendTo("body");a(window).bind("resize.wijtooltip",function(){c.width(b._getDocSize("Width")).height(b._getDocSize("Height"))});b._tooltip._modalLayer=c}},_hideModalLayer:function(){var c=this,b=c._tooltip._modalLayer;if(b){b.css("z-index","").remove();a(window).unbind("resize.wijtooltip")}},_getDocSize:function(b){var c,e,g="documentElement",f="body";if(a.browser.msie&&a.browser.version<9){c=h(d[g]["scroll"+b],d[f]["scroll"+b]);e=h(d[g]["offset"+b],d[f]["offset"+b]);return c<e?a(i)[b.toLowerCase()]()+"px":c+"px"}else return a(d)[b.toLowerCase()]()+"px"},_onClickCloseBtn:function(a){this.hide();a.preventDefault()}});a.extend(a.wijmo.wijtooltip,{animations:{fade:function(b,c){b=a.extend({duration:300,easing:"swing"},b,c);b.context.stop(true,true).animate(b.show?{opacity:"show"}:{opacity:"hide"},b)},tooltipSlide:function(b,c){b=a.extend({duration:300,easing:"swing"},b,c);b.context.stop(true,true).animate({left:b.pos.left,top:b.pos.top},b)}},_tooltips:{},_getTooltip:function(b){return a.wijmo.wijtooltip._tooltips[b]},_removeTooltip:function(c){var b=a.wijmo.wijtooltip._tooltips[c];if(b){b.count--;if(b.count<=0){b.remove();a.wijmo.wijtooltip._tooltips[c]=null}}}})})(jQuery);