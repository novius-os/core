/**
 * NOVIUS OS - Web OS for digital communication
 *
 * @copyright  2011 Novius
 * @license    GNU Affero General Public License v3 or (at your option) any later version
 *             http://www.gnu.org/licenses/agpl-3.0.html
 * @link http://www.novius-os.org
 */
define("jquery-nos-validate",["jquery","jquery.validate","wijmo.wijtooltip"],function(b){var a=function(g,h){var d=this;if(!d.counter){d.counter=1}var c=b(g);var e=this.errorsFor(g);if(e.length){e.removeClass(this.settings.validClass).addClass(this.settings.errorClass);e.closest(".wijmo-wijaccordion-content").prev().addClass(this.settings.errorClass)}else{e=b("<"+this.settings.errorElement+"/>").attr({"for":this.idOrName(g),generated:true}).addClass(this.settings.errorClass).css({background:"transparent",border:"0",padding:"0 4px",width:"32px",verticalAlign:"middle"}).html('<span class="ui-icon ui-icon-alert nos-inline-icon16"></span>');e.wijtooltip({group:"group_"+d.counter++,showCallout:false,calloutFilled:true,closeBehavior:"sticky",position:{my:"right top",at:"center bottom",offset:"0 0"},triggers:"click",content:h,showing:function(l,k){b(k.element).addClass("ui-state-error")}});if(!this.labelContainer.append(e).length){this.settings.errorPlacement?this.settings.errorPlacement(e,b(g)):e.insertAfter(g)}var f=e.data("wijmo-wijtooltip");f._tooltipCache._$tooltip.addClass("nos-tooltip-error");var i=f._tooltipCache._$tooltip;i.find(".wijmo-wijtooltip-close").click(function(){e.data("wijtooltip-manuallyclosed",true)}).removeClass("wijmo-wijtooltip-close").css({background:"none",border:"none",display:"block",height:"16px",position:"absolute",right:"3px",top:"3px",width:"16px"}).parent().removeClass("ui-state-default").addClass("ui-state-error");i.find(".wijmo-wijtooltip-container").addClass("ui-state-error ui-corner-all");e.click(function(){if(i.is(":hidden")&&!c.is(".media")){e.data("wijtooltip-manuallyclosed",false);e.wijtooltip("show")}else{e.data("wijtooltip-manuallyclosed",true);e.wijtooltip("hide")}});var j=b(g).closest(".wijmo-wijaccordion-content").prev().addClass(this.settings.errorClass).removeClass(this.settings.validClass);if(c.hasClass("media")){e.insertAfter(c.closest(".ui-inputfilethumb"));c.closest(".ui-inputfilethumb").find(".ui-inputfilethumb-thumb").addClass(this.settings.errorClass).removeClass(this.settings.validClass);c.bind("change.validation",function(){b(this).valid()})}j.closest(".wijmo-wijaccordion").unbind("wijaccordionselectedindexchanged").bind("wijaccordionselectedindexchanged",function(n,l){var m=b(this).find(".wijmo-wijaccordion-content");var k=m.eq(l.newIndex).find("label[generated=true]");if(k.data("wijtooltip-manuallyclosed")){}else{k.wijtooltip("show")}});j.closest(".wijmo-wijaccordion").bind("wijaccordionbeforeselectedindexchanged",function(m,k){var l=b(this).find(".wijmo-wijaccordion-content");l.eq(k.prevIndex).find("label[generated=true]").wijtooltip("hide")});if(e.is(":visible")){e.wijtooltip("show")}else{e.wijtooltip("hide")}}if(!h&&this.settings.success){e.wijtooltip("hide");e.wijtooltip("destroy");e.closest(".wijmo-wijaccordion-content").prev().addClass(this.settings.validClass).removeClass(this.settings.errorClass);if(c.hasClass("media")){c.closest(".ui-inputfilethumb").find(".ui-inputfilethumb-thumb").addClass(this.settings.validClass).removeClass(this.settings.errorClass);c.unbind("change.validation")}e.removeClass(this.settings.errorClass).addClass(this.settings.validClass);e.remove()}this.toShow=this.toShow.add(e)};b.extend(b.validator.prototype,{showLabel:a,optional:function(c){return !b.validator.methods.required.call(this,b.trim(c.value),c)}})});
define("jquery-nos-wysiwyg",["module","jquery-nos","jquery","tinymce"],function(a,b){b.fn.wysiwyg=function(e){var d=b(this),g={},c,j,f=1,h=[];var k=b("base").attr("href");b.each(e||{},function(i,m){if(i.substr(0,10)=="theme_nos_"){var l="theme_advanced_"+i.substr(10);if(!e[l]){g[l]=m}}else{g[i]=m}});if(g.theme==="advanced"){g.theme==="nos"}if(!g.theme_advanced_buttons1){g=b.extend({theme_advanced_toolbar_location:"external",theme_advanced_buttons1:"tablecontrols",theme_advanced_buttons2:"underline,strikethrough,sub,sup,|,forecolor,backcolor,|,outdent,indent,blockquote,|,anchor,charmap,hr,nonbreaking,nosbrclearall,|,styleprops,removeformat",theme_advanced_buttons3:"search,replace,|,spellchecker,|,newdocument,nosvisualhtml,code",theme_advanced_buttons4:"nosimage,mediawithlabel,noslink,nosenhancer",theme_advanced_buttons5:"nosstyleselect,bold,italic,nosalign,bullist,numlist,|,cut,copy,nospaste,undo,redo,|,nostoolbartoggle"},g)}e=b.extend({document_base_url:k,language:b.nosLang.substr(0,2),script_url:k+"static/novius-os/admin/vendor/tinymce/tiny_mce_jquery"+(a.config().minified?"":"_src")+".js"},g);c=e.plugins.split(",");j=e.theme_advanced_buttons1;while(j){h=h.concat(j.split(","));f++;j=e["theme_advanced_buttons"+f]}b.each(h,function(m,l){if(l.substr(0,3)==="nos"&&b.inArray(l,c)===-1){c.push(l)}});e.plugins=c.join(",");b(d).nosOnShow("one",function(){b(d).tinymce(e)})};return b});
define("jquery-nos",["jquery","jquery-nos-validate","jquery-form","jquery-ui.button","wijmo.wijexpander","wijmo.wijaccordion","wijmo.wijdialog","wijmo.wijmenu"],function($){var undefined=void (0),$nos=window.$nos=$,$noviusos=undefined,login_popup_opened=false,nosActionsList=[],noviusos=function(){if($noviusos===undefined){$noviusos=$(".nos-ostabs")}return $noviusos},dialogEvent={dialogOpened:[],dialogFocused:-1,open:function($dialog){var self=this,callbacks=$dialog.data("callbacks.nosdialog"),index=$.inArray($dialog[0],self.dialogOpened);if(index===-1){self.dialogOpened.push($dialog[0])}if(!$.isPlainObject(callbacks)){$dialog.data("callbacks.nosdialog",{})}},focus:function($dialog){var self=this,callbacks=$dialog.data("callbacks.nosdialog"),index=$.inArray($dialog[0],self.dialogOpened);if(index!==-1){self.dialogOpened.splice(index,1)}self.dialogOpened.push($dialog[0]);self.dialogFocused=$dialog[0];if($.isPlainObject(callbacks)){$.each(callbacks,function(i,event){self.fireDialogEvent($dialog,event)});$dialog.data("callbacks.nosdialog",{})}},close:function($dialog){var self=this,index=$.inArray($dialog[0],self.dialogOpened);if(index!==-1){self.dialogOpened.splice(index,1)}if(index>0){self.focus($(self.dialogOpened[index-1]))}},fireDialogEvent:function($dialog,event){var $iframe=$dialog.find("> iframe");if($iframe.size()){if($iframe[0].contentDocument.$){$iframe[0].contentDocument.$("body").trigger(event)}}else{try{$dialog.trigger(event)}catch(e){log("fireDialogEvent error",e,event)}}},dispatchEvent:function(event){var self=this;$.each(self.dialogOpened,function(){var $dialog=$(this);if(this===self.dialogFocused){self.fireDialogEvent($dialog,event)}else{var callbacks=$dialog.data("callbacks.nosdialog");if($.isPlainObject(callbacks)){callbacks[event.type+(event.namespace?"."+event.namespace:"")]=event}}})}};$.extend({nosLangPluralRule:"$n != 1 ? 1 : 0",nosTexts:{chooseMediaFile:"Choose a media file",chooseMediaImage:"Choose a image",errorImageNotfind:"Weâ€™re afraid we cannot find this image."},nosI18nPlural:function(msgs,$n){var plural_indice;if(!$.isArray(msgs)){return msgs}else{plural_indice=eval($.nosLangPluralRule);return msgs[plural_indice]?msgs[plural_indice]:msgs[0]}},nosContext:function(contexts){contexts=$.extend({locales:{},sites:{},contexts:{}},contexts||{});return{locales:contexts.locales,sites:contexts.sites,contexts:contexts.contexts,label:function(labels){if($.type(labels)==="string"){labels={defaultLabel:labels}}labels=$.extend({oneLocale:labels.allContexts,oneSite:labels.allContexts},labels);if(Object.keys(this.sites).length===1){return labels.oneSite}else{if(Object.keys(this.locales).length===1){return labels.oneLocale}}return labels.defaultLabel},siteLabel:function(site,options){options=$.extend({"short":false},options||{});if($.type(site)!=="object"){site=this.site(site)}site=$.extend({alias:site},site);if(options["short"]){return'<span title="'+site.title+'">'+site.alias+"</span>"}else{return site.title}},localeLabel:function(locale,options){options=$.extend({"short":false},options||{});if($.type(locale)!=="object"){locale=this.locale(locale)}locale=$.extend({flag:locale.code.substr(0,2).toLowerCase()},locale);if(options["short"]){return'<img src="static/novius-os/admin/novius-os/img/flags/'+locale.flag+'.png" title="'+locale.title+'" style="vertical-align:middle;" />'}else{return locale.title+' <img src="static/novius-os/admin/novius-os/img/flags/'+locale.flag+'.png" title="'+locale.title+'" style="vertical-align:middle;" />'}},contextLabel:function(context,options){var site=this.site(context),locale=this.locale(context),label;options=$.extend({"short":false,template:"{site} {locale}"},options||{});if(Object.keys(this.sites).length===1){label=this.localeLabel(locale,options)}else{if(Object.keys(this.locales).length===1){label=this.siteLabel(site,options)}else{label=options.template.replace("{locale}",this.localeLabel(locale,{"short":true})).replace("{site}",this.siteLabel(site,options))}}return label},localeCode:function(context){var split=context.split("::",2);if(!split[1]){return context}return split[1]},locale:function(context){var locale_code=this.localeCode(context);if(!this.locales[locale_code]){return{code:locale_code,title:locale_code,flag:locale_code.substr(0,2).toLowerCase()}}return $.extend({code:locale_code},this.locales[locale_code])},siteCode:function(context){var split=context.split("::",2);return split[0]},site:function(context){var site_code=this.siteCode(context);if(!this.sites[site_code]){return{code:site_code,title:site_code,alias:site_code}}return $.extend({code:site_code},this.sites[site_code])}}},nosDispatchEvent:function(event){if(window.parent!=window&&window.parent.$nos){return window.parent.$nos.nosDispatchEvent(event)}var $noviusos=noviusos(),e=$.Event("noviusos",{noviusos:event});$noviusos.ostabs("dispatchEvent",e);dialogEvent.dispatchEvent(e);return $},nosNotify:function(options,type){if(window.parent!=window&&window.parent.$nos){return window.parent.$nos.nosNotify(options,type)}if(!$.isPlainObject(options)){options={title:options}}if(type!==undefined){$.extend(options,$.isPlainObject(type)?type:{type:type})}if($.isPlainObject(options)){require(["pnotify","pnotify.nonblock","pnotify.buttons","pnotify.callbacks","pnotify.confirm","pnotify.desktop","pnotify.history","link!static/novius-os/admin/vendor/jquery/pnotify/pnotify.custom.min.css"],function(PNotify){return new PNotify($.extend({styling:"jqueryui",addclass:"nos-notification",nonblock:{nonblock:true,nonblock_opacity:0.2},history:{history:false}},options))})}return false},nosMediaVisualise:function(media){if(!media.image){window.open(media.path);return}var position=this.offset();position={top:position.top+this.height()/2-16,left:position.left+this.width()/2};require(["wijmo.wijlightbox"],function(){var image=new Image();image.onerror=function(){$.nosNotify($.nosTexts.errorImageNotfind,"error")};image.onload=function(){var lightbox=$("<div><a><img /></a></div>").find("a").attr({href:media.path,rel:"wijlightbox"}).find("img").attr({src:media.path,title:media.title}).css({width:0,height:0}).end().end().css({position:"absolute",width:0,height:0}).css(position).appendTo(document.body).wijlightbox({zIndex:1201,textPosition:"outside",player:"img",dialogButtons:"fullsize",modal:true,open:function(){$(".wijmo-wijlightbox-overlay").css("z-index",1200)},close:function(e){lightbox.wijlightbox("destroy");lightbox.remove()}});lightbox.find("a").triggerHandler("click")};image.src=media.path})},nosItemActions:function(actions,noParseData,actions_options){var container=$("<table><tr></tr></table>").addClass("buttontd wijgridtd"),actionsPrimary=[],actionsSecondary=[];actions_options=actions_options||{};if(!actions_options.showOnlyArrow){$.each(actions,function(){if(this.primary){actionsPrimary.push(this)}else{actionsSecondary.push(this)}});if(actionsSecondary.length==1&&(actionsSecondary[0].icon||actionsSecondary[0].iconClasses)){actionsPrimary.push(actionsSecondary[0])}$.each(actionsPrimary,function(i,action){var iconClass=false;if(action.iconClasses){iconClass=action.iconClasses}else{if(action.icon){iconClass="ui-icon ui-icon-"+action.icon}}var uiAction=$("<th></th>").css("white-space","nowrap").addClass("ui-state-default"+(action.red?" ui-state-error":"")).attr("title",action.label).html((iconClass?'<span class="'+iconClass+'"></span>':"")+(action.text||!iconClass?"&nbsp;"+action.label+"&nbsp;":""));var actionValue=(action.name&&noParseData&&noParseData.actions&&typeof noParseData.actions[action.name]!=="undefined")?noParseData.actions[action.name]:true;if(actionValue!==true){uiAction.addClass("ui-state-disabled").click(function(e){e.stopImmediatePropagation();e.preventDefault()});if($.type(actionValue)==="string"){uiAction.attr("title",actionValue)}}else{uiAction.click(function(e){e.stopImmediatePropagation();e.preventDefault();uiAction.nosAction(action.action,noParseData)}).hover(function(){$(this).addClass("ui-state-hover")},function(){$(this).removeClass("ui-state-hover")})}if(iconClass&&!action.text){uiAction.css({width:20,textAlign:"center"}).children().css({margin:"auto"})}else{if(iconClass&&action.text){uiAction.find("span").css("float","left")}}uiAction.appendTo(container.find("tr"))})}if(actions_options.showOnlyArrow||actionsSecondary.length>=2||(actionsSecondary.length==1&&!(actionsSecondary[0].icon||actionsSecondary[0].iconClasses))){var dropDown=$("<th></th>").addClass("ui-state-default").css({width:"20px"}).hover(function(){$(this).addClass("ui-state-hover")},function(){$(this).removeClass("ui-state-hover")});$("<span></span>").addClass("ui-icon ui-icon-triangle-1-s").appendTo(dropDown);dropDown.appendTo(container.find("tr")).click(function(e){$.each(nosActionsList,function(){if($(this).data("wijmo-wijmenu")){$(this).wijmenu("hideAllMenus")}});if(!this.created){var ul=$("<ul></ul>");$.each(actions,function(key,action){var iconClass;if(action.iconClasses){iconClass=action.iconClasses}else{if(action.icon){iconClass="ui-icon ui-icon-"+action.icon}}var text='<span class="'+(iconClass?iconClass:"nos-icon16 nos-icon16-empty")+' wijmo-wijmenu-icon-left"></span><span class="wijmo-wijmenu-text">'+action.label+"</span>";var li=$('<li><a href="#"></a></li>').appendTo(ul).find("a").html(text);if(action.red){li.addClass("ui-state-error")}var actionValue=(action.name&&noParseData&&noParseData.actions&&typeof noParseData.actions[action.name]!=="undefined")?noParseData.actions[action.name]:true;if(actionValue!==true){li.addClass("ui-state-disabled").click(function(e){e.stopImmediatePropagation();e.preventDefault()});if($.type(actionValue)==="string"){li.attr("title",actionValue)}}else{li.click(function(e){e.stopImmediatePropagation();e.preventDefault();if(ul.data("wijmo-wijmenu")){ul.wijmenu("hideAllMenus")}li.nosAction(action.action,noParseData)})}});var containerActions=dropDown.closest(".ui-dialog-content, .nos-dispatcher, body");ul.appendTo(containerActions);ul.wijmenu({trigger:dropDown,triggerEvent:"click",orientation:"vertical",animation:{animated:"slide",option:{direction:"up"},duration:50,easing:null},hideAnimation:{animated:"slide",option:{direction:"up"},duration:0,easing:null},position:{my:"right top",at:"right bottom",collision:"flip",offset:"0 0"}});nosActionsList.push(ul);this.created=true;dropDown.triggerHandler("click")}});dropDown.click(false)}return container},nosUIElement:function(element,data){var date,id,iconClass,$element;element=$.extend({type:"button",bind:{}},element);if(element.action){element.bind.click=$.extend(true,{},element.action);delete element.action}switch(element.type){case"button":$element=$("<button></button>").data(element);if(element.label){$element.html(element.label)}break;case"link":if(element.iconClasses){iconClass=element.iconClasses}else{if(element.icon){iconClass="nos-inline-icon16 ui-icon ui-icon-"+element.icon}}$element=(iconClass?'<span class="'+iconClass+'"></span> ':"");$element+='<span class="ui-button-text">'+element.label+"</span>";$element=$('<a href="#"></a>').css({display:"inline-block"}).html($element);if(element.red){$element.addClass("ui-state-error")}break}if(element.disabled&&element.disabled!==false){switch(element.type){case"button":$element.attr("disabled",true);break;case"link":$element.addClass("faded");break}if($.type(element.disabled)==="string"){$element.attr("title",element.disabled)}}if($element){$.each(element.bind,function(event,action){$element.bind(event,function(e){e.preventDefault();if(!element.disabled){if($.isFunction(action)){action(e)}else{$element.nosAction(action,data)}}})});if(element.menu){date=new Date();id=date.getDate()+"_"+date.getHours()+"_"+date.getMinutes()+"_"+date.getSeconds()+"_"+date.getMilliseconds();$element.attr("id",id).nosOnShow("one",function(){var $ul=$("<ul></ul>"),submenus=false,addMenu=function(menu,$ul){var $subul,$li=$("<li><a></a></li>").appendTo($ul),$a=$li.find("a");if(menu.action){$li.data("action",menu.action)}if(menu.content){$a.append(menu.content)}else{if(menu.icon){$("<span></span>").addClass("ui-icon wijmo-wijmenu-icon-left ui-icon-"+menu.icon).appendTo($a)}else{if(menu.iconClasses){$("<span></span>").addClass("wijmo-wijmenu-icon-left "+menu.iconClasses).appendTo($a)}else{if(menu.iconUrl){$("<span></span>").addClass("wijmo-wijmenu-icon-left  nos-icon16").css("backgroundImage","url("+menu.iconUrl+")").appendTo($a)}}}if(menu.label){$("<span></span>").addClass("wijmo-wijmenu-text").html(menu.label).appendTo($a)}}if(menu.menus){submenus=true;$subul=$("<ul></ul>");$.each(menu.menus,function(){addMenu(this,$subul)});$subul.insertAfter($a)}};$.each(element.menu.menus,function(){addMenu(this,$ul)});$ul.insertAfter($element).wijmenu($.extend(true,{orientation:"vertical",animation:{animated:"slide",option:{direction:"up"},duration:50,easing:null},hideAnimation:{animated:"slide",option:{direction:"up"},duration:0,easing:null},shown:function(event,item){var $contextMenu=$(item.element);if(!submenus){$contextMenu.parent().css({maxHeight:"200px",width:$contextMenu.outerWidth(true)+20,overflowY:"auto",overflowX:"hidden"})}}},element.menu.options||{},{trigger:"#"+id,select:function(e,data){var $li=$(data.item.element),action=$li.data("action");if(action){$li.nosAction(action)}}}))})}}return $element},nosDataReplace:function(obj,data){if($.type(obj)==="string"){return obj.replace(/{{([\w]+)}}/g,function(str,p1,offset,s){return data[p1]||""}).replace(/{{urlencode:([\w]+)}}/g,function(str,p1,offset,s){return encodeURIComponent(data[p1]||"")}).replace(/{{htmlspecialchars:([\w]+)}}/g,function(str,p1,offset,s){return(data[p1]||"").replace(/</g,"&lt;")})}else{if($.isPlainObject(obj)){$.each(obj,function(key,value){obj[key]=$.nosDataReplace(value,data)})}}return obj},nosCleanupTranslation:function(text){return text.replace(/&nbsp;/g," ")}});$.fn.extend({nosAction:function(obj,data){var url,params;data=data||{};try{if($.isFunction(obj)){obj($(this),data)}else{switch(obj.action){case"nosTabs":var args=[];params=$.extend(true,{},obj);params.method&&args.push(params.method);args.push($.nosDataReplace(params.tab,data));params.dialog&&args.push(params.dialog);$.fn.nosTabs.apply($(this),args);break;case"confirmationDialog":params=$.extend(true,{ajax:true,width:500,height:"auto",maxHeight:window.innerHeight-100,"class":"nos-confirmation-dialog"},$.nosDataReplace($.extend(true,{},obj.dialog),data));$(this).nosDialog(params);break;case"nosDialog":params=$.nosDataReplace($.extend(true,{},obj.dialog),data);$(this).nosDialog(params);break;case"nosAjax":params=$.nosDataReplace($.extend(true,{},obj.params),data);$(this).nosAjax(params);break;case"nosMediaVisualise":$.nosMediaVisualise.call(this,data);break;case"dialogPick":$(this).closest(".ui-dialog-content").trigger(obj.event,data);break;case"window.open":case"document.location":url=$.nosDataReplace(obj.url,data);if(!(url.substr(0,5)==="http:"||url.substr(0,6)==="https:")){var $base=$("base");if($base.size()){url=$base.attr("href")+url}}if(obj.action==="window.open"){window.open(url)}else{document.location.href=url}break}}}catch(e){log("nosAction",e)}return false},nosAjax:function(params){var options=$.extend({cache:false,dataType:"json",type:"POST",data:{}},params||{}),old_success=options.success,old_error=options.error,self=this;if(options.dataType=="json"){options.success=function(json){if($.isFunction(old_success)){json.user_success=old_success}self.nosAjaxSuccess(json)}}options.error=function(x,e){self.nosAjaxError(x,e);if($.isFunction(old_error)){old_error.call(this,x,e)}};return $.ajax(options)},nosAjaxSuccess:function(json){if(json.error){if($.isArray(json.error)){$.each(json.error,function(){$.nosNotify(this,"error")})}else{$.nosNotify(json.error,"error")}}if(json.internal_server_error&&console){var ise=json.internal_server_error;var str="An internal server error has been detected.\n\n";str+=ise.type+" [ "+ise.severity+" ]: "+ise.message+"\n";str+=ise.filepath+" @ line "+ise.error_line+"\n\n";str+="Backtrace:\n";for(var i in ise.backtrace){if(ise.backtrace.hasOwnProperty(i)){str+=i+": "+ise.backtrace[i].file+" @ line "+ise.backtrace[i].line+"\n"}}console.error(str)}if(json.notify){if($.isArray(json.notify)){$.each(json.notify,function(){$.nosNotify(this)})}else{$.nosNotify(json.notify)}}if(json.action){var self=this;if($.isArray(json.action)){$.each(json.action,function(){$(self).nosAction(this)})}else{$(self).nosAction(json.action)}}if($.isFunction(json.user_success)){json.user_success.call(this,json)}var dialog=this.closest(".ui-dialog-content").size();if(dialog){if(json.closeDialog){this.nosDialog("close")}}else{if(json.closeTab){this.nosTabs("close")}if(json.redirect){document.location.href=json.redirect}if(json.replaceTab){this.nosTabs("update",{url:json.replaceTab,reload:true})}}if(json.dispatchEvent){var events=json.dispatchEvent;if(!$.isArray(events)){events=[events]}$.each(events,function(i,event){$.nosDispatchEvent(event)})}return this},nosAjaxError:function(x,e){if(x.status==403){try{var json=$.parseJSON(x.responseText);if(json.login_popup&&!login_popup_opened){json.login_popup.close=function(){login_popup_opened=false};json.login_popup.contentUrl+="?lang="+$.nosLang;$("body").nosDialog("open",json.login_popup);login_popup_opened=true}return}catch(e){}}if(x.status!=0){$.nosNotify("Connection error!","error")}else{if(e=="parsererror"){$.nosNotify("Request seemed a success, but we could not read the answer.")}else{if(e=="timeout"){$.nosNotify("Time out (server is busy?). Please try again.")}}}return this},nosSaveUserConfig:function(key,configuration){this.nosAjax({url:"admin/nos/noviusos/save_user_configuration",data:{key:key,configuration:configuration}});return this},nosMedia:function(data){data=data||{};var contentUrls={all:"admin/noviusos_media/appdesk?view=media_pick",image:"admin/noviusos_media/appdesk?view=image_pick"},titles={all:$.nosTexts.chooseMediaFile,image:$.nosTexts.chooseMediaImage},$input=this;var options=$.extend({title:$input.attr("title")||"File",allowDelete:true,classes:data.mode,choose:function(){var select_media=function(item){$input.inputFileThumb({file:item.image?item.thumbnail:item.path});$input.val(item.id).trigger("change",{item:item});$dialog.nosDialog("close")},$dialog=$input.nosDialog({destroyOnClose:true,contentUrl:contentUrls[data.mode],ajax:true,title:titles[data.mode]}).bind("select_media",function(e,item){select_media(item)}).nosListenEvent({name:"Nos\\Media\\Model_Media",action:"insert"},function(e){$.ajax({method:"GET",url:"admin/noviusos_media/appdesk/info/"+e.id,dataType:"json",success:function(item){select_media(item)}})})}},data.inputFileThumb||{});require(["static/novius-os/admin/vendor/jquery/jquery-ui-input-file-thumb/js/jquery.input-file-thumb","link!static/novius-os/admin/vendor/jquery/jquery-ui-input-file-thumb/css/jquery.input-file-thumb.css"],function(){$(function(){$input.inputFileThumb(options);$input.prependTo($input.closest(".ui-widget-content"))})});return this},nosFormUI:function(){var $context=this;$context.find(":input[type='submit'],button").filter(":not(.notransform)").each(function(){var data=$(this).data(),options=$.extend(true,{icons:{}},data||{}),replace={},$button=$(this);if(data.red){$button.addClass("ui-state-error")}data.icons=$.extend(true,{primary:null,secondary:null},data.icons||{});if(data.icon){data.icons.primary={icon:data.icon}}else{if(data.iconClasses){data.icons.primary={iconClasses:data.iconClasses}}else{if(data.iconUrl){data.icons.primary={iconUrl:data.iconUrl}}}}$.each(data.icons,function(key,value){if(!value){return true}if($.type(value)==="string"){options.icons[key]="ui-icon-"+value.replace("ui-icon-","")}else{if(value.icon){options.icons[key]="ui-icon-"+value.icon.replace("ui-icon-","")}else{if(value.iconClasses){options.icons[key]=value.iconClasses}else{if(value.iconUrl){replace[key]=value.iconUrl;options.icons[key]="nos-icon16"}}}}});$button.button(options);$.each(replace,function(key,url){$button.find("span.ui-button-icon-"+key).css({backgroundImage:"url("+url+")"})})});$context.find(".expander").add($context.filter(".expander")).filter(":not(.notransform)").each(function(){var $this=$(this);$this.wijexpander($.extend({expanded:true,afterExpand:function(e){$(e.target).find(".ui-expander-content").nosOnShow()}},$this.data("wijexpander-options")))});$context.find(".accordion").add($context.filter(".accordion")).filter(":not(.notransform)").wijaccordion({header:"h3",selectedIndexChanged:function(e,args){$(e.target).find(".wijmo-wijaccordion-content").eq(args.newIndex).nosOnShow()}});return $context},nosFormValidate:function(params){var $context=this;params=params||{};if(!$context.is("form")){$context=$context.find("form")}require(["jquery-nos-validate"],function(){$context.validate($.extend({},params,{errorClass:"ui-state-error",success:true,ignore:"input[type=hidden]"}))});return this},nosFormAjax:function(){var $context=this;if(!$context.is("form")){$context=$context.find("form")}require(["jquery-form"],function(){$context.ajaxForm({dataType:"json",success:function(json){$context.nosAjaxSuccess(json).triggerHandler("ajax_success",[json])},error:function(x,e){$context.nosAjaxError(x,e)}})});return this},nosOnShow:function(){var args=Array.prototype.slice.call(arguments),method="show";if(args.length>0&&$.inArray(args[0],["one","bind","show"])!==-1){method=args.shift()}switch(method){case"one":case"bind":var callback=args[0];if(!$.isFunction(callback)){return}this.each(function(){var $el=$(this),nb_bind=$el.data("nos-on-show")||0;$el.addClass("nos-on-show").data("nos-on-show",nb_bind+(method==="bind"?1:0))[method]("nos-on-show",callback);if($el.is(":visible")){$el.nosOnShow()}});break;case"show":this.not(".nos-on-show-exec").addClass("nos-on-show-exec").each(function(){var $el=$(this),nb_bind=$el.data("nos-on-show")||0;if($el.is(".nos-on-show")&&$el.css("display")=="none"){$el.css("display","block")}if(!$el.is(":visible")){return true}if($el.is(".nos-on-show")){if(!nb_bind){$el.removeClass("nos-on-show")}$el.trigger("nos-on-show")}$el.find(".nos-on-show").not(".nos-on-show-exec").filter(":visible").nosOnShow()}).removeClass("nos-on-show-exec");break}return this},nosDialog:function(){var args=Array.prototype.slice.call(arguments),method="open";if(args.length>0&&$.inArray(args[0],["open","close"])!==-1){method=args.shift()}switch(method){case"open":if(this.is(".ui-dialog-content")){this.closest(".ui-dialog").show().appendTo("body");this.wijdialog("open");return this}var arg=args[0]||{},options=$.extend(true,{},{destroyOnClose:true,width:window.innerWidth-200,height:window.innerHeight-100,modal:true,captionButtons:{pin:{visible:false},refresh:{visible:arg.contentUrl!=null&&!arg.ajax},toggle:{visible:false},minimize:{visible:false},maximize:{visible:false}}},arg),oldCallbacks={open:options.open,close:options.close,focus:options.focus},$container=this.closest(".nos-dispatcher, body"),self=this,$dialog=$("<div></div>").addClass("nos-dispatcher").appendTo($container);if($container.data("nosContext")){$dialog.data("nosContext",$container.data("nosContext"))}$.extend(options,{close:function(e,ui){dialogEvent.close($dialog);if($.isFunction(oldCallbacks.close)){oldCallbacks.close.apply($dialog,arguments)}if(options.destroyOnClose){$dialog.wijdialog("destroy").remove()}else{$dialog.closest(".ui-dialog").hide().appendTo($container)}},focus:function(e,ui){dialogEvent.focus($dialog);if($.isFunction(oldCallbacks.focus)){oldCallbacks.focus.apply($dialog,arguments)}},open:function(e,ui){dialogEvent.open($dialog);if($.isFunction(oldCallbacks.open)){oldCallbacks.open.apply($dialog,arguments)}}});if(options.content!==undefined){$dialog.append(options.content)}if(options["class"]!==undefined){$dialog.addClass(options["class"])}if(options.title){options.title=$.nosCleanupTranslation(options.title)}var proceed=true;if(options.ajax&&options.contentUrl){var contentUrl=options.contentUrl;delete options.contentUrl;options.autoOpen=false;$dialog.wijdialog(options);$dialog.nosAjax({url:contentUrl,type:"GET",dataType:"html",data:options.ajaxData||{},complete:function(jqXHR,status,responseText){responseText=jqXHR.responseText;if(jqXHR.state()==="resolved"){jqXHR.done(function(r){responseText=r});try{var json=$.parseJSON(responseText);proceed=false}catch(e){}if(proceed){$dialog.html(responseText).wijdialog("open");$.isFunction(options.dialogRendered)&&options.dialogRendered($dialog)}else{$dialog.empty().wijdialog("destroy").remove();self.nosAjaxSuccess(json)}}}})}else{$dialog.wijdialog(options);$.isFunction(options.dialogRendered)&&options.dialogRendered($dialog)}if(proceed&&$.isFunction(options.onLoad)){options.onLoad()}return $dialog;break;case"close":this.closest(":wijmo-wijdialog").wijdialog("close");break}return this},nosListenEvent:function(json_to_checked,callback,caller){var self=this,$dispatcher=this.closest(".nos-dispatcher, body"),listens=$dispatcher.data("noviusos-listens");caller=caller||null;if(!$.isArray(listens)){$dispatcher.on("noviusos",function(e){e.noviusos=e.noviusos||{};$.each($dispatcher.data("noviusos-listens"),function(i_listened,listened){var array_json_to_checked=listened.array_json_to_checked,callback=listened.callback,matched=false;$.each(array_json_to_checked,function(i,json_to_checked){var json_matched=true;$.each(json_to_checked,function(key,value){if(!$.isArray(e.noviusos[key])&&!$.isArray(value)){json_matched=e.noviusos[key]===value}else{if($.isArray(e.noviusos[key])&&!$.isArray(value)){json_matched=$.inArray(value,e.noviusos[key])!==-1}else{if(!$.isArray(e.noviusos[key])&&$.isArray(value)){json_matched=$.inArray(e.noviusos[key],value)!==-1}else{if($.isArray(e.noviusos[key])&&$.isArray(value)){var matched_temp=false;$.each(value,function(i,val){matched_temp=$.inArray(val,e.noviusos[key])!==-1;return !matched_temp});json_matched=matched_temp}}}}return json_matched});if(json_matched){matched=true;return false}});if(matched){callback(e.noviusos)}})})}listens=$.isArray(listens)?listens:[];listens.push({caller:caller,array_json_to_checked:$.isArray(json_to_checked)?json_to_checked:[json_to_checked],callback:callback});$dispatcher.data("noviusos-listens",listens);return self},nosUnlistenEvent:function(caller){var self=this,$dispatcher=this.closest(".nos-dispatcher, body"),listens=$dispatcher.data("noviusos-listens");if($.isArray(listens)){listens=$.extend(true,[],listens);for(var index_listen=0;index_listen<listens.length;index_listen++){if(listens[index_listen].caller===caller){listens.splice(index_listen,1);index_listen--}}$dispatcher.data("noviusos-listens",listens)}return self},nosTabs:function(){var args=Array.prototype.slice.call(arguments),method="open",getIndex=function(context){if(window.parent!=window&&window.parent.$nos){return window.parent.$nos(window.frameElement).data("nos-ostabs-index")}var $panel=$(context).parents(".nos-ostabs-panel-content");if($panel.size()){return $panel.data("nos-ostabs-index")}return false},self=this;if(args.length>0&&$.inArray(args[0],["open","close","add","update","reload","init","current"])!==-1){method=args.shift()}switch(method){case"open":(function(){var tab=args[0]||{},dialogOptions=args[1]||{},dialog=self.closest(".ui-dialog-content").size();if(dialog){self.nosDialog($.extend({contentUrl:tab.url,ajax:!tab.iframe,title:tab.label},dialogOptions))}else{if(window.parent!=window&&window.parent.$nos){window.parent.$nos(window.frameElement).nosTabs("open",tab,dialogOptions)}else{if(noviusos().length){var tabs=noviusos().ostabs("tabs"),sel=false;$.each(tabs,function(i,t){if(t.url===tab.url){sel=i;return false}});if(sel!==false){return noviusos().ostabs("select",sel+1)}else{self.nosTabs("add",tab)}}else{if(tab.url){window.open(tab.url)}}}}})();break;case"add":(function(){var tab=args[0],dialogOptions=args[1]||{},dialog=self.closest(".ui-dialog-content").size(),place=args[2]||"end";if(dialog){self.nosDialog($.extend({contentUrl:tab.url,ajax:!tab.iframe,title:tab.label},dialogOptions))}else{if(window.parent!=window&&window.parent.$nos){window.parent.$nos(window.frameElement).nosTabs("add",tab,place)}else{var index;if($.inArray(place,["before","after"])!==-1){index=getIndex(self)+(place==="before"?-1:1)}if(noviusos().length){index=noviusos().ostabs("add",tab,index);noviusos().ostabs("select",index)}else{if(tab.url){window.open(tab.url)}}}}})();break;case"close":(function(){var $dialog=self.closest(":wijmo-wijdialog");if($dialog.size()){self.nosDialog("close")}else{if(window.parent!=window&&window.parent.$nos){window.parent.$nos(window.frameElement).nosTabs("close")}else{var index=getIndex(self);if(noviusos().length){noviusos().ostabs("remove",index)}}}})();break;case"update":(function(){var tab=args[0];if(window.parent!=window&&window.parent.$nos){window.parent.$nos(window.frameElement).nosTabs("update",tab)}else{if(self.size()&&!self.closest(".ui-dialog-content").size()&&noviusos().length){var index=getIndex(self);noviusos().ostabs("update",index,tab)}}})();break;case"reload":(function(){var tab=args[0];if(window.parent!=window&&window.parent.$nos){window.parent.$nos(window.frameElement).nosTabs("reload")}else{if(self.size()&&!self.closest(".ui-dialog-content").size()&&noviusos().length){var index=getIndex(self);noviusos().ostabs("reload",index)}}})();break;case"current":return(function(){if(window.parent!=window&&window.parent.$nos){return window.parent.$nos(window.frameElement).nosTabs("current")}else{if(noviusos().length){return noviusos().ostabs("current")}}return null})();break;case"init":(function(){var configuration=args[0],saveTimeout=false,fct=function(){if(noviusos().length){if(saveTimeout){clearTimeout(saveTimeout)}saveTimeout=setTimeout(function(){noviusos().nosSaveUserConfig("tabs",{selected:noviusos().ostabs("option","selected"),tabs:noviusos().ostabs("tabs")})},500)}};$noviusos=self;$.extend(configuration,{add:fct,remove:fct,select:fct,show:fct,drag:fct,update:fct});if(configuration.user_configuration["tabs"]){if(!configuration.options){configuration.options={}}configuration.initTabs=configuration.user_configuration["tabs"]["tabs"];configuration.selected=configuration.user_configuration["tabs"]["selected"]}$noviusos.ostabs(configuration)})();break}return this},nosToolbar:function(){var args=Array.prototype.slice.call(arguments),method="add",self=this;if(args.length>0&&$.inArray(args[0],["create","add"])!==-1){method=args.shift()}switch(method){case"create":return(function(){var $toolbar=$('<table><tr><td class="nos-toolbar-left"><table><tr class="nos-toolbar-left"></tr></table></td><td class="nos-toolbar-right"><table><tr class="nos-toolbar-right"></tr></table></td></tr></table>').addClass("nos-toolbar ui-widget-header").insertBefore(self);self.addClass("nos-toolbar-target fill-parent nos-fixed-content").parent().addClass("nos-toolbar-parent");return $toolbar})();break;case"add":return(function(){var tool=args[0],right_side=args[1],$target=self.closest(".nos-toolbar-target"),$toolbar,$tool;if(!$target.size()){self.nosToolbar("create");$target=self}$toolbar=$target.prev();$tool=$(tool);$("<td></td>").append($tool).appendTo($toolbar.find("tr.nos-toolbar-"+(right_side?"right":"left"))).nosFormUI();$target.css({bottom:$toolbar.outerHeight(),top:0,height:"auto"}).closest(".nos-dispatcher").on("showPanel",function(){$target.css("bottom",$toolbar.outerHeight())});return $tool})();break}return this}});$.widget("wijmo.wijtextbox",{});$.widget("wijmo.wijradio",{});$.widget("wijmo.wijcheckbox",{});$.widget("wijmo.wijdropdown",{});return $});
define("jquery-nos-loadspinner",["jquery","jquery-nos","jquery-ui.widget"],function(a){a.widget("nos.loadspinner",{options:{diameter:40,color:null,density:40,range:1.3,scaling:false,fading:true,shape:"circle",speed:2,fps:24},shapes:["circle","square","rectangle","roundedRectangle"],colorReg:/^\#?([a-fA-F0-9]{6}|[a-fA-F0-9]{3})$/,colorRgb:/^rgb\((\d+)[ \,]+(\d+)[ \,]+(\d+)\)$/,UISpinnerCanvas:null,UISpinnerContext:null,UISpinnerCacheCanvas:null,UISpinnerCacheContext:null,running:false,ready:false,timer:null,activeId:0,colorRGB:null,_create:function(){this.UISpinnerCanvas=a("<canvas></canvas>").attr("id","CanvasLoader").get(0);this.UISpinnerContext=this.UISpinnerCanvas.getContext("2d");this.element.append(this.UISpinnerCanvas);this.UISpinnerCanvas.width=this.UISpinnerCanvas.height=this.options.diameter;this.UISpinnerCacheCanvas=a("<canvas></canvas>").get(0);a("body").append(this.UISpinnerCacheCanvas);this.UISpinnerCacheContext=this.UISpinnerCacheCanvas.getContext("2d");this.UISpinnerCacheCanvas.width=this.UISpinnerCacheCanvas.height=this.options.diameter;a(this.UISpinnerCacheCanvas).hide()},_init:function(){if(!this.options.color){this.options.color=this.element.css("color")}this._setOption("color",this.options.color);this.ready=true;this._draw();this.start()},_setOption:function(c,d){var b=this;switch(c){case"diameter":if(isNaN(d)){return}d=Math.round(Math.abs(d));break;case"color":this.colorRGB=this._RGB(d);break;case"shape":if(a.inArray(d,this.shapes)==-1){return}break;case"density":if(isNaN(d)){return}d=Math.round(Math.abs(d));break;case"range":if(isNaN(d)){return}d=Math.abs(d);break;case"speed":if(isNaN(d)&&Math.abs(d)>0){return}d=Math.round(Math.abs(d));break;case"fps":if(isNaN(d)){return}d=Math.round(Math.abs(d));break}a.Widget.prototype._setOption.apply(b,arguments);if(a.inArray(c,["diameter","color","shape","density","range","scaling","fading"])!=-1){this._redraw()}else{if(a.inArray(c,["speed","fps"])!=-1){this._reset()}}},_RGB:function(c){var b={};if(this.colorReg.test(c)){c=c.charAt(0)==="#"?c.substring(1,7):c;if(c.length==3){c=c+c}b.r=parseInt(c.substring(0,2),16);b.g=parseInt(c.substring(2,4),16);b.b=parseInt(c.substring(4,6),16)}else{if(this.colorRgb.exec(c)){b.r=parseInt(RegExp.$1);b.g=parseInt(RegExp.$2);b.b=parseInt(RegExp.$3)}else{b.r=0;b.g=0;b.b=0}}return b},_draw:function(){var e=0,o=this.options.diameter*0.07,d,k,n,j,m,l,c,g=0.1,b=Math.round(this.options.density*this.options.range),f;this.UISpinnerCacheContext.clearRect(0,0,this.UISpinnerCacheCanvas.width,this.UISpinnerCacheCanvas.height);this.UISpinnerCanvas.width=this.UISpinnerCanvas.height=this.UISpinnerCacheCanvas.width=this.UISpinnerCacheCanvas.height=this.options.diameter;switch(this.options.shape){case this.shapes[0]:while(e<this.options.density){if(e<=b){f=1-((1-g)/b*e)}else{f=g}d=(this.options.density-e)*((Math.PI*2)/this.options.density);m=this.UISpinnerCanvas.width*0.5+Math.cos(d)*(this.options.diameter*0.45-o)-this.UISpinnerCanvas.width*0.5;l=this.UISpinnerCanvas.height*0.5+Math.sin(d)*(this.options.diameter*0.45-o)-this.UISpinnerCanvas.height*0.5;this.UISpinnerCacheContext.beginPath();if(this.options.fading){this.UISpinnerCacheContext.fillStyle="rgba("+this.colorRGB.r+","+this.colorRGB.g+","+this.colorRGB.b+","+f.toString()+")"}else{this.UISpinnerCacheContext.fillStyle="rgba("+this.colorRGB.r+","+this.colorRGB.g+","+this.colorRGB.b+",1)"}if(this.options.scaling){this.UISpinnerCacheContext.arc(this.options.diameter*0.5+m,this.options.diameter*0.5+l,o*f,0,Math.PI*2,false)}else{this.UISpinnerCacheContext.arc(this.options.diameter*0.5+m,this.options.diameter*0.5+l,o,0,Math.PI*2,false)}this.UISpinnerCacheContext.closePath();this.UISpinnerCacheContext.fill();e+=1}break;case this.shapes[1]:o=this.UISpinnerCanvas.width*0.12;while(e<this.options.density){if(e<=b){f=1-((1-g)/b*e)}else{f=g}c=360-360/this.options.density*e;d=c/180*Math.PI;m=Math.cos(d)*o*3+this.UISpinnerCacheCanvas.width*0.5;l=Math.sin(d)*o*3+this.UISpinnerCacheCanvas.height*0.5;this.UISpinnerCacheContext.save();this.UISpinnerCacheContext.translate(m,l);this.UISpinnerCacheContext.rotate(d);this.UISpinnerCacheContext.translate(-m,-l);this.UISpinnerCacheContext.beginPath();if(this.options.fading){this.UISpinnerCacheContext.fillStyle="rgba("+this.colorRGB.r+","+this.colorRGB.g+","+this.colorRGB.b+","+f.toString()+")"}else{this.UISpinnerCacheContext.fillStyle="rgba("+this.colorRGB.r+","+this.colorRGB.g+","+this.colorRGB.b+",1)"}this.UISpinnerCacheContext.fillRect(m,l-o*0.5,o,o);this.UISpinnerCacheContext.closePath();this.UISpinnerCacheContext.fill();this.UISpinnerCacheContext.restore();e+=1}break;case this.shapes[2]:n=this.UISpinnerCacheCanvas.width*0.24;j=n*0.35;while(e<this.options.density){if(e<=b){f=1-((1-g)/b*e)}else{f=g}c=360-360/this.options.density*e;d=c/180*Math.PI;m=Math.cos(d)*(j+(this.UISpinnerCacheCanvas.height-j)*0.13)+this.UISpinnerCacheCanvas.width*0.5;l=Math.sin(d)*(j+(this.UISpinnerCacheCanvas.height-j)*0.13)+this.UISpinnerCacheCanvas.height*0.5;this.UISpinnerCacheContext.save();this.UISpinnerCacheContext.translate(m,l);this.UISpinnerCacheContext.rotate(d);this.UISpinnerCacheContext.translate(-m,-l);this.UISpinnerCacheContext.beginPath();if(this.options.fading){this.UISpinnerCacheContext.fillStyle="rgba("+this.colorRGB.r+","+this.colorRGB.g+","+this.colorRGB.b+","+f.toString()+")"}else{this.UISpinnerCacheContext.fillStyle="rgba("+this.colorRGB.r+","+this.colorRGB.g+","+this.colorRGB.b+",1)"}this.UISpinnerCacheContext.fillRect(m,l-j*0.5,n,j);this.UISpinnerCacheContext.closePath();this.UISpinnerCacheContext.fill();this.UISpinnerCacheContext.restore();e+=1}break;case this.shapes[3]:n=this.UISpinnerCacheCanvas.width*0.24;j=n*0.35;k=j*0.65;while(e<this.options.density){if(e<=b){f=1-((1-g)/b*e)}else{f=g}c=360-360/this.options.density*e;d=c/180*Math.PI;m=Math.cos(d)*(j+(this.UISpinnerCacheCanvas.height-j)*0.13)+this.UISpinnerCacheCanvas.width*0.5;l=Math.sin(d)*(j+(this.UISpinnerCacheCanvas.height-j)*0.13)+this.UISpinnerCacheCanvas.height*0.5;this.UISpinnerCacheContext.save();this.UISpinnerCacheContext.translate(m,l);this.UISpinnerCacheContext.rotate(d);this.UISpinnerCacheContext.translate(-m,-l);if(this.options.fading){this.UISpinnerCacheContext.fillStyle="rgba("+this.colorRGB.r+","+this.colorRGB.g+","+this.colorRGB.b+","+f.toString()+")"}else{this.UISpinnerCacheContext.fillStyle="rgba("+this.colorRGB.r+","+this.colorRGB.g+","+this.colorRGB.b+",1)"}this.UISpinnerCacheContext.beginPath();this.UISpinnerCacheContext.moveTo(m+k,l-j*0.5);this.UISpinnerCacheContext.lineTo(m+n-k,l-j*0.5);this.UISpinnerCacheContext.quadraticCurveTo(m+n,l-j*0.5,m+n,l-j*0.5+k);this.UISpinnerCacheContext.lineTo(m+n,l-j*0.5+j-k);this.UISpinnerCacheContext.quadraticCurveTo(m+n,l-j*0.5+j,m+n-k,l-j*0.5+j);this.UISpinnerCacheContext.lineTo(m+k,l-j*0.5+j);this.UISpinnerCacheContext.quadraticCurveTo(m,l-j*0.5+j,m,l-j*0.5+j-k);this.UISpinnerCacheContext.lineTo(m,l-j*0.5+k);this.UISpinnerCacheContext.quadraticCurveTo(m,l-j*0.5,m+k,l-j*0.5);this.UISpinnerCacheContext.closePath();this.UISpinnerCacheContext.fill();this.UISpinnerCacheContext.restore();e+=1}break}this._tick(true);return this},_clean:function(){this.UISpinnerContext.clearRect(0,0,this.UISpinnerCanvas.width,this.UISpinnerCanvas.height);return this},_redraw:function(){if(this.ready){this._clean();this._draw()}return this},_reset:function(){if(this.running){this.stop();this.start()}return this},_tick:function(b){var c=this.options.density>360?this.options.density/360:360/this.options.density;c*=this.options.speed;if(!b){this.activeId+=c}if(this.activeId>360){this.activeId-=360}this.UISpinnerContext.clearRect(0,0,this.options.diameter,this.options.diameter);this.UISpinnerContext.save();this.UISpinnerContext.translate(this.options.diameter*0.5,this.options.diameter*0.5);this.UISpinnerContext.rotate(Math.PI/180*this.activeId);this.UISpinnerContext.translate(-this.options.diameter*0.5,-this.options.diameter*0.5);this.UISpinnerContext.drawImage(this.UISpinnerCacheCanvas,0,0,this.options.diameter,this.options.diameter);this.UISpinnerContext.restore();return this},start:function(){if(!this.running){this.running=true;var b=this;this.timer=window.setInterval(function(){b._tick()},Math.round(1000/this.options.fps))}return this},stop:function(){if(this.running){this.running=false;clearInterval(this.timer);this.timer=null;delete this.timer}return this},destroy:function(){if(this.running){this.stop()}a(this.UISpinnerCanvas).remove();a(this.UISpinnerCacheCanvas).remove();a.Widget.prototype.destroy.apply(this);return this}});return a});
define("jquery-nos-ostabs",["jquery","jquery-nos","jquery-ui.widget","jquery-nos-loadspinner","jquery-ui.sortable","wijmo.wijsuperpanel","jquery-nos-contextmenu","modernizr","jquery.simulate"],function(a){var c=void (0),b=Modernizr.touch;a.widget("nos.ostabs",{options:{initTabs:[],newTab:"desktopTab",desktopTab:{},fx:null,labelMinWidth:100,labelMaxWidth:200,selected:null,texts:{newTab:"New tab",closeTab:"Close tab",closeTabs:"Close all tabs",closeOtherTabs:"Close all other tabs",confirmCloseOtherTabs:"Are you sure to want to close all other tabs?",confirmCloseTabs:"Are you sure to want to close all tabs?",reloadTab:"Reload tab",moveTab:"Move tab"},add:null,remove:null,select:null,show:null,drag:null},tabId:0,openRank:0,_create:function(){var d=this,e=d.options;d._tabify(true);a(window).resize(function(){if(e.selected!==null){d._firePanelEvent(d.panels.eq(e.selected),a.Event("resizePanel"))}})},_setOption:function(e,f){var d=this;if(e=="selected"){d.select(f)}else{d.options[e]=f;d._tabify()}},_getNextTabId:function(){var d=this;return ++d.tabId},_tabId:function(d){var e=this;return a(d).data("panelid.tabs")||"nos-ostabs-"+e._getNextTabId()},_sanitizeSelector:function(d){return d.replace(/:/g,"\\:")},_ui:function(d,e){var f=this,g=f.lis.index(d);if(e===c){e=f.element.find(f._sanitizeSelector(a(f.anchors[g]).data("anchor.tabs")))[0]}return{tab:d,panel:e,index:g}},_cleanup:function(){var d=this;d.lis.filter(".ui-state-processing").removeClass("ui-state-processing").find("span.nos-ostabs-icon").removeClass("nos-ostabs-loader").each(function(){if(a.isFunction(a.fn.loadspinner)&&a(this).data("nos-loadspinner")){a(this).loadspinner("destroy")}}).html(" ");return d},_tabify:function(q){var r=this,g=r.options,e=/^#.+/;if(q){r.element.addClass("nos-ostabs ui-widget ui-widget-content"+(b?" nos-ostabs-touch":""));r.uiOstabsHeader=a("<div></div>").addClass("nos-ostabs-header").appendTo(r.element);r.uiOstabsSuperPanel=a("<div></div>").addClass("nos-ostabs-tabs").appendTo(r.uiOstabsHeader);r.uiOstabsTray=r.element.find(".nos-ostabs-tray").addClass("nos-ostabs-nav").prependTo(r.uiOstabsHeader);if(a.isPlainObject(g.desktopTab)){r.uiOstabsDesktopTab=a("<ul></ul>").addClass("nos-ostabs-desktoptab  nos-ostabs-nav").prependTo(r.uiOstabsHeader);r._add(g.desktopTab,r.uiOstabsDesktopTab,true).addClass("nos-ostabs-desktoptab").removeClass("ui-state-default")}else{r.uiOstabsDesktopTab=a("<ul></ul>")}r.uiOstabsSuperPanel.css("left",r.uiOstabsDesktopTab.outerWidth(true)+25).css("right",r.uiOstabsTray.outerWidth(true)+25).wijsuperpanel({allowResize:false,autoRefresh:true,hScroller:{scrollBarVisibility:"hidden",scrollMode:"buttons",increaseButtonPosition:{my:"left bottom",at:"right bottom"},decreaseButtonPosition:{my:"right bottom",at:"left bottom"}},vScroller:{scrollBarVisibility:"hidden"},showRounder:false}).removeClass("ui-widget ui-widget-content").css("overflow","visible");r.uiOstabsSuperPanelContent=r.uiOstabsSuperPanel.wijsuperpanel("getContentElement");r.uiOstabsTabs=a("<ul></ul>").appendTo(r.uiOstabsSuperPanelContent);if(a.isArray(g.initTabs)){a.each(g.initTabs,function(o,s){r._add(s)})}var f=g.newTab;if(a.isPlainObject(f)){f=a.extend({label:g.texts.newTab,iconClasses:"ui-icon ui-icon-circle-plus"},f)}else{if(f&&a.isPlainObject(g.desktopTab)){f=a.extend({},g.desktopTab,{label:g.texts.newTab,iconClasses:"ui-icon ui-icon-circle-plus",iconUrl:"",iconSize:16})}else{f=false}}if(f){r.uiOstabsNewTab=r._add(f,null,true).addClass("nos-ostabs-newtab")}else{r.uiOstabsNewTab=a("<li>/<li>")}r.uiOstabsNewTab.hover(function(){a(this).find(".nos-ostabs-label").css("display","inline-block");r._tabsWidth()},function(){a(this).find(".nos-ostabs-label").css("display","none");r._tabsWidth()});if(!b){r._initSortable()}r.tabsWidth=r.uiOstabsSuperPanelContent.width();r.labelWidth=g.labelMaxWidth;r.uiOstabsTabs.width(r.tabsWidth)}var m=[];r.lis=r.uiOstabsDesktopTab.add(r.uiOstabsTabs).find("li").each(function(o){var t=a(this),s=t.data("ui-ostab")||{};if(!t.hasClass("nos-ostabs-desktoptab")&&s.openRank!==false){m[s.openRank]=t}});r.openRank=1;a.each(m,function(o,t){if(t){var s=t.data("ui-ostab")||{};s.openRank=r.openRank++}});r.anchors=r.lis.map(function(){return a("a",this)[0]});r.panels=a([]);r.anchors.each(function(v,x){var t=a(x),o=t.attr("href"),u=t.data("anchor.tabs");if(!o&&u){x.href=u;o=u}var w=o.split("#")[0],y,z;if(w&&(w===location.toString().split("#")[0]||(y=a("base")[0])&&w===y.href)){o=x.hash;x.href=o}if(e.test(o)){z=r.element.find(r._sanitizeSelector(o));r.panels=r.panels.add(z)}else{if(o&&o!=="#"){t.data("href.tabs",o);t.data("load.tabs",o.replace(/#.*$/,""));var s=r._tabId(x);x.href="#"+s;z=r.element.find("#"+s);if(!z.length){z=a("<div></div>").attr("id",s).addClass("nos-ostabs-panel ui-widget-content ui-corner-bottom nos-ostabs-hide").appendTo(r.element);r._contextMenu(r.lis.eq(v))}r.panels=r.panels.add(z)}}t.data("anchor.tabs",x.hash).removeAttr("href");z.find(".nos-ostabs-panel-content").data("nos-ostabs-index",v)});if(q){r.uiOstabsTray.add(r.uiOstabsDesktopTab).addClass("nos-ostabs-nav ui-helper-reset ui-helper-clearfix");r.lis.addClass("ui-corner-top");r.panels.addClass("nos-ostabs-panel ui-widget-content");if(g.selected===c){if(location.hash){r.anchors.each(function(s,o){if(a(o).data("anchor.tabs")==location.hash){g.selected=s;return false}})}if(typeof g.selected!=="number"&&r.lis.filter(".nos-ostabs-selected").length){g.selected=r.lis.index(r.lis.filter(".nos-ostabs-selected"))}g.selected=g.selected||(r.lis.length?0:-1)}g.selected=((g.selected>=0&&r.anchors[g.selected])||g.selected<0)?g.selected:0;r.panels.addClass("nos-ostabs-hide");r.lis.removeClass("nos-ostabs-selected ui-state-active");if(g.selected>=0&&r.anchors.length){r.element.find(r._sanitizeSelector(a(r.anchors[g.selected]).data("anchor.tabs"))).removeClass("nos-ostabs-hide");r.lis.eq(g.selected).addClass("nos-ostabs-selected ui-state-active ui-state-open");r.element.queue("tabs",function(){r._trigger("show",null,r._ui(r.lis[g.selected]))});r.title(g.selected,r.title(g.selected));r._load(g.selected)}a(window).bind("unload",function(){r.lis.add(r.anchors).unbind(".tabs");r.lis=r.anchors=r.panels=null})}else{g.selected=r.lis.index(r.lis.filter(".nos-ostabs-selected"))}r.anchors.removeData("cache.tabs");r.lis.add(r.anchors).unbind(".tabs");var i=function(s,o){o.addClass("ui-state-"+s)};var l=function(s,o){o.removeClass("ui-state-"+s)};r.lis.bind("mouseover.tabs",function(){i("hover",a(this))});r.lis.bind("mouseout.tabs",function(){l("hover",a(this))});r.anchors.bind("focus.tabs",function(){i("focus",a(this).closest("li"))});r.anchors.bind("blur.tabs",function(){l("focus",a(this).closest("li"))});var d,j;if(g.fx){if(a.isArray(g.fx)){d=g.fx[0];j=g.fx[1]}else{d=j=g.fx}}function h(o,s){o.css("display","");if(!a.support.opacity&&s.opacity){o[0].style.removeAttribute("filter")}}function k(t){var s=t.data("callbacks.ostabs"),o=t.find(".nos-dispatcher");if(a.isPlainObject(s)){a.each(s,function(u,v){r._firePanelEvent(o,v)});s={}}}var n=j?function(o,s){var t=a(o).closest("li").addClass("nos-ostabs-selected ui-state-active");r._tabsWidth();s.hide().removeClass("nos-ostabs-hide").animate(j,j.duration||"normal",function(){if(t.hasClass("nos-ostabs-newtab")){r._tabsWidth()}r.uiOstabsSuperPanel.wijsuperpanel("scrollChildIntoView",t.find("a"));h(s,j);k(s);r._firePanelEvent(s,a.Event("showPanel"))})}:function(o,s){var t=a(o).closest("li");if(t.hasClass("nos-ostabs-newtab")){r._tabsWidth()}r.uiOstabsSuperPanel.wijsuperpanel("scrollChildIntoView",t.find("a"));t.addClass("nos-ostabs-selected ui-state-active");r._tabsWidth();s.removeClass("nos-ostabs-hide");k(s);r._firePanelEvent(s,a.Event("showPanel"))};var p=d?function(s,o){o.animate(d,d.duration||"normal",function(){if(r.uiOstabsNewTab.hasClass("ui-state-active")){r._tabsWidth()}r.lis.removeClass("nos-ostabs-selected ui-state-active");r._tabsWidth();o.addClass("nos-ostabs-hide");h(o,d);r.element.dequeue("tabs");o.trigger("hidePanel.ostabs")})}:function(s,o){if(r.uiOstabsNewTab.hasClass("ui-state-active")){r._tabsWidth()}r.lis.removeClass("nos-ostabs-selected ui-state-active");r._tabsWidth();o.addClass("nos-ostabs-hide");r.element.dequeue("tabs");o.trigger("hidePanel.ostabs")};r.anchors.bind("click.tabs",function(){var u=this,w=a(u).closest("li"),o=r.panels.filter(":not(.nos-ostabs-hide)"),v=r.element.find(r._sanitizeSelector(a(u).data("anchor.tabs"))),t=w.data("ui-ostab");w.addClass("ui-state-open");r.uiOstabsNewTab.removeClass("ui-state-open");g.selected=r.anchors.index(this);if(w.hasClass("nos-ostabs-selected")||w.hasClass("ui-state-processing")||r.panels.filter(":animated").length||r._trigger("select",null,r._ui(w[0],v[0]))===false){this.blur();return false}r._abort();if(v.length){if(o.length){r.element.queue("tabs",function(){p(u,o)})}r.element.queue("tabs",function(){if(!w.hasClass("nos-ostabs-desktoptab")){t.openRank=r.openRank++}n(u,v)});a("title").html(w.find(".nos-ostabs-label").html());var s=encodeURIComponent(t.url).replace(/%2F/g,"/");if("replaceState" in window.history){window.history.replaceState({},"",document.location.pathname+"?tab="+s)}else{document.location.hash="tab="+s}r._load(r.anchors.index(this))}else{throw"jQuery UI Tabs: Mismatching fragment identifier."}this.blur()}).bind("mousedown.tabs",function(t){if(t.which===2){var s=this,u=a(s).closest("li"),o=u.not(".nos-ostabs-desktoptab").length;if(o){r.remove(r.lis.index(u),!u.hasClass("nos-ostabs-selected"))}}});r.anchors.bind("click.tabs",function(){return false});r._tabsWidth()},_initSortable:function(){var d=this,e=d.options;d.uiOstabsTabs.sortable({items:"li:not(.nos-ostabs-newtab)",appendTo:d.uiOstabsSuperPanelContent,cursor:"move",delay:250,scroll:false,helper:"clone",tolerance:"pointer",axis:"x",zIndex:100000,placeholder:"ui-state-highlight",forcePlaceholderSize:true,start:function(){d.sorting=true},stop:function(){d.sorting=false},update:function(){d._trigger("drag",null);d.lis=d.uiOstabsDesktopTab.add(d.uiOstabsTabs).find("li");d.anchors=d.lis.map(function(g){var f=a("a",this)[0];d.element.find(d._sanitizeSelector(a(f).data("anchor.tabs"))).find(".nos-ostabs-panel-content").data("nos-ostabs-index",g);return f});d._tabsWidth()}});return d},_refreshSortable:function(){var d=this,e=d.options;if(d.uiOstabsTabs.data("ui-sortable")){d.uiOstabsTabs.sortable("refresh")}return d},_getIndex:function(e){var d=this;if(typeof e=="string"){d.anchors.each(function(f){if(a(this).data("anchor.tabs")===e){e=f;return false}})}return e},_contextMenu:function(j){var l=this,e=l.options,k=j.not(".nos-ostabs-desktoptab").length,g=[],h,i,f,d=j.attr("id");if(!d){f=new Date();d=f.getDate()+"_"+f.getHours()+"_"+f.getMinutes()+"_"+f.getSeconds()+"_"+f.getMilliseconds();j.attr("id",d)}if(k){g.push({classes:"nos-ostabs-close",click:function(){l.remove(l.lis.index(j));return false},label:e.texts.closeTab,iconClass:"ui-icon-closethick",iconUrl:"static/novius-os/admin/novius-os/img/16/close.png"},{classes:"nos-ostabs-close-allothers",click:function(){if(confirm(a.nosCleanupTranslation(e.texts.confirmCloseOtherTabs))){l.lis.not(".nos-ostabs-desktoptab").not(".nos-ostabs-newtab").each(function(){var m=this;if(m!==j[0]){l.remove(l.lis.index(m))}})}return false},label:e.texts.closeOtherTabs,iconClass:"ui-icon-closethick",iconUrl:"static/novius-os/admin/novius-os/img/16/close.png"})}if(!k){g.push({classes:"nos-ostabs-close-all",click:function(){if(confirm(a.nosCleanupTranslation(e.texts.confirmCloseTabs))){l.lis.not(".nos-ostabs-desktoptab").not(".nos-ostabs-newtab").each(function(){l.remove(l.lis.index(this))})}return false},label:e.texts.closeTabs,iconClass:"ui-icon-closethick",iconUrl:"static/novius-os/admin/novius-os/img/16/close.png"})}if(k){g.push({classes:"nos-ostabs-reload",click:function(){var m=l.lis.index(j);l.reload(m);return false},label:e.texts.reloadTab,iconClass:"ui-icon-refresh",iconUrl:"static/novius-os/admin/novius-os/img/16/refresh.png"});if(b){g.push({classes:"nos-ostabs-move",click:function(){var n=j.offset(),o=j.data("contextmenu.tabs"),m=a("<div></div>");l._initSortable();setTimeout(function(){o.noscontextmenu("destroy").remove()},200);j.simulate("mousedown",{clientX:n.left,clientY:n.top});m.css({position:"absolute",left:0,right:0,top:0,bottom:0,zIndex:"100000"}).appendTo("body").on("click",function(p){var q=a(p.target).offset();m.remove();j.simulate("mouseup",{clientX:q.left,clientY:n.top});l.uiOstabsTabs.sortable("destroy");j.data("createcontextmenu.tabs",false);l._contextMenu(j);return false});return false},label:e.texts.moveTab,iconClass:"ui-icon-arrow-4"})}}if(("HTMLMenuItemElement" in window)){l.element.find("#"+j.attr("id")+"-menucontext").remove();i=a("<menu></menu>").attr({type:"context",id:j.attr("id")+"-menucontext"}).prependTo(l.element);a.each(g,function(){var m=this;a("<menuitem></menuitem>").attr({label:"Novius OS - "+m.label,icon:m.iconUrl}).click(function(){return m.click()}).appendTo(i)});j.attr("contextmenu",j.attr("id")+"-menucontext")}else{if(!j.data("createcontextmenu.tabs")){j.data("createcontextmenu.tabs",true);j.one("mouseenter",function(m){i=a("<ul></ul>").addClass("nos-ostabs-menuactions").prependTo(l.element);a.each(g,function(){var n=this,o=a('<li><a href="#"></a></li>').appendTo(i).find("a").click(function(p){i.noscontextmenu("hideAllMenus",p);n.click();return false});a("<span></span>").addClass("ui-icon wijmo-wijmenu-icon-left "+n.iconClass).appendTo(o);a("<span></span>").addClass("wijmo-wijmenu-text").html(n.label).appendTo(o)});i.noscontextmenu({trigger:"#"+d});j.data("contextmenu.tabs",i)})}}},_tabsWidth:function(){var d=this,h=d.options,f=0;d.uiOstabsTabs.width(10000000);d.uiOstabsTabs.find("li").each(function(){f+=a(this).outerWidth(true)});d.uiOstabsTabs.width(f);var e=d.uiOstabsTabs.find(".nos-ostabs-label:visible").length,g;if(d.tabsWidth<d.uiOstabsTabs.width()){while(d.tabsWidth<d.uiOstabsTabs.width()&&d.labelWidth>h.labelMinWidth){g=d.labelWidth-h.labelMinWidth;g=g>10?10:g;f=f-e*g;d.uiOstabsTabs.width(f);d.labelWidth=d.labelWidth-g;a("head .tabswidth").remove();a('<style type="text/css" class="tabswidth">.nos-ostabs .nos-ostabs-header .nos-ostabs-label {width : '+d.labelWidth+"px !important;}</style>").appendTo("head")}}else{do{g=h.labelMaxWidth-d.labelWidth;g=g>10?10:g;if(d.tabsWidth>(f+e*10)){f=f+e*g;d.uiOstabsTabs.width(f);d.labelWidth=d.labelWidth+g;a("head .tabswidth").remove();a('<style type="text/css" class="tabswidth">.nos-ostabs .nos-ostabs-header .nos-ostabs-label {width : '+d.labelWidth+"px !important;}</style>").appendTo("head")}}while(d.tabsWidth>(f+e*10)&&d.labelWidth<h.labelMaxWidth)}if(d.tabsWidth<d.uiOstabsTabs.width()){d.uiOstabsSuperPanel.find(".wijmo-wijsuperpanel-buttonleft, .wijmo-wijsuperpanel-buttonright").css("visibility","visible")}else{d.uiOstabsSuperPanel.find(".wijmo-wijsuperpanel-buttonleft, .wijmo-wijsuperpanel-buttonright").css("visibility","hidden")}},add:function(f,e){var d=this,g=d.options;if(!a.isPlainObject(f)||f.url===c){return false}if(e===c){if(a(d.lis.get(g.selected)).hasClass("nos-ostabs-desktoptab")){e=d.anchors.length-1}else{e=g.selected+1}}var h=d._add(f);if(e<d.lis.length){h.insertBefore(d.lis[e])}else{h.insertBefore(d.lis[d.lis.length-1]);e=d.lis.length-1}d._refreshSortable()._tabify();if(d.anchors.length==1){d.select(0)}d._trigger("add",f,d._ui(h[0]));return e},_add:function(e,g,f){var l=this,d=l.options,j,h,i,k;if(!a.isPlainObject(e)||e.url===c){return false}g=g||l.uiOstabsTabs;e=a.extend({url:"",iframe:false,label:"",labelDisplay:true,iconClasses:"ui-icon ui-icon-document",iconUrl:"",openRank:false,iconSize:16,panelId:false},e);if(e.openRank!==false&&e.openRank>=l.openRank){l.openRank=e.openRank+1}j=a('<a href="'+e.url+'" onclick="return false;"></a>');if(e.iframe){j.data("iframe.tabs",true)}if(e.panelId){j.data("panelid.tabs",e.panelId)}h=l._icon(e).appendTo(j);i=a("<span></span>").addClass("nos-ostabs-label").html(e.label?(e.label+"").replace(/</g,"&lt;"):"New tab").appendTo(j);if(!e.labelDisplay){i.hide()}k=a("<li></li>").append(j).attr("title",i.text()).addClass("ui-corner-top ui-state-default").data("ui-ostab",e).appendTo(g);if(!f){a("<span><span></span></span>").addClass("nos-ostabs-closetab").attr("title",d.texts.closeTab).click(function(n){var m=this,o=a(m).closest("li");n.preventDefault();l.remove(l.lis.index(o),!o.hasClass("nos-ostabs-selected"))}).find("span").addClass("ui-icon ui-icon-closethick").text(d.texts.closeTab).end().appendTo(k)}if(!isNaN(e.iconSize)&&e.iconSize!==16&&g!==l.uiOstabsTabs){k.css({height:(e.iconSize+4)+"px",bottom:(e.iconSize-35)+"px"});h.css("top","2px")}return k},remove:function(f,g){var l=this;g=g||false;f=l._getIndex(f);var i=l.lis.eq(f),d,m=l.element.find(l._sanitizeSelector(a(l.anchors[f]).data("anchor.tabs"))),j=0,k=0;if(f==0&&!i.hasClass("nos-ostabs-selected")){var h=l.lis.filter(".nos-ostabs-newtab");if(h.hasClass("nos-ostabs-selected")){i=h}}if(i.not(".nos-ostabs-desktoptab").not(".nos-ostabs-newtab").length){d=i.data("contextmenu.tabs");if(d){d.noscontextmenu("destroy").remove()}i.remove();m.remove()}else{var e=i.data("ui-ostab");e.openRank=false;i.data("ui-ostab",e)}i.removeClass("ui-state-active ui-state-open");if(!g){j=f>2?f-1:(l.lis.length>3?1:0);l.lis.each(function(o){var n=a(this),p=n.data("ui-ostab")||{};if(n[0]!=i[0]&&p.openRank&&p.openRank>k){k=p.openRank;j=o}});j=l.anchors.eq(j).data("anchor.tabs")}if(i.not(".nos-ostabs-desktoptab").not(".nos-ostabs-newtab").length){a("> *",m).remove()}m.addClass("nos-ostabs-hide").removeData("callbacks.ostabs");i.removeClass("nos-ostabs-selected");l._tabify();l._trigger("remove",null,l._ui(i[0],m[0]));if(!g){l.select(j)}return l},title:function(e,g){var d=this,f=d.options;e=d._getIndex(e);var h=d.lis.eq(e);if(g===c){return h.find(".nos-ostabs-label").text()}else{h.find(".nos-ostabs-label").html(g.replace(/</g,"&lt;"));if(f.selected==e){a("title").html(g.replace(/</g,"&lt;"))}d._trigger("title",null,d._ui(h[0]));return d}},update:function(g,f){var k=this;g=k._getIndex(g);if(!a.isPlainObject(f)){return false}var e=!!f.url&&f.reload,h=k.lis.eq(g);f=a.extend({},h.data("ui-ostab"),f);if(e){delete f.reload;this.remove(g,true);this.add(f,g);this.select(g)}else{if(k.options.selected==g){a("title").html(f.label.replace(/</g,"&lt;"));var d=encodeURIComponent(f.url).replace(/%2F/g,"/");if("replaceState" in window.history){window.history.replaceState({},"",document.location.pathname+"?tab="+d)}else{document.location.hash="tab="+d}}var j=k._add(f),i=j.find("a"),l=k.panels.eq(g);h.data("ui-ostab",f).attr("title",j.find(".nos-ostabs-label").text()).addClass(j.attr("class")).find("a").empty().append(i.children()).data("href.tabs",f.url);k._contextMenu(h);j.remove();k._trigger("update",null,k._ui(h[0],l[0]))}return k},_icon:function(e){var d=a("<span></span>").addClass("nos-ostabs-icon");if(e.iconUrl){d.css("background-image",'url("'+e.iconUrl+'")')}else{d.addClass(e.iconClasses)}if(!isNaN(e.iconSize)&&e.iconSize!==16){d.css({width:e.iconSize+"px",height:e.iconSize+"px",lineHeight:e.iconSize+"px",top:(e.iconSize>22?22-e.iconSize:10-e.iconSize/2)+"px"})}return d},select:function(e){var d=this;e=d._getIndex(e);if(e==-1){return d}d.anchors.eq(e).trigger("click.tabs");return d},_load:function(h){var f=this;h=f._getIndex(h);var k=f.options,e=f.anchors.eq(h)[0],g=a.data(e,"load.tabs"),i=a.data(e,"iframe.tabs");f._abort();if((!g&&i)||f.element.queue("tabs").length!==0&&a.data(e,"cache.tabs")){f.element.dequeue("tabs");return}var d=f.element.find(f._sanitizeSelector(a(e).data("anchor.tabs"))),j=a("> *",d).length;if(j!==0){f.element.dequeue("tabs");return}f.lis.eq(h).addClass("ui-state-processing");if(a.isFunction(a.fn.loadspinner)){a("span.nos-ostabs-icon",e).each(function(){var l=a(this);l.addClass("ui-state-processing").loadspinner({diameter:l.width(),scaling:true})})}if(!i){f.xhr=a.ajax({url:g,cache:false,success:function(n,m,p){var l;a("<div></div>").addClass("nos-ostabs-panel-content nos-dispatcher").data("nos-ostabs-index",h).prependTo(d.data("callbacks.ostabs",{})).html(n);a.data(e,"cache.tabs",true);try{l=a.parseJSON(p.responseText);f.element.nosAjaxSuccess(l)}catch(o){}},complete:function(l){f._cleanup();f._trigger("load",null,f._ui(f.lis[h]))},error:function(m,l){f.remove(h);f.element.nosAjaxError(m,l)}})}else{a("<iframe "+(a.browser.msie?'allowTransparency="true" ':"")+'src="'+g+'" frameborder="0"></iframe>').data("nos-ostabs-index",h).addClass("nos-ostabs-panel-content nos-dispatcher").bind("load",function(){f._cleanup();f._trigger("load",null,f._ui(f.lis[h]))}).prependTo(d.data("callbacks.ostabs",{}));a.data(e,"cache.tabs",true)}f.element.dequeue("tabs");return f},reload:function(g){var e=this;g=e._getIndex(g);var k=e.options,d=e.anchors.eq(g)[0],f=a.data(d,"load.tabs"),h=a.data(d,"iframe.tabs"),i,j;e.select(g);e._abort();if((!f&&h)||e.element.queue("tabs").length!==0&&a.data(d,"cache.tabs")){e.element.dequeue("tabs");return}j=e.element.find(e._sanitizeSelector(a(d).data("anchor.tabs")));e.lis.eq(g).addClass("ui-state-processing");if(a.isFunction(a.fn.loadspinner)){a("span.nos-ostabs-icon",d).each(function(){var l=a(this);l.addClass("ui-state-processing").loadspinner({diameter:l.width(),scaling:true})})}if(!h){e.xhr=a.ajax({url:f,cache:false,success:function(n,m,p){var l;j.find(".nos-ostabs-panel-content").html(n);try{l=a.parseJSON(p.responseText);e.element.nosAjaxSuccess(l)}catch(o){}},complete:function(l){e._cleanup();e._trigger("load",null,e._ui(e.lis[g]))},error:function(m,l){e.remove(g);e.element.nosAjaxError(m,l)}})}else{i=j.find("iframe.nos-ostabs-panel-content");i.attr("src",i.attr("src"))}e.element.dequeue("tabs");return e},_abort:function(){var d=this;d.element.queue([]);d.panels.stop(false,true);d.element.queue("tabs",d.element.queue("tabs").splice(-2,2));d._cleanup();return d},tabs:function(){var d=this,e=[];d.uiOstabsTabs.find("li:not(.nos-ostabs-newtab)").each(function(){var f=a.extend({},a(this).data("ui-ostab"));delete f.openRank;e.push(f)});return e},dispatchEvent:function(e){var d=this,f=d.options;a.each(d.panels,function(){var j=a(this),g=j.find(".nos-ostabs-panel-content").data("nos-ostabs-index");if(g===f.selected){d._firePanelEvent(j,e)}else{var h=j.data("callbacks.ostabs");if(a.isPlainObject(h)){h[e.type+(e.namespace?"."+e.namespace:"")]=e}}});return d},_firePanelEvent:function(d,f){d=d.is(".nos-dispatcher")?d:d.find(".nos-dispatcher");if(d.is("iframe")){if(d[0].contentDocument.$){d[0].contentDocument.$("body").trigger(f)}}else{try{d.trigger(f)}catch(g){log("_firePanelEvent error",g,f)}}},current:function(){var d=this,e=d.options;return{tab:a(d.lis.get(e.selected)),panel:a(d.panels.get(e.selected)),index:e.selected}}});return a});
define("jquery-nos-tray",["jquery-nos"],function(a){a.fn.extend({nosTray:function(e){var d,b=window.document,c=b.fullscreenEnabled||b.fullScreenEnabled||b.mozFullscreenEnabled||b.mozFullScreenEnabled||b.webkitFullscreenEnabled||b.webkitFullScreenEnabled||b.msFullscreenEnabled||b.msFullScreenEnabled;e=e||{buttons:{}};d=e.buttons;if(d.fullscreen){if(c){d.fullscreen.bind={click:function(){var f=a("body")[0],g=b.fullscreenElement||b.fullScreenElement||b.mozFullScreenElement||b.mozFullscreenElement||b.webkitFullScreenElement||b.webkitFullscreenElement||b.msFullScreenElement||b.msFullscreenElement;if(g){if(b.exitFullscreen){b.exitFullscreen()}else{if(b.exitFullScreen){b.exitFullScreen()}else{if(b.mozExitFullscreen){b.mozExitFullscreen()}else{if(b.mozCancelFullScreen){b.mozCancelFullScreen()}else{if(b.webkitExitFullscreen){b.webkitExitFullscreen()}else{if(b.webkitExitFullScreen){b.webkitExitFullScreen()}else{if(b.msExitFullscreen){b.msExitFullscreen()}else{if(b.msExitFullScreen){b.msExitFullScreen()}}}}}}}}}else{if(f.requestFullscreen){f.requestFullscreen()}else{if(f.requestFullScreen){f.requestFullScreen()}else{if(f.mozRequestFullscreen){f.mozRequestFullscreen()}else{if(f.mozRequestFullScreen){f.mozRequestFullScreen()}else{if(f.webkitRequestFullscreen){f.webkitRequestFullscreen()}else{if(f.webkitRequestFullScreen){f.webkitRequestFullScreen()}else{if(f.msRequestFullscreen){f.msRequestFullscreen()}else{if(f.msRequestFullScreen){f.msRequestFullScreen()}}}}}}}}}}}}else{delete d.fullscreen}}return this.each(function(){var f=a("<div></div>").appendTo(this);a.each(d,function(){a.nosUIElement(this).appendTo(f)});f.nosFormUI().buttonset().nosOnShow();f.find(".wijmo-wijmenu").appendTo("body")})}});return a});
define("jquery-nos-preview",["jquery","jquery-nos","jquery-ui.widget","wijmo.wijsuperpanel"],function(a){var b=void (0);a.widget("nos.preview",{options:{meta:{},actions:[],data:null,dataParser:null,texts:{headerDefault:"Preview",selectItem:"No item selected"}},data:null,_create:function(){var c=this,d=c.options;c.element.addClass("nos-preview ui-widget ui-widget-content wijmo-wijgrid").parents(".nos-appdesk").bind("selectionChanged.appdesk",function(g,f){if(a.isPlainObject(f)){c.select(f)}else{c.unselect()}})},_init:function(){var c=this,d=c.options;c.data=c.data||d.data;if(a.isPlainObject(c.data)){c.select(c.data)}else{c.unselect()}},_uiHeader:function(g){var c=this,f=c.options;var d=a('<table cellspacing="0" cellpadding="0" border="0"><thead></thead></table>').addClass("nos-preview-header wijmo-wijsuperpanel-header wijmo-wijgrid-root wijmo-wijgrid-table").css({borderCollapse:"separate","-moz-user-select":"-moz-none"}).appendTo(c.element);var e=a("<tr></tr>").addClass("wijmo-wijgrid-headerrow").appendTo(d);a("<th><div><span></span></div></th>").addClass("wijgridth ui-widget wijmo-c1basefield ui-state-default wijmo-c1field").appendTo(e).find("div").addClass("wijmo-wijgrid-innercell").find("span").addClass("wijmo-wijgrid-headertext").html(g);return c},_uiFooter:function(d){var c=this,e=c.options;if(e.actions.length>0){c.uiFooter=a("<div></div>").addClass("nos-preview-footer").appendTo(c.uiContainer);a.each(e.actions,function(){var i=false;if(d&&d.actions){var g=d.actions[this.name];if(g==false){i=true}else{if(a.type(g)=="string"){i=g}}}var j=this,h=a.extend(true,{type:j.primary?"button":"link"},j,{disabled:i}),f=a.nosUIElement(h,d).appendTo(c.uiFooter).css({marginBottom:"5px"}).nosOnShow("show");c.uiFooter.nosFormUI()})}return c},_uiThumbnail:function(d){var c=this,e=c.options,f;if(d.thumbnail){f=d.thumbnail.replace(/64-64/g,"256-256")}else{if(d.thumbnailAlternate){f=d.thumbnailAlternate}}if(f){c._loadImg(d,f)}return c},_loadImg:function(d,f){var c=this;var e=c.options;a("<img />").error(function(){a(this).remove();if(f===d.thumbnail&&d.thumbnailAlternate){c._loadImg(d,d.thumbnailAlternate)}}).load(function(){var h=a(this),g=h.height();var j=a("<div></div>").addClass("nos-preview-thumb").css({background:'url("'+h.attr("src")+'") no-repeat center center',backgroundSize:"contains",height:(g<=100?g:100)+"px"}).prependTo(c.uiContainer);var i=null;a.each(e.actions,function(){if(this.name==e.actionThumbnail){i=this}});if(i!==null){j.attr({title:i.label}).css({cursor:"pointer"}).click(function(k){k.preventDefault();k.stopImmediatePropagation();a(this).nosAction(i.action,c.data)})}h.remove()}).css({position:"absolute",visibility:"hidden"}).attr("src",f).appendTo("body");return c},_uiMetaData:function(f){var c=this,g=c.options,d=0;var e=a('<table cellspacing="0" cellpadding="0" border="0"><tbody></tbody></table>').addClass("nos-preview-metadata wijmo-wijgrid-root wijmo-wijgrid-table").css({borderCollapse:"separate","-moz-user-select":"-moz-none"}).appendTo(c.uiContainer).find("tbody").addClass("ui-widget-content wijmo-wijgrid-data");a.each(g.meta,function(h,j){if(f[h]){var i=a("<tr></tr>").addClass("wijmo-wijgrid-row ui-widget-content wijmo-wijgrid-datarow"+(d%2?" wijmo-wijgrid-alternatingrow":"")).appendTo(e);a("<th><div></div></th>").addClass("wijgridtd wijdata-type-string").appendTo(i).find("div").addClass("wijmo-wijgrid-innercell").html(j.label||"");a("<td><div></div></td>").addClass("wijgridtd wijdata-type-string").appendTo(i).find("div").addClass("wijmo-wijgrid-innercell").text(f[h]||"");d++}});return c},unselect:function(){var c=this,d=c.options;if(c.element.data("wijmo-wijsuperpanel")){c.element.wijsuperpanel("destroy")}c.element.empty();c._uiHeader(d.texts.headerDefault);c.uiContainer=a("<div></div>").addClass("nos-preview-noitem").html(d.texts.selectItem).appendTo(c.element);c.element.wijsuperpanel({showRounder:false});return c},select:function(d){var c=this,e=c.options;if(d===b){return c.data}else{c.data=d;if(a.isFunction(e.dataParser)){d=e.dataParser(d)}c.element.wijsuperpanel("destroy").empty().css("height","100%");c._uiHeader(d.title||e.texts.headerDefault);c.uiContainer=a("<div></div>").addClass("nos-preview-container").appendTo(c.element);c._uiThumbnail(d)._uiMetaData(d)._uiFooter(d);c.element.wijsuperpanel({showRounder:false,autoRefresh:true})}return c},resize:function(){var c=this;c._init();return c}});return a});
define("jquery-nos-listgrid",["jquery","jquery-nos","jquery-ui.widget","wijmo.wijgrid"],function(a){a.widget("nos.noslistgrid",a.wijmo.wijgrid,{options:{noCellsSelected:false,pageSizeAuto:false,culture:a.nosLang.substr(0,2),loadingText:"Loading...",columnsOptions:{hideContexts:true},pagerSettings:{mode:"numericFirstLast",position:"bottom"}},_create:function(){var b=this,d=b.options,c;if(d.pageSizeAuto){d.pageSize=b._calculatePageSize(b.element.height())}b._compileColumns()._super()},_init:function(){var e=this,f=e.options,b,d,c;if(a.isFunction(f.columnResized)){b=f.columnResized}f.columnResized=function(i,g){var h=e.option("columns");a.extend(h[g.column.thX],{ensurePxWidth:true,width:g.column.width});e.setSize(e.outerDiv.parent().width());if(a.isFunction(b)){b.apply(this,arguments)}};if(a.isFunction(f.dataLoaded)){d=f.ajaxError}f.ajaxError=function(i,g){var h=g.XMLHttpRequest;if(h.status==403){a(this).nosAjaxError(h)}if(a.isFunction(d)){d.apply(this,arguments)}};if(f.noCellsSelected){if(a.isFunction(f.cellStyleFormatter)){c=f.cellStyleFormatter}f.cellStyleFormatter=function(g){if(a.isFunction(c)){c.apply(this,arguments)}if(g.$cell.is("td")){g.$cell.removeClass("ui-state-highlight ui-state-default")}}}e._super()},_fakeForSize:function(e,f){var c=this,b=a("<div></div>").insertAfter(c.outerDiv||c.element),d=a('<table class="grid-fake"></table>').appendTo(b).noslistgrid(e),g=f(d,b);d.noslistgrid("destroy");b.remove();return g},_actionsWidth:function(c){var b=this;return b._fakeForSize({scrollMode:"none",showFilter:true,allowPaging:true,columns:[{headerText:"",cellFormatter:function(d){if(a.isPlainObject(d.row.data)){var e=a.nosItemActions(c,[]);e.appendTo(d.$container);d.$container.parent().addClass("buttontd");return true}},allowSizing:true,showFilter:false,ensurePxWidth:true}],data:[{key:"value"}]},function(e,d){e.find(".buttontd.wijgridtd").css("width","auto");return d.find(".buttontd .buttontd:first").outerWidth()})},_sectionsHeights:false,_getSectionsHeights:function(){var b=this;if(!b._sectionsHeights){b._sectionsHeights=b._fakeForSize({pageSize:1,showFilter:true,allowPaging:true,data:[["test"],["test2"]]},function(d,c){return{row:d.find("> tbody").find("tr:first").height(),footer:c.find(".wijmo-wijgrid-footer").outerHeight(),header:c.find(".wijmo-wijgrid-headerrow").outerHeight(),filter:c.find(".wijmo-wijgrid-filterrow").outerHeight()}})}return b._sectionsHeights},_calculatePageSize:function(b){var c=this,e=c.options,d=c._getSectionsHeights();return Math.floor((b-d.footer-d.header-(e.showFilter?d.filter:0))/d.row)},setSize:function(e,b){var d=this,f=d.options,c;this._super(e,b);if(f.pageSizeAuto&&(b||b===0)){c=d._calculatePageSize(b);if(c!=f.pageSize){d._setOption("pageSize",c)}}},_compileColumns:function(){var c=this,f=c.options,d=f.columns,g=f.columnsOptions,b=[],e={parseDOM:function(j,i,k,h){return this.parse(j.innerHTML,i,k,h)},parse:function(j,i,k,h){if(j===null){return h}return(j+"").replace(/&lt;/g,"<")},toStr:function(j,i,k,h){if(j===null){return h}return(j+"").replace(/</g,"&lt;")}};a.each(d,function(){var j=this,k,l,i,h;if(j.context){if(g.hideContexts){return true}k=a.nosContext({locales:g.locales,sites:g.sites,contexts:g.contexts});b.push({headerText:k.label({oneLocale:g.texts.sites,oneSite:g.texts.languages,defaultLabel:g.texts.contexts}),visible:j.visible,dataKey:"context",allowSort:false,showFilter:false,cellFormatter:function(m){if(m.row.type&a.wijmo.wijgrid.rowType.data){m.$container.css("text-align","center").html(m.row.data.context);return true}},width:1});return true}if(j.actions){l=j.actions===true?g.actions:j.actions;h=j.showOnlyArrow?true:false;if(h){i=20}else{i=c._actionsWidth(l)}b.push({headerText:"",cellFormatter:function(m){var n;if(a.isPlainObject(m.row.data)){n=a.nosItemActions(l,m.row.data,{showOnlyArrow:h});n.appendTo(m.$container);m.$container.parent().addClass("buttontd").css({width:i+1});return true}},allowSizing:false,allowSort:false,width:i,ensurePxWidth:true,showFilter:false});return true}if(j.cellFormatters){(function(){var n=a.isPlainObject(j.cellFormatters)?j.cellFormatters:[j.cellFormatter];var m=j.cellFormatter;j=a.extend(j,{cellFormatter:function(o){if(o.row.type&a.wijmo.wijgrid.rowType.data){o.$container.html(o.formattedValue);if(a.isFunction(m)){m.call(this,o)}a.each(n,function(r,q){q=a.nosDataReplace(a.extend(true,{},q),o.row.data);q=a.type(q)==="object"?q:{type:q};if(q.ignore&&parseInt(q.ignore)>0){return}if(q.replace){o.$container.empty()}switch(q.type){case"bold":o.$container.css("font-weight","bold");break;case"css":if(a.type(q.css)==="object"){o.$container.css(q.css)}break;case"icon":if(a.isPlainObject(o.row.data)){var s="";q.column&&o.row.data[q.column]&&(s=o.row.data[q.column]);q.src&&(s=q.src);a.type(q.mapping)==="object"&&q.mapping[o.formattedValue]&&(s=q.mapping[o.formattedValue]);if(!s){break}var p=(q.size?' width="'+q.size+'" height="'+q.size+'"':"");o.$container.prepend(' <img src="'+s+'" '+p+' style="vertical-align: middle;" /> ')}break;case"iconClasses":if(a.isPlainObject(o.row.data)){if(q.column&&!o.row.data[q.column]){break}o.$container.prepend(' <span class="'+(q.column?o.row.data[q.column]:q.classes)+'" style="float:left;"></span> ')}break;case"link":if(q.action==="default"){if(a.isArray(l)&&l.length&&l[0].action){q.action=l[0].name}else{if(g.actions){q.action=Object.keys(g.actions)[0]}}}if(q.action&&a.type(q.action)!=="object"&&g.actions&&g.actions[q.action]){q._action_name=q.action;q.action=g.actions[q.action].action}if(q._action_name&&o.row.data.actions&&a.type(o.row.data.actions[q._action_name])==="string"){break}if(a.type(q.action)==="object"){o.$container.wrapInner(a('<a href="#"></a>').click(function(t){t.preventDefault();a(this).nosAction(q.action,o.row.data)}))}break;default:if(typeof q.type!=="undefined"){require([q.type],function(t){t.format(q,o)},function(){log("Could not load formatter: "+q.type)})}}});return true}}})})();delete j.cellFormatters}if(!j.dataParser&&!j.isSafeHtml&&!j.dataType){j.dataParser=e}b.push(j)});f.columns=b;return c}});return a});
define("jquery-nos-treegrid",["jquery","jquery-nos","jquery-ui.widget","jquery-nos-listgrid","wijmo.wijgrid","wijmo.wijdatasource"],function(a){var b=void (0);a.widget("nos.nostreegrid",a.nos.noslistgrid,{options:{urlJson:"",treeOptions:null,treeColumnIndex:0,culture:a.nosLang.substr(0,2),sortable:true,movable:true,data:[],initialDepth:2,preOpen:null},oldFirstColumn:null,gridData:null,treeData:{},treeDataSource:null,dragged:false,dropTarget:false,dragHelper:false,mousePressed:false,mouseMoved:false,timer:false,_create:function(){var d=this,f=d.options;if(a.isFunction(f.rendered)){var e=f.rendered}f.rendered=function(){if(a.isFunction(e)){e.apply(this,arguments)}d._dragInit()};if(a.isFunction(f.rowStyleFormatter)){var c=f.rowStyleFormatter}f.rowStyleFormatter=function(g){if(a.isFunction(c)){c.apply(this,arguments)}if(d.draggedIndex&&g.state&a.wijmo.wijgrid.renderState.hovered){g.$rows.removeClass("ui-state-hover")}};f.allowPaging=false;d._super()},_init:function(){var c=this,d=c.options;c.oldFirstColumn=a.extend(true,{},d.columns[d.treeColumnIndex]);d.columns[d.treeColumnIndex].cellFormatter=function(e){if(a.isPlainObject(e.row.data)){var g=e.$container.closest("tr"),f=e.row.data;if(e.column.dataKey){a("<span></span>").text(e.row.data[e.column.dataKey]).appendTo(e.$container)}if(a.isFunction(c.oldFirstColumn.cellFormatter)){c.oldFirstColumn.cellFormatter(e)}if(f.treeChilds){a('<div class="nostreegrid-toggle"></div>').css({marginLeft:(f.treeLevel*20)+"px",cursor:"pointer"}).addClass("ui-icon").addClass(a.isPlainObject(f.treeChilds)?"ui-icon-triangle-1-se":"ui-icon-triangle-1-e").click(function(h){h.stopImmediatePropagation();if(a.isPlainObject(f.treeChilds)){c._toggle(g,false)}else{c._toggle(g,true)}}).prependTo(e.$container)}else{a('<div class="nostreegrid-toggle"></div>').css({marginLeft:(f.treeLevel*20)+"px"}).addClass("nos-icon16 nos-icon16-empty").prependTo(e.$container)}g.data("treeNode",f);return true}};if(d.movable){d.columns.unshift({allowSort:false,allowMoving:false,allowSizing:false,width:25,ensurePxWidth:true,cellFormatter:function(e){if(a.isPlainObject(e.row.data)){e.$container.append('<div class="ui-icon ui-icon-grip-dotted-vertical nostreegrid-move-handle"></div>');return true}}})}a.each(d.columns,function(){this.sortDirection="none"});c._super();c._activateSpinner();c._datasource();c.treeDataSource.proxy.options.data.depth=d.initialDepth;if(a.isPlainObject(d.preOpen)){c.treeDataSource.proxy.options.data.preOpen=d.preOpen}c.treeDataSource.load();d.preOpen=null;delete c.treeDataSource.proxy.options.data.preOpen},_setOption:function(d,e){var c=this;c._superApply(arguments);if(d==="treeOptions"){c._datasource().reload()}},_datasource:function(){var c=this,d=c.options;c.treeDataSource=new wijdatasource({dynamic:true,proxy:new wijhttpproxy({url:d.urlJson,dataType:"json",error:function(e,g,f){log(e,g,f)},data:d.treeOptions||{}}),loaded:function(i,g){var h=c._gridData(),f=function(j){return a.map(j,function(l,k){if(k==="length"){return null}var m=l;if(a.isPlainObject(l.treeChilds)){m=[l].concat(f(l.treeChilds))}return m})};if(!a.isPlainObject(g)){c.treeData=c._completeChilds(null,i.items);Array.prototype.splice.apply(h,[0,h.length].concat(f(c.treeData)))}else{var e=a.inArray(g.node,h);c._removeNode(g.node);if(g.close){g.node.treeChilds=i.data.total;Array.prototype.splice.apply(h,[e,0,g.node])}else{g.node.treeChilds=c._completeChilds(g.node,i.items);Array.prototype.splice.apply(h,[e,0,g.node].concat(f(g.node.treeChilds)))}}c._setGridData(h);c._deactivateSpinner()},reader:{read:function(e){e.items=e.data.items}}});return c},_dragInit:function(){var c=this,e=c.options;if(!e.movable){return c}c.element.find("tr.wijmo-wijgrid-row").each(function(){var h=a(this),g=h.data("treeNode"),i=h.find(".nostreegrid-move-handle");if(!c._trigger("movabled",null,{node:g,$tr:h})){return false}i.mousedown(function(k){if(k.which!=1){return true}k.stopImmediatePropagation();c.mousePressed=new Date().getTime();var j=h.clone();c.dragHelper=a('<div class="nostreegrid-drag-helper ui-state-highlight"></div>').hide().css("opacity","0.8").append(j.find("td:eq(1)").find(">div")).appendTo("body");c.helperInsert=a('<div class="nostreegrid-drag-inserthelper ui-state-highlight"></div>');a(document).on("mousemove",{treeGrid:c,node:g,$tr:h},c._dragStart).on("mouseup",{treeGrid:c},c._dragDestroy)});h.mouseup(function(){if(c.mousePressed&&c.mouseMoved&&c.dragged&&c.dropTarget){if(c._trigger("dropped",null,{dragged:c.dragged,dropped:h,notification:true})){c._move(h)}}c._dragDestroy()})});if(c.draggedIndex){var f=c.mousePressed,d=c.element.find("tr.wijmo-wijgrid-row").eq(c.draggedIndex);c._dragDestroy();d.find(".nostreegrid-move-handle").trigger(jQuery.Event("mousedown",{which:1}));c.mousePressed=f;c.dragOpen.event.target=c.element.find("tr.wijmo-wijgrid-row")[c.dragOpen.index];c.dragOpen.event.data.$tr=d;d.trigger(c.dragOpen.event)}return c},_dragStart:function(c){var q=c.data.treeGrid,e=q.options,f=c.data.node,k=c.data.$tr;if(!e.movable){return q}if(q.mousePressed&&(new Date().getTime()-q.mousePressed)>500){if(!q._scroller){q._scroller={superpanel:q._view()._scroller.data("wijmo-wijsuperpanel")};var p=q._scroller.superpanel.getContentElement(),i=p.parent(),g=i.offset();q._scroller.contentElement=q._scroller.superpanel.getContentElement();q._scroller.contentWrapper=q._scroller.contentElement.parent();a.extend(q._scroller,q._scroller.contentElement.offset(),{bottom:g.top+i.height()})}if(c.pageY<q._scroller.top){q._scroller.superpanel._doScrolling("top",q._scroller.superpanel,true)}else{if(c.pageY<(q._scroller.top+20)){q._scroller.superpanel._doScrolling("top",q._scroller.superpanel)}else{if(c.pageY>q._scroller.bottom){q._scroller.superpanel._doScrolling("bottom",q._scroller.superpanel,true)}else{if(c.pageY>(q._scroller.bottom-20)){q._scroller.superpanel._doScrolling("bottom",q._scroller.superpanel)}}}}if(!q.mouseMoved){var j=a("body");if(j.css("cursor")){q._cursor=j.css("cursor")}j.css("cursor","move");q.mouseMoved=true}if(q.timer){clearTimeout(q.timer)}if(!q.dragHelper.is(":visible")){q.dragHelper.show();q.dragged=k;q.draggedIndex=k.data("wijgriddataItemIndex")}q.dragHelper.css({left:(c.pageX+5),top:(c.pageY+15)});k.css("visibility","hidden");q.dropTarget=false;var d=a(c.target).parents("tr:first");if(a(c.target).closest(q.element).size()&&(a(c.target).is("tr.wijmo-wijgrid-row")||a(c.target).parents("tr.wijmo-wijgrid-row").size())){var l=d.data("treeNode"),h=a.extend({width:d.width(),height:d.height()},d.offset()),m=d.find(".nostreegrid-toggle"),n=a.inArray(f.treeHash,l.treePath)!==-1;if(!n&&e.sortable&&c.pageY<(h.top+5)){q.dropTarget="before";d.removeClass("ui-state-hover");q.helperInsert.css({marginLeft:(parseInt(m.css("margin-left").replace("px",""))+m.width())+"px",marginBottom:""}).insertBefore(m)}else{if(!n&&e.sortable&&c.pageY>(h.top+h.height-5)){q.dropTarget="after";d.removeClass("ui-state-hover");q.helperInsert.css({marginLeft:(parseInt(m.css("margin-left").replace("px",""))+m.width())+"px",marginTop:""}).appendTo(d.find("td:eq(1)").find(">div"))}else{q.helperInsert.detach();if(n||!q._trigger("dropped",null,{dragged:k,dropped:d,notification:false})){d.removeClass("ui-state-hover")}else{q.dropTarget="in";if(a(c.target).hasClass("nostreegrid-toggle")&&a(c.target).hasClass("ui-icon-triangle-1-e")){q.timer=setTimeout(function(){q.dragOpen={event:c,index:d.data("wijgriddataItemIndex")};a(c.target).click()},700)}d.addClass("ui-state-hover")}}}}else{d.removeClass("ui-state-hover");q.dragHelper.hide();q.helperInsert.detach()}}return q},_dragDestroy:function(d){var c=d?d.data.treeGrid:this,e=c.options;if(!e.movable){return c}if(c.timer){clearTimeout(c.timer)}if(c.dragHelper){a(document).off("mousemove",c._dragStart).off("mouseup").off("mousedown");a("body").css("cursor",c._cursor||"auto");c.dragHelper.remove();c.helperInsert.remove();if(c.dragged){c.dragged.css("visibility","visible")}c.dragged=c.mousePressed=c.mouseMoved=c.dragHelper=c.timer=c._scroller=false}return c},_completeChilds:function(e,f){var d=this,c=0,g={};a.each(f,function(i,h){a.extend(h,{treeHash:h._model+"|"+h._id,treeLevel:!e?0:e.treeLevel+1,treePath:!e?[]:e.treePath.concat([e.treeHash])});if(a.isArray(h.treeChilds)||a.isPlainObject(h.treeChilds)){h.treeChilds=d._completeChilds(h,h.treeChilds)}c++;g[h.treeHash]=h});return a.extend({length:c},g)},_getTreeNode:function(e){var c=this,d=null;a.each(e,function(f,g){d=!d?c.treeData[g]:d.treeChilds[g]});return d},_move:function(g){var c=this,f=c.options,e=c.dragged.data("treeNode"),d=g.data("treeNode");a.ajax({async:true,url:f.urlJson,data:{move:true,itemModel:e._model,itemId:e._id,targetModel:d._model,targetId:d._id,targetType:c.dropTarget},dataType:"json",success:function(l,m){if(l.success){c.draggedIndex=false;if(c.dropTarget==="in"){c._removeNode(e);c._toggle(g,true)}else{var i=c._getTreeNode(e.treePath),k=c._getTreeNode(d.treePath),h,j;if(k){h=a.inArray(k,c._gridData());j=c.element.find("tr.wijmo-wijgrid-row").eq(h)}c._removeNode(e);if(i){delete i.treeChilds[e.treeHash];delete i.treeChilds.length;i.treeChilds=c._completeChilds(i,i.treeChilds)}if(j){c._toggle(j,true)}else{c.reload()}}}if(l.error){a.nosNotify(l.error,"error")}},error:function(h,j,i){log("error",j,i)}});return c},_toggle:function(f,d){var c=this,g=c.options,e=f.data("treeNode");d=d===b?f.hasClass("ui-icon-triangle-1-e"):d;f.find(".nostreegrid-toggle").addClass(d?"ui-icon-clock":"ui-icon-triangle-1-e").removeClass(d?"ui-icon-triangle-1-e":"ui-icon-triangle-1-se");c.treeDataSource.proxy.options.data.depth=d?1:-1;c.treeDataSource.proxy.options.data.id=e._id;c.treeDataSource.proxy.options.data.model=e._model;c.treeDataSource.load({close:d?false:true,node:e});return c},_removeNode:function(e){var c=this,d=false,g=0,f=c._gridData();a.each(f,function(j,k){var h=e.treeHash===k.treeHash||a.inArray(e.treeHash,k.treePath)!==-1;if(h){if(d===false){d=j}g++}if(!h&&d){return false}});if(d!==false){Array.prototype.splice.apply(f,[d,g])}return g},_gridData:function(){var c=this;if(!c.gridData){c.gridData=a.extend([],c.data())}return c.gridData},_setGridData:function(d){var c=this;c._setOption("data",d);c.gridData=null;return c},reload:function(){var c=this,d=c.options;c.treeDataSource.proxy.options.data.depth=d.initialDepth;delete c.treeDataSource.proxy.options.data.id;delete c.treeDataSource.proxy.options.data.model;c.treeDataSource.load();return c}});return a});
define("jquery-nos-thumbnailsgrid",["jquery","jquery-nos","jquery-ui.widget","wijmo.wijsuperpanel","wijmo.wijpager"],function(a){var b=void (0);a.widget("nos.thumbnailsgrid",{options:{thumbnailSize:128,pageIndex:0,pageSize:null,url:"",texts:{loading:"Loading..."},actions:[],loading:null,loaded:null,reader:null,dataParser:null,thumbFormatter:null},_data:null,_create:function(){var c=this;c.uiPager=a("<div></div>").addClass("wijmo-wijsuperpanel-footer  ui-state-default").appendTo(c.element)},destroy:function(){var c=this,d=c.options;c.uiPager.wijpager("destroy");c.uiPager.remove();c.element.removeClass("nos-thumbnailsgrid nos-thumbnailsgrid-size-"+d.thumbnailSize).wijsuperpanel("destroy");a.Widget.prototype.destroy.apply(this,arguments)},_init:function(){var d=this,f=d.options;if(a.inArray(f.thumbnailSize,[64,128])===-1){f.thumbnailSize=128}d.uiPager.wijpager({pageIndexChanging:function(h,g){d._trigger("pageIndexChanging",null,g);f.pageIndex=g.newPageIndex;d._load()},pageIndexChanged:function(h,g){d._trigger("pageIndexChanged");f.pageIndex=g.newPageIndex;d._load()}});d.element.addClass("nos-thumbnailsgrid nos-thumbnailsgrid-size-"+f.thumbnailSize).wijsuperpanel({showRounder:false,autoRefresh:true});d.uiContainer=a(d.element.wijsuperpanel("getContentElement"));d.uiOverlay=a("<div></div>").addClass("nos-thumbnailsgrid-overlay ui-widget-overlay").appendTo(d.element);d.uiOverlayText=a("<span><span></span>"+f.texts.loading+"</span>").addClass("nos-thumbnailsgrid-loadingtext ui-widget-content ui-corner-all").find("span").addClass("ui-icon ui-icon-clock").end().appendTo(d.element);d.uiOverlayText.css({marginLeft:(d.uiOverlayText.width()*-1/2)+"px",marginTop:(d.uiOverlayText.height()*-1/2)+"px"});if(f.pageSize===null){d._displayItem({title:"Test"});var e=d.uiContainer.find(".nos-thumbnailsgrid-thumb"),c=d.uiContainer.parent();d.itemDimension={width:e.outerWidth(true),height:e.outerHeight(true)};d.uiContainer.empty();f.pageSize=Math.floor(c.width()/d.itemDimension.width)*Math.max(1,Math.floor(c.height()/d.itemDimension.height))}d.dataSource=new wijdatasource({dynamic:true,proxy:new wijhttpproxy({url:f.url,dataType:"json",error:function(g,i,h){if(g.status==403){a(this).nosAjaxError(g)}d.uiOverlay.hide();log(g,i,h)},data:{}}),loading:function(h,g){h.proxy.options.data=a.extend(h.proxy.options.data,g.data);d.uiOverlay.add(d.uiOverlayText).show();if(a.isFunction(f.loading)){f.loading(h,g)}},loaded:function(h,g){if(a.isFunction(f.loaded)){f.loaded(h,g)}d.uiPager.wijpager("option",{pageCount:Math.ceil(h.data.totalRows/g.data.paging.pageSize),pageIndex:g.data.paging.pageIndex});d._data=h.data;d._display(h.data);d.uiOverlay.add(d.uiOverlayText).hide()},reader:f.reader});d._load()},_load:function(){var c=this,d=c.options;c.dataSource.load({data:{paging:{pageIndex:d.pageIndex,pageSize:d.pageSize}},afterRefresh:null,beforeRefresh:null});return c},_display:function(d){var c=this,f=c.options,e=c.uiContainer.empty().parent();c.uiContainer.detach();a.each(d,function(g){var h={item:{title:this._title,thumbnail:(this.thumbnail?this.thumbnail:this.thumbnailAlternate).replace(/64/g,f.thumbnailSize),thumbnailAlternate:this.thumbnailAlternate.replace(/64/g,f.thumbnailSize),actions:[]},noParseData:this};c._displayItem(h,g)});c.uiContainer.appendTo(e);c._trigger("rendered");return c},_displayItem:function(h,i){var m=this,f=m.options,l=h.item,c=h.noParseData;l=a.extend({title:"",thumbnail:null,thumbnailAlternate:null},l);var e=a("<div></div>").addClass("nos-thumbnailsgrid-thumb wijmo-wijgrid ui-widget-content").data("thumbnail",{data:h,index:i}).appendTo(m.uiContainer),g=a('<table cellspacing="0" cellpadding="0" border="0"><tbody><tr><td></td></tr></tbody></table>').addClass("nos-thumbnailsgrid-thumb-grid wijmo-wijgrid-root wijmo-wijgrid-table").attr("title",l.title).css({borderCollapse:"separate","-moz-user-select":"-moz-none"}).hover(function(){g.parent().addClass("ui-state-hover")},function(){g.parent().removeClass("ui-state-hover")}).click(function(){m.select(i)}).appendTo(e).find("tbody").addClass("ui-widget-content wijmo-wijgrid-data").find("tr").addClass("wijmo-wijgrid-row ui-widget-content wijmo-wijgrid-datarow").find("td").addClass("wijgridtd"),d=a("<div></div>").addClass("nos-thumbnailsgrid-thumb-container-img wijmo-wijgrid-innercell").appendTo(g),k=a("<div></div>").addClass("nos-thumbnailsgrid-thumb-title wijmo-wijgrid-innercell").text(l.title).appendTo(g);m._itemThumbnail(d,l,i);var j=a.nosItemActions(f.actions,c);j.appendTo(e);if(a.isFunction(f.thumbFormatter)){f.thumbFormatter({"$container":e,item:{data:l,index:i}})}return m},_itemThumbnail:function(c,f,e){var d=this,h=d.options,i=f.thumbnail||f.thumbnailAlternate,g=f.colour;if(g){d._loadColour(c,g)}else{if(i){d._loadImg(c,f,i)}else{d._loadImgDefault(c)}}return d},_loadImg:function(c,e,g){var d=this,f=d.options;a("<img />").error(function(){if(g===e.thumbnail&&e.thumbnailAlternate){d._loadImg(c,e,e.thumbnailAlternate)}else{d._loadImgDefault(c)}}).load(function(){var h=a(this);h.prependTo(c).css({marginTop:"-"+(h.height()/2)+"px",marginLeft:"-"+(h.width()/2)+"px"})}).addClass("nos-thumbnailsgrid-thumb-img").attr("src",g);return d},_loadImgDefault:function(c){var d=this,e=d.options;a("<div></div>").addClass("nos-thumbnailsgrid-thumb-img-default").prependTo(c);return d},_loadColour:function(c,e){var d=this;a(c).css("backgroundColor",e);return d},select:function(d){var c=this,g=c.options;if(d===b){var f=c.uiContainer.find(".nos-thumbnailsgrid-thumb:has(wijmo-wijgrid-current-cell)");if(f.length){var e=f.data("thumbnail");return e.index}return null}else{c.uiContainer.find("td").removeClass("wijmo-wijgrid-current-cell ui-state-highlight");var f=c.uiContainer.find(".nos-thumbnailsgrid-thumb").eq(d);if(f.length){var e=f.data("thumbnail");f.find(".wijgridtd").eq(0).addClass("wijmo-wijgrid-current-cell ui-state-highlight");c._trigger("selectionChanged",null,{item:e})}else{c._trigger("selectionChanged");return false}}return c},unselect:function(){this._trigger("selectionChanged")},setSize:function(e,c){var d=this;if(e!==null){d.element.width(e)}if(c!==null){d.element.height(c)}return d},data:function(){return this._data}});return a});
define("jquery-nos-appdesk",["jquery","jquery-nos","jquery-ui.widget","jquery-nos-thumbnailsgrid","jquery-nos-listgrid","jquery-nos-treegrid","jquery-nos-preview","jquery-ui.button","wijmo.wijtabs","wijmo.wijsuperpanel","wijmo.wijsplitter","wijmo.wijgrid","wijmo.wijmenu"],function(b){var c=void (0),a=function(d){wijhttpproxy.call(this,d)};a.prototype=b.extend({},wijhttpproxy.prototype,{request:function(e,f,d){if(this._appdeskxhr){this._appdeskxhr.abort()}this._appdeskxhr=wijhttpproxy.prototype.request.call(this,e,f,d);return this._appdeskxhr}});b.widget("nos.appdesk",{options:{buttons:[],inspectors:[],thumbnails:false,defaultView:"grid",locales:{},sites:{},culture:b.nosLang.substr(0,2),contexts:{},hideContexts:false,texts:{allSites:"All sites",allLanguages:"All languages",allContexts:"All contexts",settings:"Settings",item:"item",items:"items",showNbItems:["Showing 1 item out of {{y}}","Showing {{x}} items out of {{y}}"],showNoItem:"No items",showNbTotal:"({{nb}} in total)",NItems:["1 item","{{count}} items"],showAll:"Show all items",viewGrid:"List",viewTreeGrid:"Tree",viewThumbnails:"Thumbnails",selectSites:"Select the site(s) to show",selectLanguages:"Select the language(s) to show",selectContexts:"Select the context(s) to show",workInContext:"Show {{context}}",otherSites:"Other sites",otherLanguages:"Other languages",otherContexts:"Other contexts",contextsPopinOk:"OK",loading:"Loading...",search:"Search"},values:{},slidersChange:null,splitters:{vertical:null,horizontal:null},views:{},selectedView:null,selectedContexts:[],fromView:null,name:null,grid:{}},pageIndex:0,showFilter:false,gridRendered:false,nosContext:false,resizing:true,init:false,itemSelected:null,variantColumnsProperties:{visible:true,width:true,showFilter:true},variantInspectorsProperties:{hide:true,vertical:true},hasInspectorHideOnMultiContext:false,_create:function(){var d=this,e=d.options;d.element.addClass("nos-appdesk");d.dispatcher=d.element.closest(".nos-dispatcher");if(!d.dispatcher.size()){d.dispatcher=d.element}d.element.nosToolbar("create");d._createLayout()},_createLayout:function(){var d=this,e=d.options;d.uiSplitterVertical=b("<div></div>").addClass("nos-appdesk-splitter-v").appendTo(d.element);d.uiSplitterVerticalLeft=b("<div></div>").appendTo(d.uiSplitterVertical);d.uiInspectorsVertical=b("<ul></ul>").addClass("nos-appdesk-inspectors nos-appdesk-inspectors-v").appendTo(d.uiSplitterVerticalLeft);d.uiSplitterVerticalRight=b("<div></div>").addClass("nos-appdesk-vpanel-left").appendTo(d.uiSplitterVertical);d.uiSplitterHorizontal=b("<div></div>").appendTo(d.uiSplitterVerticalRight);d.uiSplitterHorizontalTop=b("<div></div>").appendTo(d.uiSplitterHorizontal);d.uiInspectorsHorizontal=b("<ul></ul>").addClass("nos-appdesk-inspectors nos-appdesk-inspectors-h").appendTo(d.uiSplitterHorizontalTop);d.uiSplitterHorizontalBottom=b("<div></div>").addClass("nos-appdesk-hpanel-bottom").appendTo(d.uiSplitterHorizontal);d.uiSearchBar=b("<div><form><div></div></form></div>").addClass("nos-appdesk-searchbar-container wijmo-wijgrid ui-widget ui-widget-header ui-state-default").appendTo(d.uiSplitterHorizontalBottom).find("form").addClass("wijmo-wijgrid-headerrow wijmo-wijgrid-innercell").find("div").addClass("nos-appdesk-searchbar wijmo-wijgrid-headertext");d.uiNbResult=b("<div></div>").addClass("nos-appdesk-nbresult").appendTo(d.uiSearchBar);d.uiInputContainer=b("<div></div>").addClass("nos-appdesk-input-container ui-widget-content ui-corner-all").appendTo(d.uiSearchBar);d.uiViewsButtons=b("<div></div>").addClass("nos-appdesk-views-button").appendTo(d.uiSearchBar);d.uiSearchIcon=b("<div></div>").addClass("nos-appdesk-search-icon ui-icon ui-icon-search").appendTo(d.uiInputContainer);d.uiSearchInput=b('<input type="search" name="search" placeholder="'+e.texts.search+'" value="" />').addClass("nos-appdesk-search-input ui-helper-reset").appendTo(d.uiInputContainer);d.uiInspectorsTags=b("<div></div>").addClass("nos-appdesk-inspectorstags").appendTo(d.uiInputContainer);d.uiResetSearch=b('<a href="#"></a>').html(e.texts.showAll).attr("title",e.texts.showAll).addClass("nos-appdesk-reset-search").appendTo(d.uiInputContainer);d.uiuiResetSearchIcon=b("<span></span>").html(e.texts.showAll).addClass("ui-icon").appendTo(d.uiResetSearch);d.uiGridTitle=b("<div></div>").addClass("nos-appdesk-title").appendTo(d.uiSearchBar);d.uiPaginationLabel=b("<span></span>").addClass("nos-appdesk-pagination");d.uiGrid=b("<table></table>").appendTo(d.uiSplitterHorizontalBottom);d.uiTreeGrid=b("<table></table>").appendTo(d.uiSplitterHorizontalBottom);d.uiThumbnail=b("<div></div>").appendTo(d.uiSplitterHorizontalBottom);return d},_init:function(){var d=this,e=d.options;if(!b.isPlainObject(e.thumbnails)){e.thumbnails=false}else{e.thumbnails=b.extend({thumbnailSize:128},e.thumbnails)}if(!e.texts.gridTitle){e.texts.gridTitle=e.texts.items}d.nosContext=b.nosContext({locales:e.locales,sites:e.sites,contexts:e.contexts});if(!b.isEmptyObject(e.contexts)){if(!b.isArray(e.selectedContexts)){e.selectedContexts=b.type(e.selectedContexts)==="string"?[e.selectedContexts]:[]}b.each(e.selectedContexts,function(g,f){if(!e.contexts[f]){delete e.selectedContexts[f]}});if(e.selectedContexts.length===0){e.selectedContexts.push(Object.keys(e.contexts)[0])}}d.isMultiContextSelected=e.selectedContexts.length>1;d._css()._uiToolbar()._uiInspectorsPopulate()._uiSplitters()._uiInspectorsInit()._uiSearchBar()._uiList();d.init=true},_css:function(){var l=this,e=l.options;if(!b("style#inspectorsGrid").length){var g="";for(var j=0,f=document.styleSheets.length;j<f;j++){var h=document.styleSheets[j];if(h.href&&/wijmo/.test(h.href)){var i=h.rules?h.rules:h.cssRules;for(var d=0,k=i.length;d<k;d++){if(i[d].selectorText===".ui-widget-content"){g+=".nos-appdesk .nos-appdesk-splitter-v .wijmo-wijsplitter-v-panel2 .wijmo-wijsplitter-h-panel1 .wijmo-wijgrid-alternatingrow {background:"+i[d].style.background+";}";g+=".nos-appdesk .nos-appdesk-splitter-v .wijmo-wijsplitter-v-panel1 .wijmo-wijgrid-alternatingrow {background:"+i[d].style.background+";}"}if(i[d].selectorText===".wijmo-wijgrid tr.wijmo-wijgrid-row.ui-state-hover, .wijmo-wijgrid .wijmo-wijgrid-current-cell, .wijmo-wijgrid td.wijmo-wijgrid-rowheader.ui-state-active"||i[d].selectorText===".wijmo-wijgrid tr.ui-state-hover.wijmo-wijgrid-row, .wijmo-wijgrid .wijmo-wijgrid-current-cell, .wijmo-wijgrid td.ui-state-active.wijmo-wijgrid-rowheader"){g+=".nos-appdesk .nos-appdesk-splitter-v .wijmo-wijsplitter-v-panel2 .wijmo-wijsplitter-h-panel1 .wijmo-wijgrid-alternatingrow.ui-state-hover {background:"+i[d].style.background+";}";g+=".nos-appdesk .nos-appdesk-splitter-v .wijmo-wijsplitter-v-panel1 .wijmo-wijgrid-alternatingrow.ui-state-hover {background:"+i[d].style.background+";}"}}}}b('<style type="text/css" id="inspectorsGrid">'+g+"</style>").appendTo("head")}return l},_uiToolbar:function(){var d=this;return d._uiToolbarActions()._uiToolbarContexts()._uiToolbarViews()},_uiToolbarActions:function(){var d=this,e=d.options;if(!b.isArray(e.buttons)||!e.buttons.length){return d}b.each(e.buttons,function(h,g){var f;if(g.primary){f=b("<button></button>").html(g.label).data("icon",g.icon||"plus").addClass("ui-priority-primary").click(function(i){i.preventDefault();i.stopImmediatePropagation();b(this).nosAction(g.action,{context:e.selectedContexts.length?e.selectedContexts[0]:""})})}else{f=b('<a href="#"></a>').addClass("nos-appdesk-action-secondary").html(g.label).click(function(i){i.preventDefault();i.stopImmediatePropagation();b(this).nosAction(g.action,{context:e.selectedContexts.length?e.selectedContexts[0]:""})})}d.element.nosToolbar("add",f)});return d},_uiToolbarContexts:function(){var e=this,h=e.options;if(h.hideContexts||!!b.isEmptyObject(h.contexts)){return e}e.dispatcher.data("nosContext",h.selectedContexts);e._uiToolbarContextsButton();e.uiToolbarContextsDialog=b("<div><form><table><thead><tr><th></th></tr></thead><tbody></tbody></table></form></div>");var f=e.uiToolbarContextsDialog.find("table"),d=f.find("tbody"),g=f.find("tr");b.each(h.locales,function(i,j){b("<th></th>").html(j.title).append('<br /><img src="static/novius-os/admin/novius-os/img/flags/'+j.flag+'.png" />').appendTo(g)});b.each(h.sites,function(j,i){var k=b("<tr></tr>").appendTo(d);b("<th></th>").html(i.title).appendTo(k);b.each(h.locales,function(l,m){if(h.contexts[j+"::"+l]){b("<td></td>").append('<input type="checkbox" name="contexts" value="'+j+"::"+l+'" />').appendTo(k)}else{b("<td></td>").appendTo(k)}})});e.uiToolbarContextsDialog.wijdialog({title:e.nosContext.label({oneSite:h.texts.selectLanguages,oneLocale:h.texts.selectSites,defaultLabel:h.texts.selectContexts}),autoOpen:false,buttons:[{text:h.texts.contextsPopinOk,click:function(){h.selectedContexts=[];e.uiToolbarContextsDialog.find(":checked").each(function(){h.selectedContexts.push(b(this).val())});if(h.selectedContexts.length===0){e.uiToolbarContextsDialog.find(":checkbox").each(function(){h.selectedContexts.push(b(this).val())})}e._selectContexts()}}],captionButtons:{pin:{visible:false},refresh:{visible:false},toggle:{visible:false},minimize:{visible:false},maximize:{visible:false}},modal:true,open:function(){e.uiToolbarContextsDialog.nosOnShow("show");e.uiToolbarContextsDialog.find(":checkbox").prop("checked",false);b.each(h.selectedContexts,function(k,j){e.uiToolbarContextsDialog.find(':checkbox[value="'+j+'"]').prop("checked",true)});e.uiToolbarContextsDialog.wijdialog("option","width",Math.min(parseInt(e.uiToolbarContextsDialog.css("padding-left").replace("px"))*2+f.outerWidth(),window.innerWidth-200))}}).nosOnShow("one",function(){f.noslistgrid({scrollMode:"auto",columns:[{cellFormatter:function(i){i.$container.text(i.formattedValue).parent().addClass("wijmo-wijgrid-rowheader ui-widget-content ui-state-default").removeClass("wijdata-type-string");return true}}],noCellsSelected:true,cellStyleFormatter:function(i){if(i._cellIndex>0){i.$cell.css("text-align","center");if(i.row.dataRowIndex===-1){var k=f.noslistgrid("data");i.$cell.click(function(o){o.preventDefault();o.stopImmediatePropagation();var n=null;for(var l=1;l<=k.length;l++){var m=f.find("tr:eq("+l+")").find("td:eq("+i._cellIndex+")").find(":checkbox");if(n===null){n=m.is(":checked")}m.prop("checked",!n)}})}}else{var j=i.$cell.parent();i.$cell.click(function(m){m.preventDefault();m.stopImmediatePropagation();var l=j.find(":checkbox");l.prop("checked",!l.is(":checked"))})}}});e.uiToolbarContextsDialog.nosFormUI()});return e},_selectContexts:function(){var d=this,g=d.options,e=g.selectedContexts.length>1,f;d.uiToolbarContextsDialog.wijdialog("close");d._uiToolbarContextsButtonLabel();d.element.nosSaveUserConfig(g.name+".selectedContexts",g.selectedContexts);d.uiSearchInput.val("");if(d.uiInspectorsTags.data("wijmo-wijsuperpanel")){d.uiInspectorsTags.wijsuperpanel("destroy")}d.uiInspectorsTags.empty().css("width","auto");d.dispatcher.data("nosContext",g.selectedContexts);if(d.hasInspectorHideOnMultiContext&&d.isMultiContextSelected!=e){d.dispatcher.off("contextChange");d.uiSplitterVertical.remove();d._createLayout()._uiInspectorsPopulate()._uiSplitters()._uiInspectorsInit()._uiSearchBar()._uiList();f=d.dispatcher.data("appdeskChangeReloadEvent");if(b.isFunction(f)){d.dispatcher.on("contextChange",f)}}else{d._uiList();d.dispatcher.trigger("contextChange")}d.isMultiContextSelected=e;return d},_uiToolbarContextsButton:function(){var e=this,i=e.options;var d=b("<div><button></button><button></button></div>").addClass("nos-appdesk-buttoncontext"),g=new Date(),j=g.getDate()+"_"+g.getHours()+"_"+g.getMinutes()+"_"+g.getSeconds()+"_"+g.getMilliseconds(),f=b("<ul></ul>"),h=0;d.find("button:first").click(function(k){k.preventDefault();k.stopImmediatePropagation();e.uiToolbarContextsDialog.wijdialog("open")}).end().find("button:last").attr("id",j).html(e.nosContext.label({oneSite:i.texts.selectLanguages,oneLocale:i.texts.selectSites,defaultLabel:i.texts.selectContexts})).data({text:false,icons:{primary:"triangle-1-s"}});e.uiToolbarContextsButton=e.element.nosToolbar("add",d,true);e.uiToolbarContextsButton.buttonset();e._uiToolbarContextsButtonLabel();b("<li><a></a></li>").appendTo(f).find("a").html(e.nosContext.label({oneSite:i.texts.selectLanguages,oneLocale:i.texts.selectSites,defaultLabel:i.texts.selectContexts}));b("<li></li>").appendTo(f);b.each(i.contexts,function(k){h++;b("<li><a></a></li>").data("context",k).appendTo(f).find("a").append(i.texts.workInContext.replace("{{context}}",e.nosContext.contextLabel(k)));if(h>10&&Object.keys(i.contexts).length>12){b("<li><a></a></li>").appendTo(f).find("a").html(e.nosContext.label({oneSite:i.texts.otherLanguages,oneLocale:i.texts.otherSites,defaultLabel:i.texts.otherContexts}));return false}});f.insertAfter(e.uiToolbarContextsButton).wijmenu({orientation:"vertical",animation:{animated:"slide",option:{direction:"up"},duration:50,easing:null},hideAnimation:{animated:"slide",option:{direction:"up"},duration:0,easing:null},direction:"rtl",trigger:"#"+j,select:function(m,l){var n=b(l.item.element),k=n.data("context");if(k){i.selectedContexts=[k];e._selectContexts()}else{e.uiToolbarContextsDialog.wijdialog("open")}}});return e},_uiToolbarContextsButtonLabel:function(){var f="",j=0,g=0,i={},d={},e=this,k=e.options,h=e.uiToolbarContextsButton.find("button:first");if(k.selectedContexts.length===1){h.button("option","label",e.nosContext.contextLabel(k.selectedContexts[0]))}else{b.each(k.selectedContexts,function(o,n){var m=e.nosContext.siteCode(n),l=e.nosContext.localeCode(n);if(!i[m]){j++;i[m]=[]}i[m].push(l);if(!d[l]){g++;d[l]=[]}d[l].push(m)});if(Object.keys(k.contexts).length===k.selectedContexts.length){h.button("option","label",e.nosContext.label({oneSite:k.texts.allLanguages,oneLocale:k.texts.allSites,defaultLabel:k.texts.allContexts}))}else{if(j===1&&k.sites[Object.keys(i)[0]].locales.length===g){h.button("option","label",e.nosContext.siteLabel(Object.keys(i)[0])+", "+k.texts.allLanguages)}else{if(g===1&&k.locales[Object.keys(d)[0]].sites.length===j){h.button("option","label",k.texts.allSites+", "+e.nosContext.localeLabel(Object.keys(d)[0]))}else{b.each(i,function(m,l){if(f!==""){f+="&nbsp;&nbsp;"}if(Object.keys(k.sites).length>1){f+=e.nosContext.siteLabel(m,{"short":true})+" "}if(Object.keys(k.locales).length>1){b.each(l,function(o,n){f+=e.nosContext.localeLabel(n,{"short":true})+" "})}});h.button("option","label",f)}}}}return e},_uiToolbarViews:function(){var e=this,g=e.options;if(g.views[g.selectedView]&&g.views[g.selectedView].virtual){return e}var d=b("<select></select>"),f=0;b.each(g.views,function(i,h){if(h.virtual){return}f++;d.append(b("<option></option>").attr("value",i).prop("selected",g.selectedView==i).append(h.name))});if(f<=1){return e}d.change(function(){var h=b(this);h.nosSaveUserConfig(g.name+".selectedView",b(this).val());e.element.trigger("reloadView",{selectedView:b(this).val()})});e.element.nosToolbar("add",d,true);return e},_uiSplitters:function(){var e=this,g=!e.uiInspectorsVertical.is(":empty"),f=b.extend(true,{orientation:"vertical",splitterDistance:200,showExpander:false,fullSplit:false,panel1:{minSize:150,scrollBars:"none"},panel2:{minSize:200,scrollBars:"none"},sized:function(){e._trigger("slidersChange",null,e.slidersSettings());e._resizeInspectorsV()._resizeInspectorsH(true)._resizeList(true)}},e.options.splitters.vertical),d=b.extend(true,{orientation:"horizontal",fullSplit:g,splitterDistance:200,showExpander:false,panel1:{minSize:200,scrollBars:"none"},panel2:{minSize:200,scrollBars:"none"},sized:function(){e._trigger("slidersChange",null,e.slidersSettings());e._resizeInspectorsH()._resizeList(true)}},e.options.splitters.horizontal);if(g){e.uiSplitterVertical.wijsplitter(f)}else{e.uiSplitterVerticalLeft.remove();e.uiSplitterVerticalLeft.css({position:"absolute",top:0,bottom:0,width:"100%"})}if(!e.uiInspectorsHorizontal.is(":empty")){e.uiSplitterHorizontal.wijsplitter(d)}else{e.uiSplitterHorizontal.add(e.uiSplitterHorizontalBottom).css({position:"absolute",top:0,bottom:0,width:"100%"});e.uiSplitterHorizontalTop.remove()}return e},_uiInspectorsPopulate:function(){var d=this,e=d.options;b.each(e.inspectors,function(){if(this.multiContextHide){d.hasInspectorHideOnMultiContext=true}if(!this.hide&&(!this.multiContextHide||e.selectedContexts.length===1)){b("<li></li>").addClass("nos-appdesk-inspector ui-widget-content").data("inspector",b.extend({loadingText:e.texts.loading},this)).appendTo(this.vertical?d.uiInspectorsVertical:d.uiInspectorsHorizontal)}});return d},_uiInspectorsInit:function(){var d=this,e=d.options;if(d.uiSplitterVertical.data("wijmo-wijsplitter")){d.uiInspectorsVerticalLi=d.uiInspectorsVertical.find("> li");d._resizeInspectorsV(true);d.uiInspectorsVerticalLi.each(function(){d._loadInspector(b(this))})}if(d.uiInspectorsHorizontal.data("wijmo-wijsplitter")){d.uiInspectorsHorizontalLi=d.uiInspectorsHorizontal.find("> li");d._resizeInspectorsH(true);d.uiInspectorsHorizontalLi.each(function(){d._loadInspector(b(this))})}return d},_loadInspector:function(g){var d=this,f=g.data("inspector"),e=d.options;f.selectionChanged=function(n,k){var i=false,j=f.inputName,h,m;if(f.inputName.substr(-2,2)==="[]"){j=f.inputName.substr(0,f.inputName.length-2);i=true}if(!i){d.uiInspectorsTags.find("span."+j).remove()}else{var o=false;d.uiInspectorsTags.find("span."+j).each(function(){if(b(this).find("input").val()===n){o=true;return false}});if(o){return true}}d.pageIndex=0;if(d.uiInspectorsTags.data("wijmo-wijsuperpanel")){d.uiInspectorsTags.wijsuperpanel("destroy")}var l=b("<span></span>").addClass("nos-appdesk-inspectorstag ui-state-default ui-corner-all "+j).html(k).appendTo(d.uiInspectorsTags);b('<input type="hidden" name="'+f.inputName+'" />').val(n).appendTo(l);b('<a href="#"></a>').addClass("ui-icon ui-icon-close").click(function(p){p.preventDefault();b(this).parent().remove();d.gridReload()}).appendTo(l);h=parseInt(d.uiInputContainer.width()*0.7);m=d.uiInspectorsTags.css("width","1%").outerWidth();d.uiInspectorsTags.width(m>h?h:m).wijsuperpanel({showRounder:false,hScroller:{scrollMode:"buttons"}});if(e.defaultView==="treeGrid"){d.uiViewsButtons.find(".view_grid").click().blur()}else{d.gridReload()}};g.data("inspector",f);if(b.isFunction(f.url)){f.url.call(d,g)}else{if(f.url){b.ajax({url:f.url,dataType:"html"}).done(function(h){b(h).appendTo(g)}).fail(function(h,j,i){log("error");log(j);log(i)})}else{g.html(f.view)}}return d},_uiSearchBar:function(){var e=this,g=e.options;e.uiResetSearch.hide();e.uiSearchInput.on("keypress",function(i){var j=b.ui.keyCode;e.pageIndex=0;if(e.timeoutSearchInput){clearTimeout(e.timeoutSearchInput)}if(i.keyCode===j.ENTER){if(g.defaultView==="treeGrid"){e.uiViewsButtons.find(".view_grid").click().blur()}else{e.gridReload()}return false}e.timeoutSearchInput=setTimeout(function(){if(g.defaultView==="treeGrid"){e.uiViewsButtons.find(".view_grid").click().blur()}else{e.gridReload()}},500)});e.uiResetSearch.click(function(i){i.preventDefault();e.uiSearchInput.val("");if(e.uiInspectorsTags.data("wijmo-wijsuperpanel")){e.uiInspectorsTags.wijsuperpanel("destroy")}e.uiInspectorsTags.empty().css("width","auto");e.gridReload()});e.uiInspectorsTags.height(e.uiInputContainer.height()).css("width","auto").wijsuperpanel({showRounder:false,hScroller:{scrollMode:"buttons"}});e.uiInputContainer.click(function(){e.uiSearchInput.focus()});var d=[{id:"treeGrid",text:g.texts.viewTreeGrid,icon:"view-tree"},{id:"grid",text:g.texts.viewGrid,icon:"view-list"},{id:"thumbnails",size:64,text:g.texts.viewThumbnails,icon:"view-thumbs-small"},{id:"thumbnails",size:128,text:g.texts.viewThumbnails,icon:"view-thumbs-big"}],f=new Date(),h=f.getDate()+"_"+f.getHours()+"_"+f.getMinutes()+"_"+f.getSeconds()+"_"+f.getMilliseconds();b.each(d,function(){var i=this;if(g[i.id]){b('<label for="view_'+h+i.id.toLowerCase()+(i.size?"_"+i.size:"")+'"></label>').html(i.text+(i.size?" "+i.size+"px":"")).appendTo(e.uiViewsButtons);b('<input type="radio" name="view" />').attr("id","view_"+h+i.id.toLowerCase()+(i.size?"_"+i.size:"")).prop("checked",(g.defaultView===i.id&&(!i.size||i.size===g.thumbnails.thumbnailSize))).addClass("view_"+i.id.toLowerCase()+(i.size?"_"+i.size:"")).appendTo(e.uiViewsButtons).button({text:false,label:i.text+(i.size?" "+i.size+"px":""),icons:{primary:"ui-icon "+i.icon,secondary:null}}).click(function(){if(g.defaultView!==i.id||(i.id==="thumbnails"&&g.thumbnails.thumbnailSize!==i.size)){e.uiViewsButtons.find("button").removeClass("ui-state-active");b(this).addClass("ui-state-active");g.defaultView=i.id;if(i.size){g.thumbnails.thumbnailSize=i.size}if(i.id==="treeGrid"){e.uiSearchInput.val("");e.uiResetSearch.hide();e.uiNbResult.hide()}e._uiList()}})}});if(e.uiViewsButtons.find("input").length>1){e.uiViewsButtons.buttonset()}else{e.uiViewsButtons.hide()}return e},_uiList:function(){var d=this,e=d.options;d.gridRendered=false;d.uiGridTitle.html(e.texts.gridTitle);if(d.uiThumbnail.data("nos-thumbnailsgrid")){d.uiThumbnail.thumbnailsgrid("destroy")}if(d.uiGrid.data("nos-noslistgrid")){d.uiGrid.noslistgrid("destroy")}if(d.uiTreeGrid.data("nos-nostreegrid")){d.uiTreeGrid.nostreegrid("destroy")}d.uiThumbnail.add(d.uiGrid).add(d.uiTreeGrid).empty().hide();if(e.defaultView==="thumbnails"){d.uiThumbnail.show();d._uiThumbnail()}else{if(e.defaultView==="treeGrid"){d.uiTreeGrid.show();d._uiTreeGrid()}else{d.uiGrid.show();d._uiGrid()}}return d},_uiGrid:function(){var e=this,g=e.options,d=e._listHeight(e.uiGrid),f=b.extend(true,{},g.grid);e._columnsMultiContext(f.columns);e.uiGrid.css({height:d,width:"100%"}).noslistgrid(b.extend({loadingText:g.texts.loading,columnsAutogenerationMode:"none",columnsOptions:g,selectionMode:"singleRow",showFilter:e.showFilter,allowSorting:true,scrollMode:"auto",allowPaging:true,culture:g.culture,pageIndex:e.pageIndex,pageSizeAuto:true,allowColSizing:true,allowColMoving:true,data:new wijdatasource({dynamic:true,proxy:new a({url:g.grid.urlJson,dataType:"json",error:function(h,j,i){log(h,j,i)},data:{}}),loading:function(j,h){var i=h.data.paging;e.pageIndex=i.pageIndex;if(e.gridRendered){e.uiGrid.noslistgrid("currentCell",-1,-1)}j.proxy.options.data.context=g.selectedContexts||"";j.proxy.options.data.inspectors=e._jsonInspectors();j.proxy.options.data.offset=i.pageIndex*i.pageSize;j.proxy.options.data.limit=i.pageSize},loaded:function(i,h){if(i.data.totalRows===0){e.uiPaginationLabel.html(g.texts.showNoItem);e.uiNbResult.html(g.texts.showNoItem)}else{e.uiPaginationLabel.html(b.nosI18nPlural(g.texts.showNbItems,i.data.length).replace("{{x}}",i.data.length).replace("{{y}}",i.data.totalRows));e.uiNbResult.html(b.nosI18nPlural(g.texts.NItems,i.data.totalRows).replace("{{count}}",i.data.totalRows))}e.uiNbResult.show();e.uiResetSearch[e.uiInspectorsTags.find(".nos-appdesk-inspectorstag").length||e.uiSearchInput.val()?"show":"hide"]()},reader:{read:function(i){var h=parseInt(i.data.total,10);i.data=i.data.items;i.data.totalRows=h}}}),pageIndexChanging:function(){e.element.trigger("selectionChanged.appdesk",false)},cellStyleFormatter:function(h){if(h.$cell.is("th")){h.$cell.removeClass("ui-state-active")}if(h.state&b.wijmo.wijgrid.renderState.selected){h.$cell.removeClass("wijmo-wijgrid-current-cell")}},currentCellChanging:function(){return e.gridRendered},currentCellChanged:function(i){if(i){var j=b(i.target).noslistgrid("currentCell").row(),h=j?j.data:false;if(h){e.itemSelected=b.extend({},h);e.element.trigger("selectionChanged.appdesk",h)}}return true},rendering:function(){e.gridRendered=false},rendered:function(){e.gridRendered=true;e.uiGrid.css("height","auto");var h=e.uiGrid.noslistgrid("selection");h&&h.clear();if(e.itemSelected!==null){b.each(e.uiGrid.noslistgrid("data")||[],function(i,j){if(j._model==e.itemSelected._model&&j._id==e.itemSelected._id){h.addRows(i);e.element.trigger("selectionChanged.appdesk",j)}})}},dataLoading:function(h){e.uiPaginationLabel.detach()},loaded:function(){e.uiSplitterHorizontalBottom.find(".wijmo-wijgrid-footer").prepend(e.uiPaginationLabel)}},f));return e},_uiTreeGrid:function(){var d=this,g=d.options,f=b.extend(true,{},g.grid),e=b.extend({},g.treeGrid.columns||g.grid.columns);delete f.columns;delete f.urlJson;d._columnsMultiContext(e);d.uiTreeGrid.css({height:d._listHeight(d.uiTreeGrid),width:"100%"}).nostreegrid(b.extend(true,{loadingText:g.texts.loading,urlJson:g.treeGrid.urlJson,treeOptions:{context:g.selectedContexts||""},initialDepth:g.treeGrid.initialDepth||2,columnsAutogenerationMode:"none",columnsOptions:g,selectionMode:"singleRow",allowSorting:true,scrollMode:"auto",culture:g.culture,allowColSizing:true,allowColMoving:true,columns:g.treeGrid.columns||g.grid.columns,sorting:function(i,h){b.each(g.grid.columns,function(){var j=this;if(j.headerText===h.column.headerText){j.sortDirection=h.sortDirection}else{j.sortDirection="none"}});d.uiViewsButtons.find(".view_grid").click().blur();return false},cellStyleFormatter:function(h){if(h.$cell.is("th")){h.$cell.removeClass("ui-state-active")}if(h.state&b.wijmo.wijgrid.renderState.selected){h.$cell.removeClass("wijmo-wijgrid-current-cell")}},currentCellChanging:function(){return d.gridRendered},currentCellChanged:function(i){if(i){var j=b(i.target).nostreegrid("currentCell").row(),h=j?j.data:false;if(h){d.itemSelected=b.extend({},h);d.element.trigger("selectionChanged.appdesk",h)}}return true},rendering:function(){d.gridRendered=false},rendered:function(){d.gridRendered=true;d.uiTreeGrid.css("height","auto");var h=d.uiTreeGrid.nostreegrid("selection");h&&h.clear();if(d.itemSelected!==null){b.each(d.uiTreeGrid.nostreegrid("data")||[],function(i,j){if(j._model==d.itemSelected._model&&j._id==d.itemSelected._id){h.addRows(i);d.element.trigger("selectionChanged.appdesk",j)}})}},dataLoading:function(h){d.uiPaginationLabel.detach()},loaded:function(){d.uiSplitterHorizontalBottom.find(".wijmo-wijgrid-footer").prepend(d.uiPaginationLabel)}},f));return d},_uiThumbnail:function(){var d=this,e=d.options;d.uiThumbnail.css("height",d._listHeight(d.uiThumbnail)).thumbnailsgrid(b.extend({texts:{loading:e.texts.loading},pageIndex:0,url:e.grid.urlJson,loading:function(h,f){var g=f.data.paging;d.pageIndex=g.pageIndex;h.proxy.options.data.context=e.selectedContexts||"";h.proxy.options.data.inspectors=d._jsonInspectors();h.proxy.options.data.offset=g.pageIndex*g.pageSize;h.proxy.options.data.limit=g.pageSize},loaded:function(g,f){if(g.data.totalRows===0){d.uiPaginationLabel.html(e.texts.showNoItem);d.uiNbResult.html(e.texts.showNoItem)}else{d.uiPaginationLabel.html(b.nosI18nPlural(e.texts.showNbItems,g.data.length).replace("{{x}}",g.data.length).replace("{{y}}",g.data.totalRows));d.uiNbResult.html(b.nosI18nPlural(e.texts.NItems,g.data.totalRows).replace("{{count}}",g.data.totalRows))}d.uiNbResult.show();d.uiResetSearch[d.uiInspectorsTags.find(".nos-appdesk-inspectorstag").length||d.uiSearchInput.val()?"show":"hide"]()},rendered:function(){d.uiSplitterHorizontalBottom.find(".wijmo-wijpager").prepend(d.uiPaginationLabel);if(d.itemSelected!==null){var f=false;b.each(d.uiThumbnail.thumbnailsgrid("data")||[],function(g,h){if(h._model==d.itemSelected._model&&h._id==d.itemSelected._id){f=true;if(!d.uiThumbnail.thumbnailsgrid("select",g)){d.itemSelected=null}}});if(!f){d.uiThumbnail.thumbnailsgrid("unselect")}}},reader:{read:function(g){var f=parseInt(g.data.total,10);g.data=g.data.items;g.data.totalRows=f}},pageIndexChanging:function(){d.itemSelected=null;d.element.trigger("selectionChanged.appdesk",false)},selectionChanged:function(g,f){if(!f||b.isEmptyObject(f)){d.itemSelected=null;d.element.trigger("selectionChanged.appdesk",false)}else{d.itemSelected=b.extend({},f.item.data.noParseData);d.element.trigger("selectionChanged.appdesk",f.item.data.noParseData)}}},e.thumbnails));return d},_listHeight:function(e){var f=this,d=e.offset(),h=f.element.offset(),i=parseInt(e.css("borderTopWidth").replace("px","")),g=parseInt(e.css("borderBottomWidth").replace("px",""));return f.element.height()-d.top+h.top-i-g},_columnsMultiContext:function(e){var d=this,f=d.options;if(!f.hideContexts){b.each(e,function(g,h){if(h.context){h.visible=f.selectedContexts.length>1}else{if(h.multiContextHide){h.visible=f.selectedContexts.length===1}}})}return d},_jsonInspectors:function(){var d=this,e=b.extend({},this.options.values||{});d.uiInspectorsTags.find("input").add(d.uiSearchInput).each(function(){var g=b(this),h=g.attr("name"),f=false;if(h.substr(-2,2)==="[]"){h=h.substr(0,h.length-2);f=true}if(!f){e[h]=g.val()}else{if(!b.isArray(e[h])){e[h]=[];e[h].push(g.val())}else{if(-1==b.inArray(g.val(),e[h])){e[h].push(g.val())}}}});return e},_resizeInspectorsV:function(e){var d=this;if(d.uiSplitterVertical.data("wijmo-wijsplitter")){d.uiInspectorsVerticalLi.css({width:"100%",height:(d.uiInspectorsVertical.height()/d.uiInspectorsVerticalLi.length)+"px"}).trigger(e?"widgetReload":"widgetResize")}return d},_resizeInspectorsH:function(e){var d=this;if(d.uiSplitterHorizontal.data("wijmo-wijsplitter")){d.uiInspectorsHorizontalLi.css({width:(d.uiInspectorsHorizontal.width()/d.uiInspectorsHorizontalLi.length)+"px",height:"100%"}).trigger(e?"widgetReload":"widgetResize")}return d},_resizeList:function(f){var e=this,h=e.options,d,g;if(e.init){d=e._listHeight(e.uiSplitterHorizontalBottom.find("> .ui-widget:eq(1)"));if(h.defaultView==="thumbnails"){if(f){e._uiList()}else{e.uiThumbnail.thumbnailsgrid("setSize",e.uiSplitterHorizontalBottom.width(),d)}}else{if(h.defaultView==="treeGrid"){if(f){e._uiList()}else{e.uiTreeGrid.nostreegrid("setSize",null,d)}}else{e.uiGrid.noslistgrid("setSize",null,d)}}}return e},gridReload:function(){var d=this,e=d.options;if(d.init){if(e.defaultView==="thumbnails"){d._uiList()}else{if(e.defaultView==="treeGrid"){d._uiList()}else{d.uiGrid.noslistgrid("option","pageIndex",d.pageIndex).noslistgrid("ensureControl",true)}}}return d},resize:function(){var d=this,e=d.options;if(d.uiSplitterVertical.data("wijmo-wijsplitter")){d.uiSplitterVertical.wijsplitter("refresh",false,false)}if(d.uiSplitterHorizontal.data("wijmo-wijsplitter")){d.uiSplitterHorizontal.wijsplitter("refresh",false,false)}d._resizeInspectorsV()._resizeInspectorsH()._resizeList();return d},slidersSettings:function(){var d=this;return{vertical:{splitterDistance:d.uiSplitterVertical.data("wijmo-wijsplitter")?this.uiSplitterVertical.wijsplitter("option","splitterDistance")/b(window).width():0},horizontal:{splitterDistance:d.uiSplitterHorizontal.data("wijmo-wijsplitter")?this.uiSplitterHorizontal.wijsplitter("option","splitterDistance")/b(window).height():0}}}});b.extend({appdeskAdd:function(k,g){var f=this,j=false,e="",d,h=function(q){var l=b.extend({},true,q);var r=q.i18n||{};var o={},n=function(t,s){t.setupkey=s;return t},m=function(t,v){if(t[v+"Order"]){var w=t[v+"Order"].split(",");var s=[];for(var u=0;u<w.length;u++){if(t[v][w[u]]!=null){t[v][w[u]]["setupkey"]=w[u];s.push(t[v][w[u]])}}return s}else{return b.map(t[v],n)}},p=function(s){b.each(s,function(u,x){if(u==="i18nMessages"||u==="texts"){return}var t,v,w=[];if(b.isPlainObject(x)){if(b.isFunction(x._)){s[u]=x._()}else{p(x)}}else{if(b.isArray(x)){p(x)}}if(u==="columns"){s[u]=m(s,u)}})},o={tab:null,appdesk:{buttons:{},grid:{urlJson:"",columns:{}},thumbnails:null,defaultView:"grid",inspectors:{},splittersVertical:null,splittersHorizontal:null},i18nMessages:{},i18n:function(t){var u={};var s=this;b.extend(u,{label:t,_:function(){return s.i18nMessages[u.label]||u.label}});return u},build:function(){var u=b.extend(true,{appdesk:{texts:this.i18nMessages,splitters:{}}},this);if(u.appdesk.splittersVertical){u.appdesk.splitters.vertical={splitterDistance:u.appdesk.splittersVertical}}if(u.appdesk.splittersHorizontal){u.appdesk.splitters.horizontal={splitterDistance:u.appdesk.splittersHorizontal}}u.appdesk.buttons=b.map(u.appdesk.buttons,n);u.appdesk.inspectors=m(u.appdesk,"inspectors");if(u.actions){u.appdesk.actions=u.actions;var s=u.actions;if(u.appdesk.grid.columns.actions&&u.appdesk.grid.columns.actions.actions){b.each(u.appdesk.grid.columns.actions.actions,function(v,w){if(b.type(w)=="string"){u.appdesk.grid.columns.actions.actions[v]=s[w]}})}if(u.appdesk.treeGrid&&u.appdesk.treeGrid.columns&&u.appdesk.treeGrid.columns.actions&&u.appdesk.treeGrid.columns.actions.actions){b.each(u.appdesk.treeGrid.columns.actions.actions,function(v,w){if(b.type(w)=="string"){u.appdesk.treeGrid.columns.actions.actions[v]=s[w]}})}if(u.appdesk.thumbnails&&u.appdesk.thumbnails.actions){b.each(u.appdesk.thumbnails.actions,function(v,w){if(b.type(w)=="string"){u.appdesk.thumbnails.actions[v]=s[w]}})}b.each(u.appdesk.inspectors,function(v,w){if(w.preview&&w.options.actions){b.each(w.options.actions,function(x,y){if(b.type(y)=="string"){w.options.actions[x]=s[y]}})}})}l=u.appdesk;p(u);for(var t=0;t<u.appdesk.inspectors.length;t++){if(u.appdesk.inspectors[t].preview){u.appdesk.inspectors[t].url=function(x){var v=x.data("inspector"),w=b("<div></div>").appendTo(x).preview(v.options).parent().on({widgetResize:function(){w.preview("resize")}}).end()}}}return u}};return o};if(g.selectedView=="custom"){if(g.custom){e=g.views[g.custom.from].json;j=true}else{g.selectedView="default"}}if(g.selectedView!="custom"){e=g.views[g.selectedView].json}d=h(g);b.extend(true,d.i18nMessages,g.i18n);if(b.isPlainObject(g.appdesk)){b.extend(true,d,g.appdesk)}var i=function(){var r=(typeof g.hideContexts!="undefined"?g.hideContexts:Object.keys(g.contexts).length<=1);b.extend(true,d.appdesk,{contexts:g.contexts,sites:g.sites,locales:g.locales,hideContexts:r,views:g.views,name:g.configuration_id,selectedView:g.selectedView,selectedContexts:g.selectedContexts});if(j){b.extend(true,d.appdesk,{fromView:g.custom.from},g.custom.appdesk)}var o,s=b("div#"+k),l=s.closest(".nos-dispatcher"),q=d.build();if(b.isPlainObject(q.tab)&&!b.isEmptyObject(q.tab)){try{b(s).nosTabs("update",q.tab)}catch(p){log("Could not update current tab. Maybe your config file should not try to update it.")}}s.removeAttr("id").appdesk(q.appdesk);l.on({resizePanel:function(){if(o){window.clearTimeout(o)}o=window.setTimeout(function(){s.appdesk("resize")},200)},showPanel:function(){s.appdesk("resize")}});if(q.reloadEvent){if(!b.isArray(q.reloadEvent)){q.reloadEvent=[q.reloadEvent]}var m=function(){var t=[];b.each(q.reloadEvent,function(u,v){if(b.type(v)==="string"){if(l.data("nosContext")){t.push({name:v,context:l.data("nosContext")})}else{t.push({name:v})}}else{t.push(v)}});l.nosListenEvent(t,function(){s.appdesk("gridReload")},"appdeskContext")},n=function(){l.nosUnlistenEvent("appdeskContext");m()};m();l.data("appdeskChangeReloadEvent",n);l.on("contextChange",n)}s.bind("reloadView",function(v,u){b.extend(g,u);var t=b('<div id="'+k+'"></div>');t.insertAfter(s);s.remove();f.appdeskAdd(k,g)})};if(e&&(!b.isArray(e)||e.length)){require(e,function(){for(var l=0;l<arguments.length;l++){b.extend(true,d,arguments[l](d))}i()})}else{i()}}});return b});
define("jquery-nos-datacatchers",["jquery","jquery-nos","jquery-ui.widget","jquery-ui.button","wijmo.wijaccordion"],function(a){var b=void (0);a.widget("nos.datacatchers",{options:{model_id:"",model_name:""},_create:function(){var c=this,d=c.options;c.element.addClass("nos-datacatchers ui-widget-content");c.uiApplications=c.element.find(".catchers div");c.uiCatcherForm=c.element.find(".nos-datacatchers-catecherform");c.uiForm=c.element.find("form");c.uiSave=c.uiForm.find(".nos-datacatchers-buttons button");c.uiClose=c.element.find(".nos-datacatchers-close")},_init:function(){var c=this,d=c.options;c.element.find(".accordion").wijaccordion();c._applications();c.uiForm.nosFormUI();c._form(c.uiForm);c.uiForm.bind("ajax_success",function(g,f){c.uiApplications.html(f.applications);c._applications();c.uiCatcherForm.empty()});c.uiClose.click(function(f){f.preventDefault();c.element.trigger("close")});c.element.nosListenEvent({name:d.model_name,id:d.model_id,action:"update"},function(){a.ajax({url:"admin/nos/datacatcher/form",data:{model_name:d.model_name,model_id:d.model_id},success:function(e){c.element.nosAjaxSuccess(e);c.element.remove()}})})},_applications:function(){var c=this,d=c.options;c.uiApplications.find("button.catcher").each(function(){var e=a(this),g=e.data("params"),f=e.data("nuggets");e.button({label:g.title,icons:{primary:g.iconClasses||"nos-icon16 nos-icon16-share"}}).click(function(h){h.preventDefault();h.stopImmediatePropagation();if(g.action){a(this).nosAction(g.action,f)}else{a.ajax({url:g.url,success:function(i){c.uiCatcherForm.empty();a("<div><h3></h3><div></div></div>").appendTo(c.uiCatcherForm).find("h3").html(g.title).end().find("div").html(i).end().wijaccordion().nosFormUI();c._form(c.uiCatcherForm);c.uiCatcherForm.find(".nos-datacatchers-buttons a").click(function(j){j.preventDefault();c.uiCatcherForm.empty()})}})}});if(g.iconUrl){e.find(".ui-button-icon-primary").removeClass("nos-icon16-share").addClass("nos-icon16").css("background-image",'url("'+g.iconUrl+'")')}});return c},_form:function(e){var c=this,d=c.options;e.find(".nos-datacatchers-nugget-checkbox").each(function(){a(this).change(function(){if(a(this).is(":checked")){a(this).closest("tr").find("td:eq(0) :input").each(function(){var f=a(this).attr("disabled",true).data()})}else{a(this).closest("tr").find("td:eq(0) :input").each(function(){var f=a(this).removeAttr("disabled").data()})}}).triggerHandler("change")});e.find(".nos-datacatchers-nugget-image").hover(function(){a(this).addClass("ui-state-hover")},function(){a(this).removeClass("ui-state-hover")}).click(function(){a(this).find("input").prop("checked",true);a(this).addClass("ui-state-active").siblings().removeClass("ui-state-active")});return c}});return a});
define("jquery-nos-contextmenu",["jquery","jquery-nos","jquery-ui.widget","wijmo.wijmenu","modernizr"],function(a){var b=Modernizr.touch;a.widget("nos.noscontextmenu",a.wijmo.wijmenu,{options:{triggerEvent:"rtclick",orientation:"vertical",animation:{animated:"slide",option:{direction:"up"},duration:50,easing:null},hideAnimation:{animated:"slide",option:{direction:"up"},duration:0,easing:null}},_create:function(){var c=this,d=c.options;c._super();if(d.trigger!==""&&d.triggerEvent==="rtclick"&&b){require(["jquery.taphold"],function(){var e=c._getTriggerEle();if(e.length>0){e.on("taphold",function(f){a(this).trigger("contextmenu")})}})}},_destroy:function(){var c=this,d=c.options;if(d.trigger!==""&&d.triggerEvent==="rtclick"&&b){c._getTriggerEle().off("taphold")}c._super()}});return a});
